import{s as Ji,g as _r,f as Zi,u as H,w as Ar,S as Xi,v as Yi,a as As,e as Fe,b as Lt,n as Jt,c as Rs,d as Qi,h as Wn,m as je,p as eo,F as to,r as Is,i as ze,j as ro,k as no,l as so,o as lt,q as io,t as oo,x as ot,y as ao,z as Qe,B as U,A as co,C as uo,_ as lo,D as fo,E as ho,G as po,H as go,I as mo,J as yo,K as xs,L as Bs,M as Gn,N as Vn,O as At,P as wt,Q as bt,R as pr,T as cn,U as qt,V as Qt,W as Rr,X as Ce,Y as Rt,Z as L,$ as k,a0 as Jn,a1 as un,a2 as ln,a3 as dn,a4 as wo}from"./index-ca8c9a8e.js";import{n as bo}from"./nacl-fast-e4971c68.js";var cr=Ji.Buffer;function vo(n){if(n.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),t=0;t<e.length;t++)e[t]=255;for(var r=0;r<n.length;r++){var s=n.charAt(r),i=s.charCodeAt(0);if(e[i]!==255)throw new TypeError(s+" is ambiguous");e[i]=r}var o=n.length,a=n.charAt(0),c=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function u(d){if((Array.isArray(d)||d instanceof Uint8Array)&&(d=cr.from(d)),!cr.isBuffer(d))throw new TypeError("Expected Buffer");if(d.length===0)return"";for(var p=0,g=0,y=0,E=d.length;y!==E&&d[y]===0;)y++,p++;for(var v=(E-y)*l+1>>>0,m=new Uint8Array(v);y!==E;){for(var A=d[y],S=0,C=v-1;(A!==0||S<g)&&C!==-1;C--,S++)A+=256*m[C]>>>0,m[C]=A%o>>>0,A=A/o>>>0;if(A!==0)throw new Error("Non-zero carry");g=S,y++}for(var B=v-g;B!==v&&m[B]===0;)B++;for(var N=a.repeat(p);B<v;++B)N+=n.charAt(m[B]);return N}function h(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return cr.alloc(0);for(var p=0,g=0,y=0;d[p]===a;)g++,p++;for(var E=(d.length-p)*c+1>>>0,v=new Uint8Array(E);d[p];){var m=e[d.charCodeAt(p)];if(m===255)return;for(var A=0,S=E-1;(m!==0||A<y)&&S!==-1;S--,A++)m+=o*v[S]>>>0,v[S]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");y=A,p++}for(var C=E-y;C!==E&&v[C]===0;)C++;var B=cr.allocUnsafe(g+(E-C));B.fill(0,0,g);for(var N=g;C!==E;)B[N++]=v[C++];return B}function f(d){var p=h(d);if(p)return p;throw new Error("Non-base"+o+" character")}return{encode:u,decodeUnsafe:h,decode:f}}var So=vo,ko=So,Eo="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",Cs=ko(Eo);const ne=_r(Cs);var J={},gt={};Object.defineProperty(gt,"__esModule",{value:!0});gt.EthereumProviderError=gt.EthereumRpcError=void 0;const _o=Zi;class Ps extends Error{constructor(e,t,r){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!t||typeof t!="string")throw new Error('"message" must be a nonempty string.');super(t),this.code=e,r!==void 0&&(this.data=r)}serialize(){const e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),this.stack&&(e.stack=this.stack),e}toString(){return _o.default(this.serialize(),Io,2)}}gt.EthereumRpcError=Ps;class Ao extends Ps{constructor(e,t,r){if(!Ro(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,r)}}gt.EthereumProviderError=Ao;function Ro(n){return Number.isInteger(n)&&n>=1e3&&n<=4999}function Io(n,e){if(e!=="[Circular]")return e}var fn={},mt={};Object.defineProperty(mt,"__esModule",{value:!0});mt.errorValues=mt.errorCodes=void 0;mt.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}};mt.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.serializeError=n.isValidCode=n.getMessageFromCode=n.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const e=mt,t=gt,r=e.errorCodes.rpc.internal,s="Unspecified error message. This is a bug, please report it.",i={code:r,message:o(r)};n.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.";function o(f,d=s){if(Number.isInteger(f)){const p=f.toString();if(h(e.errorValues,p))return e.errorValues[p].message;if(l(f))return n.JSON_RPC_SERVER_ERROR_MESSAGE}return d}n.getMessageFromCode=o;function a(f){if(!Number.isInteger(f))return!1;const d=f.toString();return!!(e.errorValues[d]||l(f))}n.isValidCode=a;function c(f,{fallbackError:d=i,shouldIncludeStack:p=!1}={}){var g,y;if(!d||!Number.isInteger(d.code)||typeof d.message!="string")throw new Error("Must provide fallback error with integer number code and string message.");if(f instanceof t.EthereumRpcError)return f.serialize();const E={};if(f&&typeof f=="object"&&!Array.isArray(f)&&h(f,"code")&&a(f.code)){const m=f;E.code=m.code,m.message&&typeof m.message=="string"?(E.message=m.message,h(m,"data")&&(E.data=m.data)):(E.message=o(E.code),E.data={originalError:u(f)})}else{E.code=d.code;const m=(g=f)===null||g===void 0?void 0:g.message;E.message=m&&typeof m=="string"?m:d.message,E.data={originalError:u(f)}}const v=(y=f)===null||y===void 0?void 0:y.stack;return p&&f&&v&&typeof v=="string"&&(E.stack=v),E}n.serializeError=c;function l(f){return f>=-32099&&f<=-32e3}function u(f){return f&&typeof f=="object"&&!Array.isArray(f)?Object.assign({},f):f}function h(f,d){return Object.prototype.hasOwnProperty.call(f,d)}})(fn);var Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});Ir.ethErrors=void 0;const hn=gt,Ts=fn,Se=mt;Ir.ethErrors={rpc:{parse:n=>Ue(Se.errorCodes.rpc.parse,n),invalidRequest:n=>Ue(Se.errorCodes.rpc.invalidRequest,n),invalidParams:n=>Ue(Se.errorCodes.rpc.invalidParams,n),methodNotFound:n=>Ue(Se.errorCodes.rpc.methodNotFound,n),internal:n=>Ue(Se.errorCodes.rpc.internal,n),server:n=>{if(!n||typeof n!="object"||Array.isArray(n))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:e}=n;if(!Number.isInteger(e)||e>-32005||e<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return Ue(e,n)},invalidInput:n=>Ue(Se.errorCodes.rpc.invalidInput,n),resourceNotFound:n=>Ue(Se.errorCodes.rpc.resourceNotFound,n),resourceUnavailable:n=>Ue(Se.errorCodes.rpc.resourceUnavailable,n),transactionRejected:n=>Ue(Se.errorCodes.rpc.transactionRejected,n),methodNotSupported:n=>Ue(Se.errorCodes.rpc.methodNotSupported,n),limitExceeded:n=>Ue(Se.errorCodes.rpc.limitExceeded,n)},provider:{userRejectedRequest:n=>zt(Se.errorCodes.provider.userRejectedRequest,n),unauthorized:n=>zt(Se.errorCodes.provider.unauthorized,n),unsupportedMethod:n=>zt(Se.errorCodes.provider.unsupportedMethod,n),disconnected:n=>zt(Se.errorCodes.provider.disconnected,n),chainDisconnected:n=>zt(Se.errorCodes.provider.chainDisconnected,n),custom:n=>{if(!n||typeof n!="object"||Array.isArray(n))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:e,message:t,data:r}=n;if(!t||typeof t!="string")throw new Error('"message" must be a nonempty string');return new hn.EthereumProviderError(e,t,r)}}};function Ue(n,e){const[t,r]=Os(e);return new hn.EthereumRpcError(n,t||Ts.getMessageFromCode(n),r)}function zt(n,e){const[t,r]=Os(e);return new hn.EthereumProviderError(n,t||Ts.getMessageFromCode(n),r)}function Os(n){if(n){if(typeof n=="string")return[n];if(typeof n=="object"&&!Array.isArray(n)){const{message:e,data:t}=n;if(e&&typeof e!="string")throw new Error("Must specify string message.");return[e||void 0,t]}}return[]}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMessageFromCode=n.serializeError=n.EthereumProviderError=n.EthereumRpcError=n.ethErrors=n.errorCodes=void 0;const e=gt;Object.defineProperty(n,"EthereumRpcError",{enumerable:!0,get:function(){return e.EthereumRpcError}}),Object.defineProperty(n,"EthereumProviderError",{enumerable:!0,get:function(){return e.EthereumProviderError}});const t=fn;Object.defineProperty(n,"serializeError",{enumerable:!0,get:function(){return t.serializeError}}),Object.defineProperty(n,"getMessageFromCode",{enumerable:!0,get:function(){return t.getMessageFromCode}});const r=Ir;Object.defineProperty(n,"ethErrors",{enumerable:!0,get:function(){return r.ethErrors}});const s=mt;Object.defineProperty(n,"errorCodes",{enumerable:!0,get:function(){return s.errorCodes}})})(J);const[xo,Bo]=H.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),ct=new Uint32Array(80),ut=new Uint32Array(80);class xr extends Xi{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:f,Gh:d,Gl:p,Hh:g,Hl:y}=this;return[e,t,r,s,i,o,a,c,l,u,h,f,d,p,g,y]}set(e,t,r,s,i,o,a,c,l,u,h,f,d,p,g,y){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=f|0,this.Gh=d|0,this.Gl=p|0,this.Hh=g|0,this.Hl=y|0}process(e,t){for(let m=0;m<16;m++,t+=4)ct[m]=e.getUint32(t),ut[m]=e.getUint32(t+=4);for(let m=16;m<80;m++){const A=ct[m-15]|0,S=ut[m-15]|0,C=H.rotrSH(A,S,1)^H.rotrSH(A,S,8)^H.shrSH(A,S,7),B=H.rotrSL(A,S,1)^H.rotrSL(A,S,8)^H.shrSL(A,S,7),N=ct[m-2]|0,V=ut[m-2]|0,oe=H.rotrSH(N,V,19)^H.rotrBH(N,V,61)^H.shrSH(N,V,6),fe=H.rotrSL(N,V,19)^H.rotrBL(N,V,61)^H.shrSL(N,V,6),me=H.add4L(B,fe,ut[m-7],ut[m-16]),ae=H.add4H(me,C,oe,ct[m-7],ct[m-16]);ct[m]=ae|0,ut[m]=me|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:f,Fh:d,Fl:p,Gh:g,Gl:y,Hh:E,Hl:v}=this;for(let m=0;m<80;m++){const A=H.rotrSH(h,f,14)^H.rotrSH(h,f,18)^H.rotrBH(h,f,41),S=H.rotrSL(h,f,14)^H.rotrSL(h,f,18)^H.rotrBL(h,f,41),C=h&d^~h&g,B=f&p^~f&y,N=H.add5L(v,S,B,Bo[m],ut[m]),V=H.add5H(N,E,A,C,xo[m],ct[m]),oe=N|0,fe=H.rotrSH(r,s,28)^H.rotrBH(r,s,34)^H.rotrBH(r,s,39),me=H.rotrSL(r,s,28)^H.rotrBL(r,s,34)^H.rotrBL(r,s,39),ae=r&i^r&a^i&a,vt=s&o^s&c^o&c;E=g|0,v=y|0,g=d|0,y=p|0,d=h|0,p=f|0,{h,l:f}=H.add(l|0,u|0,V|0,oe|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const Ge=H.add3L(oe,me,vt);r=H.add3H(Ge,V,fe,ae),s=Ge|0}({h:r,l:s}=H.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=H.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=H.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=H.add(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:f}=H.add(this.Eh|0,this.El|0,h|0,f|0),{h:d,l:p}=H.add(this.Fh|0,this.Fl|0,d|0,p|0),{h:g,l:y}=H.add(this.Gh|0,this.Gl|0,g|0,y|0),{h:E,l:v}=H.add(this.Hh|0,this.Hl|0,E|0,v|0),this.set(r,s,i,o,a,c,l,u,h,f,d,p,g,y,E,v)}roundClean(){ct.fill(0),ut.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Co extends xr{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class Po extends xr{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class To extends xr{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const pn=Ar(()=>new xr);Ar(()=>new Co);Ar(()=>new Po);Ar(()=>new To);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Je=BigInt(0),Me=BigInt(1),ur=BigInt(2),Oo=BigInt(8),Lo={zip215:!0};function No(n){const e=Yi(n);return As(n,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function gn(n){const e=No(n),{Fp:t,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=ur**BigInt(a*8),u=t.create,h=e.uvRatio||((q,I)=>{try{return{isValid:!0,value:t.sqrt(q*t.inv(I))}}catch{return{isValid:!1,value:Je}}}),f=e.adjustScalarBytes||(q=>q),d=e.domain||((q,I,z)=>{if(I.length||z)throw new Error("Contexts/pre-hash are not supported");return q}),p=q=>typeof q=="bigint"&&Je<q,g=(q,I)=>p(q)&&p(I)&&q<I,y=q=>q===Je||g(q,l);function E(q,I){if(g(q,I))return q;throw new Error(`Expected valid scalar < ${I}, got ${typeof q} ${q}`)}function v(q){return q===Je?q:E(q,r)}const m=new Map;function A(q){if(!(q instanceof S))throw new Error("ExtendedPoint expected")}class S{constructor(I,z,j,Z){if(this.ex=I,this.ey=z,this.ez=j,this.et=Z,!y(I))throw new Error("x required");if(!y(z))throw new Error("y required");if(!y(j))throw new Error("z required");if(!y(Z))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(I){if(I instanceof S)throw new Error("extended point not allowed");const{x:z,y:j}=I||{};if(!y(z)||!y(j))throw new Error("invalid affine point");return new S(z,j,Me,u(z*j))}static normalizeZ(I){const z=t.invertBatch(I.map(j=>j.ez));return I.map((j,Z)=>j.toAffine(z[Z])).map(S.fromAffine)}_setWindowSize(I){this._WINDOW_SIZE=I,m.delete(this)}assertValidity(){const{a:I,d:z}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:j,ey:Z,ez:Q,et:te}=this,ie=u(j*j),ee=u(Z*Z),se=u(Q*Q),ve=u(se*se),xe=u(ie*I),Ve=u(se*u(xe+ee)),Te=u(ve+u(z*u(ie*ee)));if(Ve!==Te)throw new Error("bad point: equation left != right (1)");const at=u(j*Z),St=u(Q*te);if(at!==St)throw new Error("bad point: equation left != right (2)")}equals(I){A(I);const{ex:z,ey:j,ez:Z}=this,{ex:Q,ey:te,ez:ie}=I,ee=u(z*ie),se=u(Q*Z),ve=u(j*ie),xe=u(te*Z);return ee===se&&ve===xe}is0(){return this.equals(S.ZERO)}negate(){return new S(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:I}=e,{ex:z,ey:j,ez:Z}=this,Q=u(z*z),te=u(j*j),ie=u(ur*u(Z*Z)),ee=u(I*Q),se=z+j,ve=u(u(se*se)-Q-te),xe=ee+te,Ve=xe-ie,Te=ee-te,at=u(ve*Ve),St=u(xe*Te),or=u(ve*Te),ar=u(Ve*xe);return new S(at,St,ar,or)}add(I){A(I);const{a:z,d:j}=e,{ex:Z,ey:Q,ez:te,et:ie}=this,{ex:ee,ey:se,ez:ve,et:xe}=I;if(z===BigInt(-1)){const qn=u((Q-Z)*(se+ee)),Kn=u((Q+Z)*(se-ee)),qr=u(Kn-qn);if(qr===Je)return this.double();const $n=u(te*ur*xe),Dn=u(ie*ur*ve),zn=Dn+$n,jn=Kn+qn,Hn=Dn-$n,Hi=u(zn*qr),Wi=u(jn*Hn),Gi=u(zn*Hn),Vi=u(qr*jn);return new S(Hi,Wi,Vi,Gi)}const Ve=u(Z*ee),Te=u(Q*se),at=u(ie*j*xe),St=u(te*ve),or=u((Z+Q)*(ee+se)-Ve-Te),ar=St-at,Mn=St+at,Fn=u(Te-z*Ve),$i=u(or*ar),Di=u(Mn*Fn),zi=u(or*Fn),ji=u(ar*Mn);return new S($i,Di,ji,zi)}subtract(I){return this.add(I.negate())}wNAF(I){return N.wNAFCached(this,m,I,S.normalizeZ)}multiply(I){const{p:z,f:j}=this.wNAF(E(I,r));return S.normalizeZ([z,j])[0]}multiplyUnsafe(I){let z=v(I);return z===Je?B:this.equals(B)||z===Me?this:this.equals(C)?this.wNAF(z).p:N.unsafeLadder(this,z)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return N.unsafeLadder(this,r).is0()}toAffine(I){const{ex:z,ey:j,ez:Z}=this,Q=this.is0();I==null&&(I=Q?Oo:t.inv(Z));const te=u(z*I),ie=u(j*I),ee=u(Z*I);if(Q)return{x:Je,y:Me};if(ee!==Me)throw new Error("invZ was invalid");return{x:te,y:ie}}clearCofactor(){const{h:I}=e;return I===Me?this:this.multiplyUnsafe(I)}static fromHex(I,z=!1){const{d:j,a:Z}=e,Q=t.BYTES;I=Fe("pointHex",I,Q);const te=I.slice(),ie=I[Q-1];te[Q-1]=ie&-129;const ee=Lt(te);ee===Je||(z?E(ee,l):E(ee,t.ORDER));const se=u(ee*ee),ve=u(se-Me),xe=u(j*se-Z);let{isValid:Ve,value:Te}=h(ve,xe);if(!Ve)throw new Error("Point.fromHex: invalid y coordinate");const at=(Te&Me)===Me;return(ie&128)!==0!==at&&(Te=u(-Te)),S.fromAffine({x:Te,y:ee})}static fromPrivateKey(I){return fe(I).point}toRawBytes(){const{x:I,y:z}=this.toAffine(),j=Jt(z,t.BYTES);return j[j.length-1]|=I&Me?128:0,j}toHex(){return Rs(this.toRawBytes())}}S.BASE=new S(e.Gx,e.Gy,Me,u(e.Gx*e.Gy)),S.ZERO=new S(Je,Me,Me,Je);const{BASE:C,ZERO:B}=S,N=Qi(S,a*8);function V(q){return je(q,r)}function oe(q){return V(Lt(q))}function fe(q){const I=a;q=Fe("private key",q,I);const z=Fe("hashed private key",i(q),2*I),j=f(z.slice(0,I)),Z=z.slice(I,2*I),Q=oe(j),te=C.multiply(Q),ie=te.toRawBytes();return{head:j,prefix:Z,scalar:Q,point:te,pointBytes:ie}}function me(q){return fe(q).pointBytes}function ae(q=new Uint8Array,...I){const z=Wn(...I);return oe(i(d(z,Fe("context",q),!!s)))}function vt(q,I,z={}){q=Fe("message",q),s&&(q=s(q));const{prefix:j,scalar:Z,pointBytes:Q}=fe(I),te=ae(z.context,j,q),ie=C.multiply(te).toRawBytes(),ee=ae(z.context,ie,Q,q),se=V(te+ee*Z);v(se);const ve=Wn(ie,Jt(se,t.BYTES));return Fe("result",ve,a*2)}const Ge=Lo;function sr(q,I,z,j=Ge){const{context:Z,zip215:Q}=j,te=t.BYTES;q=Fe("signature",q,2*te),I=Fe("message",I),s&&(I=s(I));const ie=Lt(q.slice(te,2*te));let ee,se,ve;try{ee=S.fromHex(z,Q),se=S.fromHex(q.slice(0,te),Q),ve=C.multiplyUnsafe(ie)}catch{return!1}const xe=ae(Z,se.toRawBytes(),ee.toRawBytes(),I);return se.add(ee.multiplyUnsafe(xe)).subtract(ve).clearCofactor().equals(S.ZERO)}return C._setWindowSize(8),{CURVE:e,getPublicKey:me,sign:vt,verify:sr,ExtendedPoint:S,utils:{getExtendedPublicKey:fe,randomPrivateKey:()=>o(t.BYTES),precompute(q=8,I=S.BASE){return I._setWindowSize(q),I.multiply(BigInt(3)),I}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const jt=BigInt(0),Kr=BigInt(1);function Uo(n){return As(n,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...n})}function Mo(n){const e=Uo(n),{P:t}=e,r=m=>je(m,t),s=e.montgomeryBits,i=Math.ceil(s/8),o=e.nByteLength,a=e.adjustScalarBytes||(m=>m),c=e.powPminus2||(m=>eo(m,t-BigInt(2),t));function l(m,A,S){const C=r(m*(A-S));return A=r(A-C),S=r(S+C),[A,S]}function u(m){if(typeof m=="bigint"&&jt<=m&&m<t)return m;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const h=(e.a-BigInt(2))/BigInt(4);function f(m,A){const S=u(m),C=u(A),B=S;let N=Kr,V=jt,oe=S,fe=Kr,me=jt,ae;for(let Ge=BigInt(s-1);Ge>=jt;Ge--){const sr=C>>Ge&Kr;me^=sr,ae=l(me,N,oe),N=ae[0],oe=ae[1],ae=l(me,V,fe),V=ae[0],fe=ae[1],me=sr;const ir=N+V,q=r(ir*ir),I=N-V,z=r(I*I),j=q-z,Z=oe+fe,Q=oe-fe,te=r(Q*ir),ie=r(Z*I),ee=te+ie,se=te-ie;oe=r(ee*ee),fe=r(B*r(se*se)),N=r(q*z),V=r(j*(q+r(h*j)))}ae=l(me,N,oe),N=ae[0],oe=ae[1],ae=l(me,V,fe),V=ae[0],fe=ae[1];const vt=c(V);return r(N*vt)}function d(m){return Jt(r(m),i)}function p(m){const A=Fe("u coordinate",m,i);return o===i&&(A[o-1]&=127),Lt(A)}function g(m){const A=Fe("scalar",m);if(A.length!==i&&A.length!==o)throw new Error(`Expected ${i} or ${o} bytes, got ${A.length}`);return Lt(a(A))}function y(m,A){const S=p(A),C=g(m),B=f(S,C);if(B===jt)throw new Error("Invalid private or public key received");return d(B)}const E=d(e.Gu);function v(m){return y(m,E)}return{scalarMult:y,scalarMultBase:v,getSharedSecret:(m,A)=>y(m,A),getPublicKey:m=>v(m),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:E}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Zt=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Zn=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Fo=BigInt(0),Xe=BigInt(1),gr=BigInt(2),qo=BigInt(5),Xn=BigInt(10),Ko=BigInt(20),$o=BigInt(40),Yn=BigInt(80);function Ls(n){const e=Zt,r=n*n%e*n%e,s=ze(r,gr,e)*r%e,i=ze(s,Xe,e)*n%e,o=ze(i,qo,e)*i%e,a=ze(o,Xn,e)*o%e,c=ze(a,Ko,e)*a%e,l=ze(c,$o,e)*c%e,u=ze(l,Yn,e)*l%e,h=ze(u,Yn,e)*l%e,f=ze(h,Xn,e)*o%e;return{pow_p_5_8:ze(f,gr,e)*n%e,b2:r}}function Ns(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}function mn(n,e){const t=Zt,r=je(e*e*e,t),s=je(r*r*e,t),i=Ls(n*s).pow_p_5_8;let o=je(n*r*i,t);const a=je(e*o*o,t),c=o,l=je(o*Zn,t),u=a===n,h=a===je(-n,t),f=a===je(-n*Zn,t);return u&&(o=c),(h||f)&&(o=l),lt(o,t)&&(o=je(-o,t)),{isValid:u||h,value:o}}const O=to(Zt,void 0,!0),yn={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:O,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:pn,randomBytes:Is,adjustScalarBytes:Ns,uvRatio:mn},de=gn(yn);function Us(n,e,t){if(e.length>255)throw new Error("Context is too big");return io(oo("SigEd25519 no Ed25519 collisions"),new Uint8Array([t?1:0,e.length]),e,n)}gn({...yn,domain:Us});gn({...yn,domain:Us,prehash:pn});Mo({P:Zt,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:n=>{const e=Zt,{pow_p_5_8:t,b2:r}=Ls(n);return je(ze(t,BigInt(3),e)*r,e)},adjustScalarBytes:Ns,randomBytes:Is});const Do=(O.ORDER+BigInt(3))/BigInt(8),zo=O.pow(gr,Do),Qn=O.sqrt(O.neg(O.ONE)),jo=(O.ORDER-BigInt(5))/BigInt(8),es=BigInt(486662);function Ho(n){let e=O.sqr(n);e=O.mul(e,gr);let t=O.add(e,O.ONE),r=O.neg(es),s=O.sqr(t),i=O.mul(s,t),o=O.mul(e,es);o=O.mul(o,r),o=O.add(o,s),o=O.mul(o,r);let a=O.sqr(i);s=O.sqr(a),a=O.mul(a,i),a=O.mul(a,o),s=O.mul(s,a);let c=O.pow(s,jo);c=O.mul(c,a);let l=O.mul(c,Qn);s=O.sqr(c),s=O.mul(s,i);let u=O.eql(s,o),h=O.cmov(l,c,u),f=O.mul(r,e),d=O.mul(c,n);d=O.mul(d,zo);let p=O.mul(d,Qn),g=O.mul(o,e);s=O.sqr(d),s=O.mul(s,i);let y=O.eql(s,g),E=O.cmov(p,d,y);s=O.sqr(h),s=O.mul(s,i);let v=O.eql(s,o),m=O.cmov(f,r,v),A=O.cmov(E,h,v),S=O.isOdd(A);return A=O.cmov(A,O.neg(A),v!==S),{xMn:m,xMd:t,yMn:A,yMd:Xe}}const Wo=ro(O,O.neg(BigInt(486664)));function Go(n){const{xMn:e,xMd:t,yMn:r,yMd:s}=Ho(n);let i=O.mul(e,s);i=O.mul(i,Wo);let o=O.mul(t,r),a=O.sub(e,t),c=O.add(e,t),l=O.mul(o,c),u=O.eql(l,O.ZERO);i=O.cmov(i,O.ZERO,u),o=O.cmov(o,O.ONE,u),a=O.cmov(a,O.ONE,u),c=O.cmov(c,O.ONE,u);const h=O.invertBatch([o,c]);return{x:O.mul(i,h[0]),y:O.mul(a,h[1])}}no(de.ExtendedPoint,n=>Go(n[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:O.ORDER,m:1,k:128,expand:"xmd",hash:pn});function $r(n){if(!(n instanceof Oe))throw new Error("RistrettoPoint expected")}const Qr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Vo=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Jo=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Zo=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Xo=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),ts=n=>mn(Xe,n),Yo=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Dr=n=>de.CURVE.Fp.create(Lt(n)&Yo);function rs(n){const{d:e}=de.CURVE,t=de.CURVE.Fp.ORDER,r=de.CURVE.Fp.create,s=r(Qr*n*n),i=r((s+Xe)*Zo);let o=BigInt(-1);const a=r((o-e*s)*r(s+e));let{isValid:c,value:l}=mn(i,a),u=r(l*n);lt(u,t)||(u=r(-u)),c||(l=u),c||(o=s);const h=r(o*(s-Xe)*Xo-a),f=l*l,d=r((l+l)*a),p=r(h*Vo),g=r(Xe-f),y=r(Xe+f);return new de.ExtendedPoint(r(d*y),r(g*p),r(p*y),r(d*g))}class Oe{constructor(e){this.ep=e}static fromAffine(e){return new Oe(de.ExtendedPoint.fromAffine(e))}static hashToCurve(e){e=Fe("ristrettoHash",e,64);const t=Dr(e.slice(0,32)),r=rs(t),s=Dr(e.slice(32,64)),i=rs(s);return new Oe(r.add(i))}static fromHex(e){e=Fe("ristrettoHex",e,32);const{a:t,d:r}=de.CURVE,s=de.CURVE.Fp.ORDER,i=de.CURVE.Fp.create,o="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",a=Dr(e);if(!so(Jt(a,32),e)||lt(a,s))throw new Error(o);const c=i(a*a),l=i(Xe+t*c),u=i(Xe-t*c),h=i(l*l),f=i(u*u),d=i(t*r*h-f),{isValid:p,value:g}=ts(i(d*f)),y=i(g*u),E=i(g*y*d);let v=i((a+a)*y);lt(v,s)&&(v=i(-v));const m=i(l*E),A=i(v*m);if(!p||lt(A,s)||m===Fo)throw new Error(o);return new Oe(new de.ExtendedPoint(v,m,Xe,A))}toRawBytes(){let{ex:e,ey:t,ez:r,et:s}=this.ep;const i=de.CURVE.Fp.ORDER,o=de.CURVE.Fp.create,a=o(o(r+t)*o(r-t)),c=o(e*t),l=o(c*c),{value:u}=ts(o(a*l)),h=o(u*a),f=o(u*c),d=o(h*f*s);let p;if(lt(s*d,i)){let y=o(t*Qr),E=o(e*Qr);e=y,t=E,p=o(h*Jo)}else p=f;lt(e*d,i)&&(t=o(-t));let g=o((r-t)*p);return lt(g,i)&&(g=o(-g)),Jt(g,32)}toHex(){return Rs(this.toRawBytes())}toString(){return this.toHex()}equals(e){$r(e);const{ex:t,ey:r}=this.ep,{ex:s,ey:i}=e.ep,o=de.CURVE.Fp.create,a=o(t*i)===o(r*s),c=o(r*i)===o(t*s);return a||c}add(e){return $r(e),new Oe(this.ep.add(e.ep))}subtract(e){return $r(e),new Oe(this.ep.subtract(e.ep))}multiply(e){return new Oe(this.ep.multiply(e))}multiplyUnsafe(e){return new Oe(this.ep.multiplyUnsafe(e))}}Oe.BASE=new Oe(de.ExtendedPoint.BASE);Oe.ZERO=new Oe(de.ExtendedPoint.ZERO);var be={};function st(n,e,t){return e<=n&&n<=t}function Br(n){if(n===void 0)return{};if(n===Object(n))return n;throw TypeError("Could not convert argument to dictionary")}function Qo(n){for(var e=String(n),t=e.length,r=0,s=[];r<t;){var i=e.charCodeAt(r);if(i<55296||i>57343)s.push(i);else if(56320<=i&&i<=57343)s.push(65533);else if(55296<=i&&i<=56319)if(r===t-1)s.push(65533);else{var o=n.charCodeAt(r+1);if(56320<=o&&o<=57343){var a=i&1023,c=o&1023;s.push(65536+(a<<10)+c),r+=1}else s.push(65533)}r+=1}return s}function ea(n){for(var e="",t=0;t<n.length;++t){var r=n[t];r<=65535?e+=String.fromCharCode(r):(r-=65536,e+=String.fromCharCode((r>>10)+55296,(r&1023)+56320))}return e}var mr=-1;function wn(n){this.tokens=[].slice.call(n)}wn.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():mr},prepend:function(n){if(Array.isArray(n))for(var e=n;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(n)},push:function(n){if(Array.isArray(n))for(var e=n;e.length;)this.tokens.push(e.shift());else this.tokens.push(n)}};var Ut=-1;function zr(n,e){if(n)throw TypeError("Decoder error");return e||65533}var yr="utf-8";function wr(n,e){if(!(this instanceof wr))return new wr(n,e);if(n=n!==void 0?String(n).toLowerCase():yr,n!==yr)throw new Error("Encoding not supported. Only utf-8 is supported");e=Br(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=!!e.fatal,this._ignoreBOM=!!e.ignoreBOM,Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}wr.prototype={decode:function(e,t){var r;typeof e=="object"&&e instanceof ArrayBuffer?r=new Uint8Array(e):typeof e=="object"&&"buffer"in e&&e.buffer instanceof ArrayBuffer?r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):r=new Uint8Array(0),t=Br(t),this._streaming||(this._decoder=new ta({fatal:this._fatal}),this._BOMseen=!1),this._streaming=!!t.stream;for(var s=new wn(r),i=[],o;!s.endOfStream()&&(o=this._decoder.handler(s,s.read()),o!==Ut);)o!==null&&(Array.isArray(o)?i.push.apply(i,o):i.push(o));if(!this._streaming){do{if(o=this._decoder.handler(s,s.read()),o===Ut)break;o!==null&&(Array.isArray(o)?i.push.apply(i,o):i.push(o))}while(!s.endOfStream());this._decoder=null}return i.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(i[0]===65279?(this._BOMseen=!0,i.shift()):this._BOMseen=!0),ea(i)}};function br(n,e){if(!(this instanceof br))return new br(n,e);if(n=n!==void 0?String(n).toLowerCase():yr,n!==yr)throw new Error("Encoding not supported. Only utf-8 is supported");e=Br(e),this._streaming=!1,this._encoder=null,this._options={fatal:!!e.fatal},Object.defineProperty(this,"encoding",{value:"utf-8"})}br.prototype={encode:function(e,t){e=e?String(e):"",t=Br(t),this._streaming||(this._encoder=new ra(this._options)),this._streaming=!!t.stream;for(var r=[],s=new wn(Qo(e)),i;!s.endOfStream()&&(i=this._encoder.handler(s,s.read()),i!==Ut);)Array.isArray(i)?r.push.apply(r,i):r.push(i);if(!this._streaming){for(;i=this._encoder.handler(s,s.read()),i!==Ut;)Array.isArray(i)?r.push.apply(r,i):r.push(i);this._encoder=null}return new Uint8Array(r)}};function ta(n){var e=n.fatal,t=0,r=0,s=0,i=128,o=191;this.handler=function(a,c){if(c===mr&&s!==0)return s=0,zr(e);if(c===mr)return Ut;if(s===0){if(st(c,0,127))return c;if(st(c,194,223))s=1,t=c-192;else if(st(c,224,239))c===224&&(i=160),c===237&&(o=159),s=2,t=c-224;else if(st(c,240,244))c===240&&(i=144),c===244&&(o=143),s=3,t=c-240;else return zr(e);return t=t<<6*s,null}if(!st(c,i,o))return t=s=r=0,i=128,o=191,a.prepend(c),zr(e);if(i=128,o=191,r+=1,t+=c-128<<6*(s-r),r!==s)return null;var l=t;return t=s=r=0,l}}function ra(n){n.fatal,this.handler=function(e,t){if(t===mr)return Ut;if(st(t,0,127))return t;var r,s;st(t,128,2047)?(r=1,s=192):st(t,2048,65535)?(r=2,s=224):st(t,65536,1114111)&&(r=3,s=240);for(var i=[(t>>6*r)+s];r>0;){var o=t>>6*(r-1);i.push(128|o&63),r-=1}return i}}const na=Object.freeze(Object.defineProperty({__proto__:null,TextDecoder:wr,TextEncoder:br},Symbol.toStringTag,{value:"Module"})),sa=ot(na);var ia=Qe&&Qe.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),oa=Qe&&Qe.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),et=Qe&&Qe.__decorate||function(n,e,t,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i},aa=Qe&&Qe.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.hasOwnProperty.call(n,t)&&ia(e,n,t);return oa(e,n),e},Ms=Qe&&Qe.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(be,"__esModule",{value:!0});var Fs=be.deserializeUnchecked=js=be.deserialize=zs=be.serialize=be.BinaryReader=be.BinaryWriter=be.BorshError=be.baseDecode=be.baseEncode=void 0;const ft=Ms(ao),qs=Ms(Cs),ca=aa(sa),ua=typeof TextDecoder!="function"?ca.TextDecoder:TextDecoder,la=new ua("utf-8",{fatal:!0});function da(n){return typeof n=="string"&&(n=U.from(n,"utf8")),qs.default.encode(U.from(n))}be.baseEncode=da;function fa(n){return U.from(qs.default.decode(n))}be.baseDecode=fa;const jr=1024;class Re extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}be.BorshError=Re;class Ks{constructor(){this.buf=U.alloc(jr),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=U.concat([this.buf,U.alloc(jr)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(U.from(new ft.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(U.from(new ft.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(U.from(new ft.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(U.from(new ft.default(e).toArray("le",64)))}writeBuffer(e){this.buf=U.concat([U.from(this.buf.subarray(0,this.length)),e,U.alloc(jr)]),this.length+=e.length}writeString(e){this.maybeResize();const t=U.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(U.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const r of e)this.maybeResize(),t(r)}toArray(){return this.buf.subarray(0,this.length)}}be.BinaryWriter=Ks;function tt(n,e,t){const r=t.value;t.value=function(...s){try{return r.apply(this,s)}catch(i){if(i instanceof RangeError){const o=i.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(o)>=0)throw new Re("Reached the end of buffer when deserializing")}throw i}}}class Ne{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new ft.default(e,"le")}readU128(){const e=this.readBuffer(16);return new ft.default(e,"le")}readU256(){const e=this.readBuffer(32);return new ft.default(e,"le")}readU512(){const e=this.readBuffer(64);return new ft.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new Re(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return la.decode(t)}catch(r){throw new Re(`Error decoding UTF-8 string: ${r}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),r=Array();for(let s=0;s<t;++s)r.push(e());return r}}et([tt],Ne.prototype,"readU8",null);et([tt],Ne.prototype,"readU16",null);et([tt],Ne.prototype,"readU32",null);et([tt],Ne.prototype,"readU64",null);et([tt],Ne.prototype,"readU128",null);et([tt],Ne.prototype,"readU256",null);et([tt],Ne.prototype,"readU512",null);et([tt],Ne.prototype,"readString",null);et([tt],Ne.prototype,"readFixedArray",null);et([tt],Ne.prototype,"readArray",null);be.BinaryReader=Ne;function $s(n){return n.charAt(0).toUpperCase()+n.slice(1)}function kt(n,e,t,r,s){try{if(typeof r=="string")s[`write${$s(r)}`](t);else if(r instanceof Array)if(typeof r[0]=="number"){if(t.length!==r[0])throw new Re(`Expecting byte array of length ${r[0]}, but got ${t.length} bytes`);s.writeFixedArray(t)}else if(r.length===2&&typeof r[1]=="number"){if(t.length!==r[1])throw new Re(`Expecting byte array of length ${r[1]}, but got ${t.length} bytes`);for(let i=0;i<r[1];i++)kt(n,null,t[i],r[0],s)}else s.writeArray(t,i=>{kt(n,e,i,r[0],s)});else if(r.kind!==void 0)switch(r.kind){case"option":{t==null?s.writeU8(0):(s.writeU8(1),kt(n,e,t,r.type,s));break}case"map":{s.writeU32(t.size),t.forEach((i,o)=>{kt(n,e,o,r.key,s),kt(n,e,i,r.value,s)});break}default:throw new Re(`FieldType ${r} unrecognized`)}else Ds(n,t,s)}catch(i){throw i instanceof Re&&i.addToFieldPath(e),i}}function Ds(n,e,t){if(typeof e.borshSerialize=="function"){e.borshSerialize(t);return}const r=n.get(e.constructor);if(!r)throw new Re(`Class ${e.constructor.name} is missing in schema`);if(r.kind==="struct")r.fields.map(([s,i])=>{kt(n,s,e[s],i,t)});else if(r.kind==="enum"){const s=e[r.field];for(let i=0;i<r.values.length;++i){const[o,a]=r.values[i];if(o===s){t.writeU8(i),kt(n,o,e[o],a,t);break}}}else throw new Re(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function ha(n,e,t=Ks){const r=new t;return Ds(n,e,r),r.toArray()}var zs=be.serialize=ha;function Et(n,e,t,r){try{if(typeof t=="string")return r[`read${$s(t)}`]();if(t instanceof Array){if(typeof t[0]=="number")return r.readFixedArray(t[0]);if(typeof t[1]=="number"){const s=[];for(let i=0;i<t[1];i++)s.push(Et(n,null,t[0],r));return s}else return r.readArray(()=>Et(n,e,t[0],r))}if(t.kind==="option")return r.readU8()?Et(n,e,t.type,r):void 0;if(t.kind==="map"){let s=new Map;const i=r.readU32();for(let o=0;o<i;o++){const a=Et(n,e,t.key,r),c=Et(n,e,t.value,r);s.set(a,c)}return s}return bn(n,t,r)}catch(s){throw s instanceof Re&&s.addToFieldPath(e),s}}function bn(n,e,t){if(typeof e.borshDeserialize=="function")return e.borshDeserialize(t);const r=n.get(e);if(!r)throw new Re(`Class ${e.name} is missing in schema`);if(r.kind==="struct"){const s={};for(const[i,o]of n.get(e).fields)s[i]=Et(n,i,o,t);return new e(s)}if(r.kind==="enum"){const s=t.readU8();if(s>=r.values.length)throw new Re(`Enum index: ${s} is out of range`);const[i,o]=r.values[s],a=Et(n,i,o,t);return new e({[i]:a})}throw new Re(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function pa(n,e,t,r=Ne){const s=new r(t),i=bn(n,e,s);if(s.offset<t.length)throw new Re(`Unexpected ${t.length-s.offset} bytes after deserialized data`);return i}var js=be.deserialize=pa;function ga(n,e,t,r=Ne){const s=new r(t);return bn(n,e,s)}Fs=be.deserializeUnchecked=ga;var b={};Object.defineProperty(b,"__esModule",{value:!0});b.s16=b.s8=b.nu64be=b.u48be=b.u40be=b.u32be=b.u24be=b.u16be=we=b.nu64=b.u48=b.u40=K=b.u32=b.u24=qe=b.u16=Y=b.u8=_t=b.offset=b.greedy=b.Constant=b.UTF8=b.CString=b.Blob=b.Boolean=b.BitField=b.BitStructure=b.VariantLayout=b.Union=b.UnionLayoutDiscriminator=b.UnionDiscriminator=b.Structure=b.Sequence=b.DoubleBE=b.Double=b.FloatBE=b.Float=b.NearInt64BE=b.NearInt64=b.NearUInt64BE=b.NearUInt64=b.IntBE=b.Int=b.UIntBE=b.UInt=b.OffsetLayout=b.GreedyCount=b.ExternalLayout=b.bindConstructorLayout=b.nameWithProperty=b.Layout=b.uint8ArrayToBuffer=b.checkUint8Array=void 0;b.constant=b.utf8=b.cstr=le=b.blob=b.unionLayoutDiscriminator=b.union=Ie=b.seq=b.bits=M=b.struct=b.f64be=b.f64=b.f32be=b.f32=b.ns64be=b.s48be=b.s40be=b.s32be=b.s24be=b.s16be=Le=b.ns64=b.s48=b.s40=b.s32=b.s24=void 0;const vn=co;function Kt(n){if(!(n instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}b.checkUint8Array=Kt;function X(n){return Kt(n),vn.Buffer.from(n.buffer,n.byteOffset,n.length)}b.uint8ArrayToBuffer=X;class re{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}b.Layout=re;function Sn(n,e){return e.property?n+"["+e.property+"]":n}b.nameWithProperty=Sn;function ma(n,e){if(typeof n!="function")throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(n,"layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof re))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(e,"boundConstructor_"))throw new Error("layout is already bound to a constructor");n.layout_=e,e.boundConstructor_=n,e.makeDestinationObject=()=>new n,Object.defineProperty(n.prototype,"encode",{value(t,r){return e.encode(this,t,r)},writable:!0}),Object.defineProperty(n,"decode",{value(t,r){return e.decode(t,r)},writable:!0})}b.bindConstructorLayout=ma;class Be extends re{isCount(){throw new Error("ExternalLayout is abstract")}}b.ExternalLayout=Be;class Hs extends Be{constructor(e=1,t){if(!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(e,t=0){Kt(e);const r=e.length-t;return Math.floor(r/this.elementSpan)}encode(e,t,r){return 0}}b.GreedyCount=Hs;class kn extends Be{constructor(e,t=0,r){if(!(e instanceof re))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof De||this.layout instanceof He}decode(e,t=0){return this.layout.decode(e,t+this.offset)}encode(e,t,r=0){return this.layout.encode(e,t,r+this.offset)}}b.OffsetLayout=kn;class De extends re{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return X(e).readUIntLE(t,this.span)}encode(e,t,r=0){return X(t).writeUIntLE(e,r,this.span),this.span}}b.UInt=De;class He extends re{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return X(e).readUIntBE(t,this.span)}encode(e,t,r=0){return X(t).writeUIntBE(e,r,this.span),this.span}}b.UIntBE=He;class It extends re{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return X(e).readIntLE(t,this.span)}encode(e,t,r=0){return X(t).writeIntLE(e,r,this.span),this.span}}b.Int=It;class $t extends re{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return X(e).readIntBE(t,this.span)}encode(e,t,r=0){return X(t).writeIntBE(e,r,this.span),this.span}}b.IntBE=$t;const en=Math.pow(2,32);function Cr(n){const e=Math.floor(n/en),t=n-e*en;return{hi32:e,lo32:t}}function Pr(n,e){return n*en+e}class Ws extends re{constructor(e){super(8,e)}decode(e,t=0){const r=X(e),s=r.readUInt32LE(t),i=r.readUInt32LE(t+4);return Pr(i,s)}encode(e,t,r=0){const s=Cr(e),i=X(t);return i.writeUInt32LE(s.lo32,r),i.writeUInt32LE(s.hi32,r+4),8}}b.NearUInt64=Ws;class Gs extends re{constructor(e){super(8,e)}decode(e,t=0){const r=X(e),s=r.readUInt32BE(t),i=r.readUInt32BE(t+4);return Pr(s,i)}encode(e,t,r=0){const s=Cr(e),i=X(t);return i.writeUInt32BE(s.hi32,r),i.writeUInt32BE(s.lo32,r+4),8}}b.NearUInt64BE=Gs;class Vs extends re{constructor(e){super(8,e)}decode(e,t=0){const r=X(e),s=r.readUInt32LE(t),i=r.readInt32LE(t+4);return Pr(i,s)}encode(e,t,r=0){const s=Cr(e),i=X(t);return i.writeUInt32LE(s.lo32,r),i.writeInt32LE(s.hi32,r+4),8}}b.NearInt64=Vs;class Js extends re{constructor(e){super(8,e)}decode(e,t=0){const r=X(e),s=r.readInt32BE(t),i=r.readUInt32BE(t+4);return Pr(s,i)}encode(e,t,r=0){const s=Cr(e),i=X(t);return i.writeInt32BE(s.hi32,r),i.writeUInt32BE(s.lo32,r+4),8}}b.NearInt64BE=Js;class Zs extends re{constructor(e){super(4,e)}decode(e,t=0){return X(e).readFloatLE(t)}encode(e,t,r=0){return X(t).writeFloatLE(e,r),4}}b.Float=Zs;class Xs extends re{constructor(e){super(4,e)}decode(e,t=0){return X(e).readFloatBE(t)}encode(e,t,r=0){return X(t).writeFloatBE(e,r),4}}b.FloatBE=Xs;class Ys extends re{constructor(e){super(8,e)}decode(e,t=0){return X(e).readDoubleLE(t)}encode(e,t,r=0){return X(t).writeDoubleLE(e,r),8}}b.Double=Ys;class Qs extends re{constructor(e){super(8,e)}decode(e,t=0){return X(e).readDoubleBE(t)}encode(e,t,r=0){return X(t).writeDoubleBE(e,r),8}}b.DoubleBE=Qs;class ei extends re{constructor(e,t,r){if(!(e instanceof re))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof Be&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let s=-1;!(t instanceof Be)&&0<e.span&&(s=t*e.span),super(s,r),this.elementLayout=e,this.count=t}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0,s=this.count;if(s instanceof Be&&(s=s.decode(e,t)),0<this.elementLayout.span)r=s*this.elementLayout.span;else{let i=0;for(;i<s;)r+=this.elementLayout.getSpan(e,t+r),++i}return r}decode(e,t=0){const r=[];let s=0,i=this.count;for(i instanceof Be&&(i=i.decode(e,t));s<i;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),s+=1;return r}encode(e,t,r=0){const s=this.elementLayout,i=e.reduce((o,a)=>o+s.encode(a,t,r+o),0);return this.count instanceof Be&&this.count.encode(e.length,t,r),i}}b.Sequence=ei;class ti extends re{constructor(e,t,r){if(!(Array.isArray(e)&&e.reduce((i,o)=>i&&o instanceof re,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&r===void 0&&(r=t,t=void 0);for(const i of e)if(0>i.span&&i.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let s=-1;try{s=e.reduce((i,o)=>i+o.getSpan(),0)}catch{}super(s,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;try{r=this.fields.reduce((s,i)=>{const o=i.getSpan(e,t);return t+=o,s+o},0)}catch{throw new RangeError("indeterminate span")}return r}decode(e,t=0){Kt(e);const r=this.makeDestinationObject();for(const s of this.fields)if(s.property!==void 0&&(r[s.property]=s.decode(e,t)),t+=s.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return r}encode(e,t,r=0){const s=r;let i=0,o=0;for(const a of this.fields){let c=a.span;if(o=0<c?c:0,a.property!==void 0){const l=e[a.property];l!==void 0&&(o=a.encode(l,t,r),0>c&&(c=a.getSpan(t,r)))}i=r,r+=c}return i+o-s}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)r.property!==void 0&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}}b.Structure=ti;class En{constructor(e){this.property=e}decode(e,t){throw new Error("UnionDiscriminator is abstract")}encode(e,t,r){throw new Error("UnionDiscriminator is abstract")}}b.UnionDiscriminator=En;class vr extends En{constructor(e,t){if(!(e instanceof Be&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,r){return this.layout.encode(e,t,r)}}b.UnionLayoutDiscriminator=vr;class _n extends re{constructor(e,t,r){let s;if(e instanceof De||e instanceof He)s=new vr(new kn(e));else if(e instanceof Be&&e.isCount())s=new vr(e);else if(e instanceof En)s=e;else throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof re))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let i=-1;t&&(i=t.span,0<=i&&(e instanceof De||e instanceof He)&&(i+=s.layout.span)),super(i,r),this.discriminator=s,this.usesPrefixDiscriminator=e instanceof De||e instanceof He,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(a){return o(a)},this.configGetSourceVariant=function(a){o=a.bind(this)}}getSpan(e,t=0){if(0<=this.span)return this.span;const r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}defaultGetSourceVariant(e){if(Object.prototype.hasOwnProperty.call(e,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(e,this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||t.property&&Object.prototype.hasOwnProperty.call(e,t.property)))return t}else for(const t in this.registry){const r=this.registry[t];if(r.property&&Object.prototype.hasOwnProperty.call(e,r.property))return r}throw new Error("unable to infer src variant")}decode(e,t=0){let r;const s=this.discriminator,i=s.decode(e,t),o=this.registry[i];if(o===void 0){const a=this.defaultLayout;let c=0;this.usesPrefixDiscriminator&&(c=s.layout.span),r=this.makeDestinationObject(),r[s.property]=i,r[a.property]=a.decode(e,t+c)}else r=o.decode(e,t);return r}encode(e,t,r=0){const s=this.getSourceVariant(e);if(s===void 0){const i=this.discriminator,o=this.defaultLayout;let a=0;return this.usesPrefixDiscriminator&&(a=i.layout.span),i.encode(e[i.property],t,r),a+o.encode(e[o.property],t,r+a)}return s.encode(e,t,r)}addVariant(e,t,r){const s=new ri(this,e,t,r);return this.registry[e]=s,s}getVariant(e,t=0){let r;return e instanceof Uint8Array?r=this.discriminator.decode(e,t):r=e,this.registry[r]}}b.Union=_n;class ri extends re{constructor(e,t,r,s){if(!(e instanceof _n))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof r=="string"&&s===void 0&&(s=r,r=null),r){if(!(r instanceof re))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=r.span&&r.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof s!="string")throw new TypeError("variant must have a String property")}let i=e.span;0>e.span&&(i=r?r.span:0,0<=i&&e.usesPrefixDiscriminator&&(i+=e.discriminator.layout.span)),super(i,s),this.union=e,this.variant=t,this.layout=r||null}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span);let s=0;return this.layout&&(s=this.layout.getSpan(e,t+r)),r+s}decode(e,t=0){const r=this.makeDestinationObject();if(this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let s=0;return this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+s):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(e,t,r=0){let s=0;if(this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(e,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);let i=s;if(this.layout&&(this.layout.encode(e[this.property],t,r+s),i+=this.layout.getSpan(t,r+s),0<=this.union.span&&i>this.union.span))throw new Error("encoded variant overruns containing union");return i}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}b.VariantLayout=ri;function Pt(n){return 0>n&&(n+=4294967296),n}class An extends re{constructor(e,t,r){if(!(e instanceof De||e instanceof He))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof t=="string"&&r===void 0&&(r=t,t=!1),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,r),this.word=e,this.msb=!!t,this.fields=[];let s=0;this._packedSetValue=function(i){return s=Pt(i),this},this._packedGetValue=function(){return s}}decode(e,t=0){const r=this.makeDestinationObject(),s=this.word.decode(e,t);this._packedSetValue(s);for(const i of this.fields)i.property!==void 0&&(r[i.property]=i.decode(e));return r}encode(e,t,r=0){const s=this.word.decode(t,r);this._packedSetValue(s);for(const i of this.fields)if(i.property!==void 0){const o=e[i.property];o!==void 0&&i.encode(o)}return this.word.encode(this._packedGetValue(),t,r)}addField(e,t){const r=new Rn(this,e,t);return this.fields.push(r),r}addBoolean(e){const t=new ni(this,e);return this.fields.push(t),t}fieldFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}}b.BitStructure=An;class Rn{constructor(e,t,r){if(!(e instanceof An))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const s=8*e.span,i=e.fields.reduce((o,a)=>o+a.bits,0);if(t+i>s)throw new Error("bits too long for span remainder ("+(s-i)+" of "+s+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,t===32&&(this.valueMask=4294967295),this.start=i,this.container.msb&&(this.start=s-i-t),this.wordMask=Pt(this.valueMask<<this.start),this.property=r}decode(e,t){const r=this.container._packedGetValue();return Pt(r&this.wordMask)>>>this.start}encode(e){if(typeof e!="number"||!Number.isInteger(e)||e!==Pt(e&this.valueMask))throw new TypeError(Sn("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),r=Pt(e<<this.start);this.container._packedSetValue(Pt(t&~this.wordMask)|r)}}b.BitField=Rn;let ni=class extends Rn{constructor(e,t){super(e,1,t)}decode(e,t){return!!super.decode(e,t)}encode(e){typeof e=="boolean"&&(e=+e),super.encode(e)}};b.Boolean=ni;class si extends re{constructor(e,t){if(!(e instanceof Be&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof Be||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t=0){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),X(e).slice(t,t+r)}encode(e,t,r){let s=this.length;if(this.length instanceof Be&&(s=e.length),!(e instanceof Uint8Array&&s===e.length))throw new TypeError(Sn("Blob.encode",this)+" requires (length "+s+") Uint8Array as src");if(r+s>t.length)throw new RangeError("encoding overruns Uint8Array");const i=X(e);return X(t).write(i.toString("hex"),r,s,"hex"),this.length instanceof Be&&this.length.encode(s,t,r),s}}b.Blob=si;class ii extends re{constructor(e){super(-1,e)}getSpan(e,t=0){Kt(e);let r=t;for(;r<e.length&&e[r]!==0;)r+=1;return 1+r-t}decode(e,t=0){const r=this.getSpan(e,t);return X(e).slice(t,t+r-1).toString("utf-8")}encode(e,t,r=0){typeof e!="string"&&(e=String(e));const s=vn.Buffer.from(e,"utf8"),i=s.length;if(r+i>t.length)throw new RangeError("encoding overruns Buffer");const o=X(t);return s.copy(o,r),o[r+i]=0,i+1}}b.CString=ii;class oi extends re{constructor(e,t){if(typeof e=="string"&&t===void 0&&(t=e,e=void 0),e===void 0)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(e,t=0){return Kt(e),e.length-t}decode(e,t=0){const r=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<r)throw new RangeError("text length exceeds maxSpan");return X(e).slice(t,t+r).toString("utf-8")}encode(e,t,r=0){typeof e!="string"&&(e=String(e));const s=vn.Buffer.from(e,"utf8"),i=s.length;if(0<=this.maxSpan&&this.maxSpan<i)throw new RangeError("text length exceeds maxSpan");if(r+i>t.length)throw new RangeError("encoding overruns Buffer");return s.copy(X(t),r),i}}b.UTF8=oi;class ai extends re{constructor(e,t){super(0,t),this.value=e}decode(e,t){return this.value}encode(e,t,r){return 0}}b.Constant=ai;b.greedy=(n,e)=>new Hs(n,e);var _t=b.offset=(n,e,t)=>new kn(n,e,t),Y=b.u8=n=>new De(1,n),qe=b.u16=n=>new De(2,n);b.u24=n=>new De(3,n);var K=b.u32=n=>new De(4,n);b.u40=n=>new De(5,n);b.u48=n=>new De(6,n);var we=b.nu64=n=>new Ws(n);b.u16be=n=>new He(2,n);b.u24be=n=>new He(3,n);b.u32be=n=>new He(4,n);b.u40be=n=>new He(5,n);b.u48be=n=>new He(6,n);b.nu64be=n=>new Gs(n);b.s8=n=>new It(1,n);b.s16=n=>new It(2,n);b.s24=n=>new It(3,n);b.s32=n=>new It(4,n);b.s40=n=>new It(5,n);b.s48=n=>new It(6,n);var Le=b.ns64=n=>new Vs(n);b.s16be=n=>new $t(2,n);b.s24be=n=>new $t(3,n);b.s32be=n=>new $t(4,n);b.s40be=n=>new $t(5,n);b.s48be=n=>new $t(6,n);b.ns64be=n=>new Js(n);b.f32=n=>new Zs(n);b.f32be=n=>new Xs(n);b.f64=n=>new Ys(n);b.f64be=n=>new Qs(n);var M=b.struct=(n,e,t)=>new ti(n,e,t);b.bits=(n,e,t)=>new An(n,e,t);var Ie=b.seq=(n,e,t)=>new ei(n,e,t);b.union=(n,e,t)=>new _n(n,e,t);b.unionLayoutDiscriminator=(n,e)=>new vr(n,e);var le=b.blob=(n,e)=>new si(n,e);b.cstr=n=>new ii(n);b.utf8=(n,e)=>new oi(n,e);b.constant=(n,e)=>new ai(n,e);var er={};Object.defineProperty(er,"__esModule",{value:!0});function ya(n){{const e=U.from(n);e.reverse();const t=e.toString("hex");return t.length===0?BigInt(0):BigInt(`0x${t}`)}}var wa=er.toBigIntLE=ya;function ba(n){{const e=n.toString("hex");return e.length===0?BigInt(0):BigInt(`0x${e}`)}}er.toBigIntBE=ba;function va(n,e){{const t=n.toString(16),r=U.from(t.padStart(e*2,"0").slice(0,e*2),"hex");return r.reverse(),r}}var Sa=er.toBufferLE=va;function ka(n,e){{const t=n.toString(16);return U.from(t.padStart(e*2,"0").slice(0,e*2),"hex")}}er.toBufferBE=ka;class Ea extends TypeError{constructor(e,t){let r;const{message:s,...i}=e,{path:o}=e,a=o.length===0?s:"At path: "+o.join(".")+" -- "+s;super(a),Object.assign(this,i),this.name=this.constructor.name,this.failures=()=>{var c;return(c=r)!=null?c:r=[e,...t()]}}}function _a(n){return pt(n)&&typeof n[Symbol.iterator]=="function"}function pt(n){return typeof n=="object"&&n!=null}function We(n){return typeof n=="string"?JSON.stringify(n):""+n}function Aa(n){const{done:e,value:t}=n.next();return e?void 0:t}function Ra(n,e,t,r){if(n===!0)return;n===!1?n={}:typeof n=="string"&&(n={message:n});const{path:s,branch:i}=e,{type:o}=t,{refinement:a,message:c="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+We(r)+"`"}=n;return{value:r,type:o,refinement:a,key:s[s.length-1],path:s,branch:i,...n,message:c}}function*ns(n,e,t,r){_a(n)||(n=[n]);for(const s of n){const i=Ra(s,e,t,r);i&&(yield i)}}function*In(n,e,t={}){const{path:r=[],branch:s=[n],coerce:i=!1,mask:o=!1}=t,a={path:r,branch:s};if(i&&(n=e.coercer(n,a),o&&e.type!=="type"&&pt(e.schema)&&pt(n)&&!Array.isArray(n)))for(const l in n)e.schema[l]===void 0&&delete n[l];let c=!0;for(const l of e.validator(n,a))c=!1,yield[l,void 0];for(let[l,u,h]of e.entries(n,a)){const f=In(u,h,{path:l===void 0?r:[...r,l],branch:l===void 0?s:[...s,u],coerce:i,mask:o});for(const d of f)d[0]?(c=!1,yield[d[0],void 0]):i&&(u=d[1],l===void 0?n=u:n instanceof Map?n.set(l,u):n instanceof Set?n.add(u):pt(n)&&(n[l]=u))}if(c)for(const l of e.refiner(n,a))c=!1,yield[l,void 0];c&&(yield[void 0,n])}let rt=class{constructor(e){const{type:t,schema:r,validator:s,refiner:i,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=t,this.schema=r,this.entries=a,this.coercer=o,s?this.validator=(c,l)=>{const u=s(c,l);return ns(u,l,this,c)}:this.validator=()=>[],i?this.refiner=(c,l)=>{const u=i(c,l);return ns(u,l,this,c)}:this.refiner=()=>[]}assert(e){return Ia(e,this)}create(e){return x(e,this)}is(e){return ci(e,this)}mask(e){return xa(e,this)}validate(e,t={}){return tr(e,this,t)}};function Ia(n,e){const t=tr(n,e);if(t[0])throw t[0]}function x(n,e){const t=tr(n,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function xa(n,e){const t=tr(n,e,{coerce:!0,mask:!0});if(t[0])throw t[0];return t[1]}function ci(n,e){return!tr(n,e)[0]}function tr(n,e,t={}){const r=In(n,e,t),s=Aa(r);return s[0]?[new Ea(s[0],function*(){for(const o of r)o[0]&&(yield o[0])}),void 0]:[void 0,s[1]]}function xt(n,e){return new rt({type:n,schema:null,validator:e})}function Ba(){return xt("any",()=>!0)}function P(n){return new rt({type:"array",schema:n,*entries(e){if(n&&Array.isArray(e))for(const[t,r]of e.entries())yield[t,r,n]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+We(e)}})}function it(){return xt("boolean",n=>typeof n=="boolean")}function xn(n){return xt("instance",e=>e instanceof n||"Expected a `"+n.name+"` instance, but received: "+We(e))}function ue(n){const e=We(n),t=typeof n;return new rt({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?n:null,validator(r){return r===n||"Expected the literal `"+e+"`, but received: "+We(r)}})}function Ca(){return xt("never",()=>!1)}function T(n){return new rt({...n,validator:(e,t)=>e===null||n.validator(e,t),refiner:(e,t)=>e===null||n.refiner(e,t)})}function w(){return xt("number",n=>typeof n=="number"&&!isNaN(n)||"Expected a number, but received: "+We(n))}function D(n){return new rt({...n,validator:(e,t)=>e===void 0||n.validator(e,t),refiner:(e,t)=>e===void 0||n.refiner(e,t)})}function ui(n,e){return new rt({type:"record",schema:null,*entries(t){if(pt(t))for(const r in t){const s=t[r];yield[r,r,n],yield[r,s,e]}},validator(t){return pt(t)||"Expected an object, but received: "+We(t)}})}function R(){return xt("string",n=>typeof n=="string"||"Expected a string, but received: "+We(n))}function Bn(n){const e=Ca();return new rt({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){const r=Math.max(n.length,t.length);for(let s=0;s<r;s++)yield[s,t[s],n[s]||e]}},validator(t){return Array.isArray(t)||"Expected an array, but received: "+We(t)}})}function _(n){const e=Object.keys(n);return new rt({type:"type",schema:n,*entries(t){if(pt(t))for(const r of e)yield[r,t[r],n[r]]},validator(t){return pt(t)||"Expected an object, but received: "+We(t)}})}function Pe(n){const e=n.map(t=>t.type).join(" | ");return new rt({type:"union",schema:null,validator(t,r){const s=[];for(const i of n){const[...o]=In(t,i,r),[a]=o;if(a[0])for(const[c]of o)c&&s.push(c);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+We(t),...s]}})}function rr(){return xt("unknown",()=>!0)}function nr(n,e,t){return new rt({...n,coercer:(r,s)=>ci(r,e)?n.coercer(t(r,s),s):n.coercer(r,s)})}var lr,Pa=new Uint8Array(16);function li(){if(!lr&&(lr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!lr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return lr(Pa)}const Ta=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Tr(n){return typeof n=="string"&&Ta.test(n)}var ye=[];for(var Hr=0;Hr<256;++Hr)ye.push((Hr+256).toString(16).substr(1));function Or(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(ye[n[e+0]]+ye[n[e+1]]+ye[n[e+2]]+ye[n[e+3]]+"-"+ye[n[e+4]]+ye[n[e+5]]+"-"+ye[n[e+6]]+ye[n[e+7]]+"-"+ye[n[e+8]]+ye[n[e+9]]+"-"+ye[n[e+10]]+ye[n[e+11]]+ye[n[e+12]]+ye[n[e+13]]+ye[n[e+14]]+ye[n[e+15]]).toLowerCase();if(!Tr(t))throw TypeError("Stringified UUID is invalid");return t}var ss,Wr,Gr=0,Vr=0;function Oa(n,e,t){var r=e&&t||0,s=e||new Array(16);n=n||{};var i=n.node||ss,o=n.clockseq!==void 0?n.clockseq:Wr;if(i==null||o==null){var a=n.random||(n.rng||li)();i==null&&(i=ss=[a[0]|1,a[1],a[2],a[3],a[4],a[5]]),o==null&&(o=Wr=(a[6]<<8|a[7])&16383)}var c=n.msecs!==void 0?n.msecs:Date.now(),l=n.nsecs!==void 0?n.nsecs:Vr+1,u=c-Gr+(l-Vr)/1e4;if(u<0&&n.clockseq===void 0&&(o=o+1&16383),(u<0||c>Gr)&&n.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Gr=c,Vr=l,Wr=o,c+=122192928e5;var h=((c&268435455)*1e4+l)%4294967296;s[r++]=h>>>24&255,s[r++]=h>>>16&255,s[r++]=h>>>8&255,s[r++]=h&255;var f=c/4294967296*1e4&268435455;s[r++]=f>>>8&255,s[r++]=f&255,s[r++]=f>>>24&15|16,s[r++]=f>>>16&255,s[r++]=o>>>8|128,s[r++]=o&255;for(var d=0;d<6;++d)s[r+d]=i[d];return e||Or(s)}function di(n){if(!Tr(n))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(n.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(n.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(n.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(n.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(n.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}function La(n){n=unescape(encodeURIComponent(n));for(var e=[],t=0;t<n.length;++t)e.push(n.charCodeAt(t));return e}var Na="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Ua="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function fi(n,e,t){function r(s,i,o,a){if(typeof s=="string"&&(s=La(s)),typeof i=="string"&&(i=di(i)),i.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var c=new Uint8Array(16+s.length);if(c.set(i),c.set(s,i.length),c=t(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,o){a=a||0;for(var l=0;l<16;++l)o[a+l]=c[l];return o}return Or(c)}try{r.name=n}catch{}return r.DNS=Na,r.URL=Ua,r}function Ma(n){if(typeof n=="string"){var e=unescape(encodeURIComponent(n));n=new Uint8Array(e.length);for(var t=0;t<e.length;++t)n[t]=e.charCodeAt(t)}return Fa(qa(Ka(n),n.length*8))}function Fa(n){for(var e=[],t=n.length*32,r="0123456789abcdef",s=0;s<t;s+=8){var i=n[s>>5]>>>s%32&255,o=parseInt(r.charAt(i>>>4&15)+r.charAt(i&15),16);e.push(o)}return e}function hi(n){return(n+64>>>9<<4)+14+1}function qa(n,e){n[e>>5]|=128<<e%32,n[hi(e)-1]=e;for(var t=1732584193,r=-271733879,s=-1732584194,i=271733878,o=0;o<n.length;o+=16){var a=t,c=r,l=s,u=i;t=ke(t,r,s,i,n[o],7,-680876936),i=ke(i,t,r,s,n[o+1],12,-389564586),s=ke(s,i,t,r,n[o+2],17,606105819),r=ke(r,s,i,t,n[o+3],22,-1044525330),t=ke(t,r,s,i,n[o+4],7,-176418897),i=ke(i,t,r,s,n[o+5],12,1200080426),s=ke(s,i,t,r,n[o+6],17,-1473231341),r=ke(r,s,i,t,n[o+7],22,-45705983),t=ke(t,r,s,i,n[o+8],7,1770035416),i=ke(i,t,r,s,n[o+9],12,-1958414417),s=ke(s,i,t,r,n[o+10],17,-42063),r=ke(r,s,i,t,n[o+11],22,-1990404162),t=ke(t,r,s,i,n[o+12],7,1804603682),i=ke(i,t,r,s,n[o+13],12,-40341101),s=ke(s,i,t,r,n[o+14],17,-1502002290),r=ke(r,s,i,t,n[o+15],22,1236535329),t=Ee(t,r,s,i,n[o+1],5,-165796510),i=Ee(i,t,r,s,n[o+6],9,-1069501632),s=Ee(s,i,t,r,n[o+11],14,643717713),r=Ee(r,s,i,t,n[o],20,-373897302),t=Ee(t,r,s,i,n[o+5],5,-701558691),i=Ee(i,t,r,s,n[o+10],9,38016083),s=Ee(s,i,t,r,n[o+15],14,-660478335),r=Ee(r,s,i,t,n[o+4],20,-405537848),t=Ee(t,r,s,i,n[o+9],5,568446438),i=Ee(i,t,r,s,n[o+14],9,-1019803690),s=Ee(s,i,t,r,n[o+3],14,-187363961),r=Ee(r,s,i,t,n[o+8],20,1163531501),t=Ee(t,r,s,i,n[o+13],5,-1444681467),i=Ee(i,t,r,s,n[o+2],9,-51403784),s=Ee(s,i,t,r,n[o+7],14,1735328473),r=Ee(r,s,i,t,n[o+12],20,-1926607734),t=_e(t,r,s,i,n[o+5],4,-378558),i=_e(i,t,r,s,n[o+8],11,-2022574463),s=_e(s,i,t,r,n[o+11],16,1839030562),r=_e(r,s,i,t,n[o+14],23,-35309556),t=_e(t,r,s,i,n[o+1],4,-1530992060),i=_e(i,t,r,s,n[o+4],11,1272893353),s=_e(s,i,t,r,n[o+7],16,-155497632),r=_e(r,s,i,t,n[o+10],23,-1094730640),t=_e(t,r,s,i,n[o+13],4,681279174),i=_e(i,t,r,s,n[o],11,-358537222),s=_e(s,i,t,r,n[o+3],16,-722521979),r=_e(r,s,i,t,n[o+6],23,76029189),t=_e(t,r,s,i,n[o+9],4,-640364487),i=_e(i,t,r,s,n[o+12],11,-421815835),s=_e(s,i,t,r,n[o+15],16,530742520),r=_e(r,s,i,t,n[o+2],23,-995338651),t=Ae(t,r,s,i,n[o],6,-198630844),i=Ae(i,t,r,s,n[o+7],10,1126891415),s=Ae(s,i,t,r,n[o+14],15,-1416354905),r=Ae(r,s,i,t,n[o+5],21,-57434055),t=Ae(t,r,s,i,n[o+12],6,1700485571),i=Ae(i,t,r,s,n[o+3],10,-1894986606),s=Ae(s,i,t,r,n[o+10],15,-1051523),r=Ae(r,s,i,t,n[o+1],21,-2054922799),t=Ae(t,r,s,i,n[o+8],6,1873313359),i=Ae(i,t,r,s,n[o+15],10,-30611744),s=Ae(s,i,t,r,n[o+6],15,-1560198380),r=Ae(r,s,i,t,n[o+13],21,1309151649),t=Ae(t,r,s,i,n[o+4],6,-145523070),i=Ae(i,t,r,s,n[o+11],10,-1120210379),s=Ae(s,i,t,r,n[o+2],15,718787259),r=Ae(r,s,i,t,n[o+9],21,-343485551),t=ht(t,a),r=ht(r,c),s=ht(s,l),i=ht(i,u)}return[t,r,s,i]}function Ka(n){if(n.length===0)return[];for(var e=n.length*8,t=new Uint32Array(hi(e)),r=0;r<e;r+=8)t[r>>5]|=(n[r/8]&255)<<r%32;return t}function ht(n,e){var t=(n&65535)+(e&65535),r=(n>>16)+(e>>16)+(t>>16);return r<<16|t&65535}function $a(n,e){return n<<e|n>>>32-e}function Lr(n,e,t,r,s,i){return ht($a(ht(ht(e,n),ht(r,i)),s),t)}function ke(n,e,t,r,s,i,o){return Lr(e&t|~e&r,n,e,s,i,o)}function Ee(n,e,t,r,s,i,o){return Lr(e&r|t&~r,n,e,s,i,o)}function _e(n,e,t,r,s,i,o){return Lr(e^t^r,n,e,s,i,o)}function Ae(n,e,t,r,s,i,o){return Lr(t^(e|~r),n,e,s,i,o)}var Da=fi("v3",48,Ma);const za=Da;function ja(n,e,t){n=n||{};var r=n.random||(n.rng||li)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(var s=0;s<16;++s)e[t+s]=r[s];return e}return Or(r)}function Ha(n,e,t,r){switch(n){case 0:return e&t^~e&r;case 1:return e^t^r;case 2:return e&t^e&r^t&r;case 3:return e^t^r}}function Jr(n,e){return n<<e|n>>>32-e}function Wa(n){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){var r=unescape(encodeURIComponent(n));n=[];for(var s=0;s<r.length;++s)n.push(r.charCodeAt(s))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);for(var i=n.length/4+2,o=Math.ceil(i/16),a=new Array(o),c=0;c<o;++c){for(var l=new Uint32Array(16),u=0;u<16;++u)l[u]=n[c*64+u*4]<<24|n[c*64+u*4+1]<<16|n[c*64+u*4+2]<<8|n[c*64+u*4+3];a[c]=l}a[o-1][14]=(n.length-1)*8/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=(n.length-1)*8&4294967295;for(var h=0;h<o;++h){for(var f=new Uint32Array(80),d=0;d<16;++d)f[d]=a[h][d];for(var p=16;p<80;++p)f[p]=Jr(f[p-3]^f[p-8]^f[p-14]^f[p-16],1);for(var g=t[0],y=t[1],E=t[2],v=t[3],m=t[4],A=0;A<80;++A){var S=Math.floor(A/20),C=Jr(g,5)+Ha(S,y,E,v)+m+e[S]+f[A]>>>0;m=v,v=E,E=Jr(y,30)>>>0,y=g,g=C}t[0]=t[0]+g>>>0,t[1]=t[1]+y>>>0,t[2]=t[2]+E>>>0,t[3]=t[3]+v>>>0,t[4]=t[4]+m>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var Ga=fi("v5",80,Wa);const Va=Ga,Ja="00000000-0000-0000-0000-000000000000";function Za(n){if(!Tr(n))throw TypeError("Invalid UUID");return parseInt(n.substr(14,1),16)}const Xa=Object.freeze(Object.defineProperty({__proto__:null,NIL:Ja,parse:di,stringify:Or,v1:Oa,v3:za,v4:ja,v5:Va,validate:Tr,version:Za},Symbol.toStringTag,{value:"Module"})),pi=ot(Xa),Ya=pi.v4,Qa=function(n,e,t,r){if(typeof n!="string")throw new TypeError(n+" must be a string");r=r||{};const s=typeof r.version=="number"?r.version:2;if(s!==1&&s!==2)throw new TypeError(s+" must be 1 or 2");const i={method:n};if(s===2&&(i.jsonrpc="2.0"),e){if(typeof e!="object"&&!Array.isArray(e))throw new TypeError(e+" must be an object, array or omitted");i.params=e}if(typeof t>"u"){const o=typeof r.generator=="function"?r.generator:function(){return Ya()};i.id=o(i,r)}else s===2&&t===null?r.notificationIdNull&&(i.id=null):i.id=t;return i};var ec=Qa;const tc=pi.v4,rc=ec,Xt=function(n,e){if(!(this instanceof Xt))return new Xt(n,e);e||(e={}),this.options={reviver:typeof e.reviver<"u"?e.reviver:null,replacer:typeof e.replacer<"u"?e.replacer:null,generator:typeof e.generator<"u"?e.generator:function(){return tc()},version:typeof e.version<"u"?e.version:2,notificationIdNull:typeof e.notificationIdNull=="boolean"?e.notificationIdNull:!1},this.callServer=n};var nc=Xt;Xt.prototype.request=function(n,e,t,r){const s=this;let i=null;const o=Array.isArray(n)&&typeof e=="function";if(this.options.version===1&&o)throw new TypeError("JSON-RPC 1.0 does not support batching");if(o||!o&&n&&typeof n=="object"&&typeof e=="function")r=e,i=n;else{typeof t=="function"&&(r=t,t=void 0);const l=typeof r=="function";try{i=rc(n,e,t,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(u){if(l)return r(u);throw u}if(!l)return i}let c;try{c=JSON.stringify(i,this.options.replacer)}catch(l){return r(l)}return this.callServer(c,function(l,u){s._parseResponse(l,u,r)}),i};Xt.prototype._parseResponse=function(n,e,t){if(n){t(n);return}if(!e)return t();let r;try{r=JSON.parse(e,this.options.reviver)}catch(s){return t(s)}if(t.length===3)if(Array.isArray(r)){const s=function(o){return typeof o.error<"u"},i=function(o){return!s(o)};return t(null,r.filter(s),r.filter(i))}else return t(null,r.error,r.result);t(null,r)};const sc=_r(nc);var gi={},mi={exports:{}};(function(n){function e(t){return t&&t.__esModule?t:{default:t}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(mi);var yi=mi.exports;const ic=ot(uo),oc=ot(lo),wi=ot(fo),bi=ot(ho),vi=ot(po),Si=ot(go),ki=ot(mo);(function(n){var e=yi;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(yo),r=e(ic),s=e(oc),i=e(wi),o=e(bi),a=e(vi),c=e(Si),l=e(ki),u=xs;function h(g){var y=f();return function(){var v=(0,l.default)(g),m;if(y){var A=(0,l.default)(this).constructor;m=Reflect.construct(v,arguments,A)}else m=v.apply(this,arguments);return(0,c.default)(this,m)}}function f(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var d=function(g,y){var E={};for(var v in g)Object.prototype.hasOwnProperty.call(g,v)&&y.indexOf(v)<0&&(E[v]=g[v]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var m=0,v=Object.getOwnPropertySymbols(g);m<v.length;m++)y.indexOf(v[m])<0&&Object.prototype.propertyIsEnumerable.call(g,v[m])&&(E[v[m]]=g[v[m]]);return E},p=function(g){(0,a.default)(E,g);var y=h(E);function E(v){var m,A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"ws://localhost:8080",S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},C=arguments.length>3?arguments[3]:void 0;(0,i.default)(this,E);var B=S.autoconnect,N=B===void 0?!0:B,V=S.reconnect,oe=V===void 0?!0:V,fe=S.reconnect_interval,me=fe===void 0?1e3:fe,ae=S.max_reconnects,vt=ae===void 0?5:ae,Ge=d(S,["autoconnect","reconnect","reconnect_interval","max_reconnects"]);return m=y.call(this),m.webSocketFactory=v,m.queue={},m.rpc_id=0,m.address=A,m.autoconnect=N,m.ready=!1,m.reconnect=oe,m.reconnect_timer_id=void 0,m.reconnect_interval=me,m.max_reconnects=vt,m.rest_options=Ge,m.current_reconnects=0,m.generate_request_id=C||function(){return++m.rpc_id},m.autoconnect&&m._connect(m.address,Object.assign({autoconnect:m.autoconnect,reconnect:m.reconnect,reconnect_interval:m.reconnect_interval,max_reconnects:m.max_reconnects},m.rest_options)),m}return(0,o.default)(E,[{key:"connect",value:function(){this.socket||this._connect(this.address,Object.assign({autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects},this.rest_options))}},{key:"call",value:function(m,A,S,C){var B=this;return!C&&(0,s.default)(S)==="object"&&(C=S,S=null),new Promise(function(N,V){if(!B.ready)return V(new Error("socket not ready"));var oe=B.generate_request_id(m,A),fe={jsonrpc:"2.0",method:m,params:A||null,id:oe};B.socket.send(JSON.stringify(fe),C,function(me){if(me)return V(me);B.queue[oe]={promise:[N,V]},S&&(B.queue[oe].timeout=setTimeout(function(){delete B.queue[oe],V(new Error("reply timeout"))},S))})})}},{key:"login",value:function(){var v=(0,r.default)(t.default.mark(function A(S){var C;return t.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,this.call("rpc.login",S);case 2:if(C=N.sent,C){N.next=5;break}throw new Error("authentication failed");case 5:return N.abrupt("return",C);case 6:case"end":return N.stop()}},A,this)}));function m(A){return v.apply(this,arguments)}return m}()},{key:"listMethods",value:function(){var v=(0,r.default)(t.default.mark(function A(){return t.default.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,this.call("__listMethods");case 2:return C.abrupt("return",C.sent);case 3:case"end":return C.stop()}},A,this)}));function m(){return v.apply(this,arguments)}return m}()},{key:"notify",value:function(m,A){var S=this;return new Promise(function(C,B){if(!S.ready)return B(new Error("socket not ready"));var N={jsonrpc:"2.0",method:m,params:A||null};S.socket.send(JSON.stringify(N),function(V){if(V)return B(V);C()})})}},{key:"subscribe",value:function(){var v=(0,r.default)(t.default.mark(function A(S){var C;return t.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return typeof S=="string"&&(S=[S]),N.next=3,this.call("rpc.on",S);case 3:if(C=N.sent,!(typeof S=="string"&&C[S]!=="ok")){N.next=6;break}throw new Error("Failed subscribing to an event '"+S+"' with: "+C[S]);case 6:return N.abrupt("return",C);case 7:case"end":return N.stop()}},A,this)}));function m(A){return v.apply(this,arguments)}return m}()},{key:"unsubscribe",value:function(){var v=(0,r.default)(t.default.mark(function A(S){var C;return t.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return typeof S=="string"&&(S=[S]),N.next=3,this.call("rpc.off",S);case 3:if(C=N.sent,!(typeof S=="string"&&C[S]!=="ok")){N.next=6;break}throw new Error("Failed unsubscribing from an event with: "+C);case 6:return N.abrupt("return",C);case 7:case"end":return N.stop()}},A,this)}));function m(A){return v.apply(this,arguments)}return m}()},{key:"close",value:function(m,A){this.socket.close(m||1e3,A)}},{key:"_connect",value:function(m,A){var S=this;clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(m,A),this.socket.addEventListener("open",function(){S.ready=!0,S.emit("open"),S.current_reconnects=0}),this.socket.addEventListener("message",function(C){var B=C.data;B instanceof ArrayBuffer&&(B=U.from(B).toString());try{B=JSON.parse(B)}catch{return}if(B.notification&&S.listeners(B.notification).length){if(!Object.keys(B.params).length)return S.emit(B.notification);var N=[B.notification];if(B.params.constructor===Object)N.push(B.params);else for(var V=0;V<B.params.length;V++)N.push(B.params[V]);return Promise.resolve().then(function(){S.emit.apply(S,N)})}if(!S.queue[B.id])return B.method&&B.params?Promise.resolve().then(function(){S.emit(B.method,B.params)}):void 0;"error"in B=="result"in B&&S.queue[B.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),S.queue[B.id].timeout&&clearTimeout(S.queue[B.id].timeout),B.error?S.queue[B.id].promise[1](B.error):S.queue[B.id].promise[0](B.result),delete S.queue[B.id]}),this.socket.addEventListener("error",function(C){return S.emit("error",C)}),this.socket.addEventListener("close",function(C){var B=C.code,N=C.reason;S.ready&&setTimeout(function(){return S.emit("close",B,N)},0),S.ready=!1,S.socket=void 0,B!==1e3&&(S.current_reconnects++,S.reconnect&&(S.max_reconnects>S.current_reconnects||S.max_reconnects===0)&&(S.reconnect_timer_id=setTimeout(function(){return S._connect(m,A)},S.reconnect_interval)))})}}]),E}(u.EventEmitter);n.default=p})(gi);const ac=_r(gi);var Ei={};(function(n){var e=yi;Object.defineProperty(n,"__esModule",{value:!0}),n.default=h;var t=e(wi),r=e(bi),s=e(vi),i=e(Si),o=e(ki),a=xs;function c(f){var d=l();return function(){var g=(0,o.default)(f),y;if(d){var E=(0,o.default)(this).constructor;y=Reflect.construct(g,arguments,E)}else y=g.apply(this,arguments);return(0,i.default)(this,y)}}function l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var u=function(f){(0,s.default)(p,f);var d=c(p);function p(g,y,E){var v;return(0,t.default)(this,p),v=d.call(this),v.socket=new window.WebSocket(g,E),v.socket.onopen=function(){return v.emit("open")},v.socket.onmessage=function(m){return v.emit("message",m.data)},v.socket.onerror=function(m){return v.emit("error",m)},v.socket.onclose=function(m){v.emit("close",m.code,m.reason)},v}return(0,r.default)(p,[{key:"send",value:function(y,E,v){var m=v||E;try{this.socket.send(y),m()}catch(A){m(A)}}},{key:"close",value:function(y,E){this.socket.close(y,E)}},{key:"addEventListener",value:function(y,E,v){this.socket.addEventListener(y,E,v)}}]),p}(a.EventEmitter);function h(f,d){return new u(f,d)}})(Ei);const cc=_r(Ei);de.utils.randomPrivateKey;const is=()=>{const n=de.utils.randomPrivateKey(),e=tn(n),t=new Uint8Array(64);return t.set(n),t.set(e,32),{publicKey:e,secretKey:t}},tn=de.getPublicKey;function os(n){try{return de.ExtendedPoint.fromHex(n),!0}catch{return!1}}const uc=(n,e)=>de.sign(n,e.slice(0,32)),lc=de.verify,Mt=n=>U.isBuffer(n)?n:n instanceof Uint8Array?U.from(n.buffer,n.byteOffset,n.byteLength):U.from(n);class dc{constructor(e){Object.assign(this,e)}encode(){return U.from(zs(hr,this))}static decode(e){return js(hr,this,e)}static decodeUnchecked(e){return Fs(hr,this,e)}}const hr=new Map;let _i;const fc=32,Ye=32;function hc(n){return n._bn!==void 0}let as=1;_i=Symbol.toStringTag;class $ extends dc{constructor(e){if(super({}),this._bn=void 0,hc(e))this._bn=e._bn;else{if(typeof e=="string"){const t=ne.decode(e);if(t.length!=Ye)throw new Error("Invalid public key input");this._bn=new Gn(t)}else this._bn=new Gn(e);if(this._bn.byteLength()>Ye)throw new Error("Invalid public key input")}}static unique(){const e=new $(as);return as+=1,new $(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return ne.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(U);if(e.length===Ye)return e;const t=U.alloc(32);return e.copy(t,32-e.length),t}get[_i](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,r){const s=U.concat([e.toBuffer(),U.from(t),r.toBuffer()]),i=Vn(s);return new $(i)}static createProgramAddressSync(e,t){let r=U.alloc(0);e.forEach(function(i){if(i.length>fc)throw new TypeError("Max seed length exceeded");r=U.concat([r,Mt(i)])}),r=U.concat([r,t.toBuffer(),U.from("ProgramDerivedAddress")]);const s=Vn(r);if(os(s))throw new Error("Invalid seeds, address must fall off the curve");return new $(s)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let r=255,s;for(;r!=0;){try{const i=e.concat(U.from([r]));s=this.createProgramAddressSync(i,t)}catch(i){if(i instanceof TypeError)throw i;r--;continue}return[s,r]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new $(e);return os(t.toBytes())}}$.default=new $("11111111111111111111111111111111");hr.set($,{kind:"struct",fields:[["_bn","u256"]]});new $("BPFLoader1111111111111111111111111111111111");const Nt=1280-40-8,Ai=127,rn=64;class Ri extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Ri.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class Ii extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Ii.prototype,"name",{value:"TransactionExpiredTimeoutError"});class Wt extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Wt.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class Sr{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const r=new Map;this.keySegments().flat().forEach((i,o)=>{r.set(i.toBase58(),o)});const s=i=>{const o=r.get(i.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(i=>({programIdIndex:s(i.programId),accountKeyIndexes:i.keys.map(o=>s(o.pubkey)),data:i.data}))}}const G=(n="publicKey")=>le(32,n),Ot=(n="string")=>{const e=M([K("length"),K("lengthPadding"),le(_t(K(),-8),"chars")],n),t=e.decode.bind(e),r=e.encode.bind(e),s=e;return s.decode=(i,o)=>t(i,o).chars.toString(),s.encode=(i,o,a)=>{const c={chars:U.from(i,"utf8")};return r(c,o,a)},s.alloc=i=>K().span+K().span+U.from(i,"utf8").length,s},pc=(n="authorized")=>M([G("staker"),G("withdrawer")],n),gc=(n="lockup")=>M([Le("unixTimestamp"),Le("epoch"),G("custodian")],n),mc=(n="voteInit")=>M([G("nodePubkey"),G("authorizedVoter"),G("authorizedWithdrawer"),Y("commission")],n),yc=(n="voteAuthorizeWithSeedArgs")=>M([K("voteAuthorizationType"),G("currentAuthorityDerivedKeyOwnerPubkey"),Ot("currentAuthorityDerivedKeySeed"),G("newAuthorized")],n);function Ke(n){let e=0,t=0;for(;;){let r=n.shift();if(e|=(r&127)<<t*7,t+=1,!(r&128))break}return e}function $e(n,e){let t=e;for(;;){let r=t&127;if(t>>=7,t==0){n.push(r);break}else r|=128,n.push(r)}}function he(n,e){if(!n)throw new Error(e||"Assertion failed")}class Nr{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const r=new Map,s=o=>{const a=o.toBase58();let c=r.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},r.set(a,c)),c},i=s(t);i.isSigner=!0,i.isWritable=!0;for(const o of e){s(o.programId).isInvoked=!0;for(const a of o.keys){const c=s(a.pubkey);c.isSigner||(c.isSigner=a.isSigner),c.isWritable||(c.isWritable=a.isWritable)}}return new Nr(t,r)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];he(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),r=e.filter(([,c])=>c.isSigner&&!c.isWritable),s=e.filter(([,c])=>!c.isSigner&&c.isWritable),i=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:i.length};{he(t.length>0,"Expected at least one writable signer key");const[c]=t[0];he(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new $(c)),...r.map(([c])=>new $(c)),...s.map(([c])=>new $(c)),...i.map(([c])=>new $(c))];return[o,a]}extractTableLookup(e){const[t,r]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[s,i]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&s.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:s},{writable:r,readonly:i}]}drainKeysFoundInLookupTable(e,t){const r=new Array,s=new Array;for(const[i,o]of this.keyMetaMap.entries())if(t(o)){const a=new $(i),c=e.findIndex(l=>l.equals(a));c>=0&&(he(c<256,"Max lookup table index exceeded"),r.push(c),s.push(a),this.keyMetaMap.delete(i))}return[r,s]}}class yt{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new $(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:ne.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new Sr(this.staticAccountKeys)}static compile(e){const t=Nr.compile(e.instructions,e.payerKey),[r,s]=t.getMessageComponents(),o=new Sr(s).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:ne.encode(a.data)}));return new yt({header:r,accountKeys:s,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const r=e-t,i=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return r<i}else{const r=t-this.header.numReadonlySignedAccounts;return e<r}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];$e(t,e);const r=this.instructions.map(h=>{const{accounts:f,programIdIndex:d}=h,p=Array.from(ne.decode(h.data));let g=[];$e(g,f.length);let y=[];return $e(y,p.length),{programIdIndex:d,keyIndicesCount:U.from(g),keyIndices:f,dataLength:U.from(y),data:p}});let s=[];$e(s,r.length);let i=U.alloc(Nt);U.from(s).copy(i);let o=s.length;r.forEach(h=>{const d=M([Y("programIdIndex"),le(h.keyIndicesCount.length,"keyIndicesCount"),Ie(Y("keyIndex"),h.keyIndices.length,"keyIndices"),le(h.dataLength.length,"dataLength"),Ie(Y("userdatum"),h.data.length,"data")]).encode(h,i,o);o+=d}),i=i.slice(0,o);const a=M([le(1,"numRequiredSignatures"),le(1,"numReadonlySignedAccounts"),le(1,"numReadonlyUnsignedAccounts"),le(t.length,"keyCount"),Ie(G("key"),e,"keys"),G("recentBlockhash")]),c={numRequiredSignatures:U.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:U.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:U.from([this.header.numReadonlyUnsignedAccounts]),keyCount:U.from(t),keys:this.accountKeys.map(h=>Mt(h.toBytes())),recentBlockhash:ne.decode(this.recentBlockhash)};let l=U.alloc(2048);const u=a.encode(c,l);return i.copy(l,u),l.slice(0,u+i.length)}static from(e){let t=[...e];const r=t.shift();if(r!==(r&Ai))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const s=t.shift(),i=t.shift(),o=Ke(t);let a=[];for(let f=0;f<o;f++){const d=t.slice(0,Ye);t=t.slice(Ye),a.push(new $(U.from(d)))}const c=t.slice(0,Ye);t=t.slice(Ye);const l=Ke(t);let u=[];for(let f=0;f<l;f++){const d=t.shift(),p=Ke(t),g=t.slice(0,p);t=t.slice(p);const y=Ke(t),E=t.slice(0,y),v=ne.encode(U.from(E));t=t.slice(y),u.push({programIdIndex:d,accounts:g,data:v})}const h={header:{numRequiredSignatures:r,numReadonlySignedAccounts:s,numReadonlyUnsignedAccounts:i},recentBlockhash:ne.encode(U.from(c)),accountKeys:a,instructions:u};return new yt(h)}}class kr{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new Sr(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;if(e>=r){const s=e-r,i=this.addressTableLookups.reduce((o,a)=>o+a.writableIndexes.length,0);return s<i}else if(e>=this.header.numRequiredSignatures){const s=e-t,o=r-t-this.header.numReadonlyUnsignedAccounts;return s<o}else{const s=t-this.header.numReadonlySignedAccounts;return e<s}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const r of this.addressTableLookups){const s=e.find(i=>i.key.equals(r.accountKey));if(!s)throw new Error(`Failed to find address lookup table account for table key ${r.accountKey.toBase58()}`);for(const i of r.writableIndexes)if(i<s.state.addresses.length)t.writable.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`);for(const i of r.readonlyIndexes)if(i<s.state.addresses.length)t.readonly.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`)}return t}static compile(e){const t=Nr.compile(e.instructions,e.payerKey),r=new Array,s={writable:new Array,readonly:new Array},i=e.addressLookupTableAccounts||[];for(const u of i){const h=t.extractTableLookup(u);if(h!==void 0){const[f,{writable:d,readonly:p}]=h;r.push(f),s.writable.push(...d),s.readonly.push(...p)}}const[o,a]=t.getMessageComponents(),l=new Sr(a,s).compileInstructions(e.instructions);return new kr({header:o,staticAccountKeys:a,recentBlockhash:e.recentBlockhash,compiledInstructions:l,addressTableLookups:r})}serialize(){const e=Array();$e(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),r=Array();$e(r,this.compiledInstructions.length);const s=this.serializeAddressTableLookups(),i=Array();$e(i,this.addressTableLookups.length);const o=M([Y("prefix"),M([Y("numRequiredSignatures"),Y("numReadonlySignedAccounts"),Y("numReadonlyUnsignedAccounts")],"header"),le(e.length,"staticAccountKeysLength"),Ie(G(),this.staticAccountKeys.length,"staticAccountKeys"),G("recentBlockhash"),le(r.length,"instructionsLength"),le(t.length,"serializedInstructions"),le(i.length,"addressTableLookupsLength"),le(s.length,"serializedAddressTableLookups")]),a=new Uint8Array(Nt),c=128,l=o.encode({prefix:c,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(u=>u.toBytes()),recentBlockhash:ne.decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:s},a);return a.slice(0,l)}serializeInstructions(){let e=0;const t=new Uint8Array(Nt);for(const r of this.compiledInstructions){const s=Array();$e(s,r.accountKeyIndexes.length);const i=Array();$e(i,r.data.length);const o=M([Y("programIdIndex"),le(s.length,"encodedAccountKeyIndexesLength"),Ie(Y(),r.accountKeyIndexes.length,"accountKeyIndexes"),le(i.length,"encodedDataLength"),le(r.data.length,"data")]);e+=o.encode({programIdIndex:r.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(s),accountKeyIndexes:r.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:r.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(Nt);for(const r of this.addressTableLookups){const s=Array();$e(s,r.writableIndexes.length);const i=Array();$e(i,r.readonlyIndexes.length);const o=M([G("accountKey"),le(s.length,"encodedWritableIndexesLength"),Ie(Y(),r.writableIndexes.length,"writableIndexes"),le(i.length,"encodedReadonlyIndexesLength"),Ie(Y(),r.readonlyIndexes.length,"readonlyIndexes")]);e+=o.encode({accountKey:r.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(s),writableIndexes:r.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:r.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const r=t.shift(),s=r&Ai;he(r!==s,"Expected versioned message but received legacy message");const i=s;he(i===0,`Expected versioned message with version 0 but found version ${i}`);const o={numRequiredSignatures:t.shift(),numReadonlySignedAccounts:t.shift(),numReadonlyUnsignedAccounts:t.shift()},a=[],c=Ke(t);for(let p=0;p<c;p++)a.push(new $(t.splice(0,Ye)));const l=ne.encode(t.splice(0,Ye)),u=Ke(t),h=[];for(let p=0;p<u;p++){const g=t.shift(),y=Ke(t),E=t.splice(0,y),v=Ke(t),m=new Uint8Array(t.splice(0,v));h.push({programIdIndex:g,accountKeyIndexes:E,data:m})}const f=Ke(t),d=[];for(let p=0;p<f;p++){const g=new $(t.splice(0,Ye)),y=Ke(t),E=t.splice(0,y),v=Ke(t),m=t.splice(0,v);d.push({accountKey:g,writableIndexes:E,readonlyIndexes:m})}return new kr({header:o,staticAccountKeys:a,recentBlockhash:l,compiledInstructions:h,addressTableLookups:d})}}let Ze;(function(n){n[n.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",n[n.PROCESSED=1]="PROCESSED",n[n.TIMED_OUT=2]="TIMED_OUT",n[n.NONCE_INVALID=3]="NONCE_INVALID"})(Ze||(Ze={}));const wc=U.alloc(rn).fill(0);class cs{constructor(e){this.keys=void 0,this.programId=void 0,this.data=U.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:r})=>({pubkey:e.toJSON(),isSigner:t,isWritable:r})),programId:this.programId.toJSON(),data:[...this.data]}}}class dt{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:r}=e;this.minNonceContextSlot=t,this.nonceInfo=r}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:r}=e;this.recentBlockhash=t,this.lastValidBlockHeight=r}else{const{recentBlockhash:t,nonceInfo:r}=e;r&&(this.nonceInfo=r),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new cs(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let r;if(this.feePayer)r=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)r=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let g=0;g<t.length;g++)if(t[g].programId===void 0)throw new Error(`Transaction instruction index ${g} has undefined program id`);const s=[],i=[];t.forEach(g=>{g.keys.forEach(E=>{i.push({...E})});const y=g.programId.toString();s.includes(y)||s.push(y)}),s.forEach(g=>{i.push({pubkey:new $(g),isSigner:!1,isWritable:!1})});const o=[];i.forEach(g=>{const y=g.pubkey.toString(),E=o.findIndex(v=>v.pubkey.toString()===y);E>-1?(o[E].isWritable=o[E].isWritable||g.isWritable,o[E].isSigner=o[E].isSigner||g.isSigner):o.push(g)}),o.sort(function(g,y){return g.isSigner!==y.isSigner?g.isSigner?-1:1:g.isWritable!==y.isWritable?g.isWritable?-1:1:g.pubkey.toBase58().localeCompare(y.pubkey.toBase58())});const a=o.findIndex(g=>g.pubkey.equals(r));if(a>-1){const[g]=o.splice(a,1);g.isSigner=!0,g.isWritable=!0,o.unshift(g)}else o.unshift({pubkey:r,isSigner:!0,isWritable:!0});for(const g of this.signatures){const y=o.findIndex(E=>E.pubkey.equals(g.publicKey));if(y>-1)o[y].isSigner||(o[y].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${g.publicKey.toString()}`)}let c=0,l=0,u=0;const h=[],f=[];o.forEach(({pubkey:g,isSigner:y,isWritable:E})=>{y?(h.push(g.toString()),c+=1,E||(l+=1)):(f.push(g.toString()),E||(u+=1))});const d=h.concat(f),p=t.map(g=>{const{data:y,programId:E}=g;return{programIdIndex:d.indexOf(E.toString()),accounts:g.keys.map(v=>d.indexOf(v.pubkey.toString())),data:ne.encode(y)}});return p.forEach(g=>{he(g.programIdIndex>=0),g.accounts.forEach(y=>he(y>=0))}),new yt({header:{numRequiredSignatures:c,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:u},accountKeys:d,recentBlockhash:e,instructions:p})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((s,i)=>t[i].equals(s.publicKey))||(this.signatures=t.map(r=>({signature:null,publicKey:r}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(r=>{const s=r.toString();return t.has(s)?!1:(t.add(s),!0)}).map(r=>({signature:null,publicKey:r}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const i of e){const o=i.publicKey.toString();t.has(o)||(t.add(o),r.push(i))}this.signatures=r.map(i=>({signature:null,publicKey:i.publicKey}));const s=this._compile();this._partialSign(s,...r)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const i of e){const o=i.publicKey.toString();t.has(o)||(t.add(o),r.push(i))}const s=this._compile();this._partialSign(s,...r)}_partialSign(e,...t){const r=e.serialize();t.forEach(s=>{const i=uc(r,s.secretKey);this._addSignature(s.publicKey,Mt(i))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){he(t.length===64);const r=this.signatures.findIndex(s=>e.equals(s.publicKey));if(r<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[r].signature=U.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:r,publicKey:s}of this.signatures)if(r===null){if(t)return!1}else if(!lc(r,e,s.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:r}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),s=this.serializeMessage();if(r&&!this._verifySignatures(s,t))throw new Error("Signature verification failed");return this._serialize(s)}_serialize(e){const{signatures:t}=this,r=[];$e(r,t.length);const s=r.length+t.length*64+e.length,i=U.alloc(s);return he(t.length<256),U.from(r).copy(i,0),t.forEach(({signature:o},a)=>{o!==null&&(he(o.length===64,"signature has invalid length"),U.from(o).copy(i,r.length+a*64))}),e.copy(i,r.length+t.length*64),he(i.length<=Nt,`Transaction too large: ${i.length} > ${Nt}`),i}get keys(){return he(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return he(this.instructions.length===1),this.instructions[0].programId}get data(){return he(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const r=Ke(t);let s=[];for(let i=0;i<r;i++){const o=t.slice(0,rn);t=t.slice(rn),s.push(ne.encode(U.from(o)))}return dt.populate(yt.from(t),s)}static populate(e,t=[]){const r=new dt;return r.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(r.feePayer=e.accountKeys[0]),t.forEach((s,i)=>{const o={signature:s==ne.encode(wc)?null:ne.decode(s),publicKey:e.accountKeys[i]};r.signatures.push(o)}),e.instructions.forEach(s=>{const i=s.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:r.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});r.instructions.push(new cs({keys:i,programId:e.accountKeys[s.programIdIndex],data:ne.decode(s.data)}))}),r._message=e,r._json=r.toJSON(),r}}new $("SysvarC1ock11111111111111111111111111111111");new $("SysvarEpochSchedu1e111111111111111111111111");new $("Sysvar1nstructions1111111111111111111111111");new $("SysvarRecentB1ockHashes11111111111111111111");new $("SysvarRent111111111111111111111111111111111");new $("SysvarRewards111111111111111111111111111111");new $("SysvarS1otHashes111111111111111111111111111");new $("SysvarS1otHistory11111111111111111111111111");new $("SysvarStakeHistory1111111111111111111111111");function Tt(n){return new Promise(e=>setTimeout(e,n))}const bc=we("lamportsPerSignature"),xi=M([K("version"),K("state"),G("authorizedPubkey"),G("nonce"),M([bc],"feeCalculator")]);xi.span;class Cn{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=xi.decode(Mt(e),0);return new Cn({authorizedPubkey:new $(t.authorizedPubkey),nonce:new $(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const vc=n=>{const e=n.decode.bind(n),t=n.encode.bind(n);return{decode:e,encode:t}},Sc=n=>e=>{const t=le(n,e),{encode:r,decode:s}=vc(t),i=t;return i.decode=(o,a)=>{const c=s(o,a);return wa(U.from(c))},i.encode=(o,a,c)=>{const l=Sa(o,n);return r(l,a,c)},i},Ft=Sc(8);Object.freeze({Create:{index:0,layout:M([K("instruction"),Le("lamports"),Le("space"),G("programId")])},Assign:{index:1,layout:M([K("instruction"),G("programId")])},Transfer:{index:2,layout:M([K("instruction"),Ft("lamports")])},CreateWithSeed:{index:3,layout:M([K("instruction"),G("base"),Ot("seed"),Le("lamports"),Le("space"),G("programId")])},AdvanceNonceAccount:{index:4,layout:M([K("instruction")])},WithdrawNonceAccount:{index:5,layout:M([K("instruction"),Le("lamports")])},InitializeNonceAccount:{index:6,layout:M([K("instruction"),G("authorized")])},AuthorizeNonceAccount:{index:7,layout:M([K("instruction"),G("authorized")])},Allocate:{index:8,layout:M([K("instruction"),Le("space")])},AllocateWithSeed:{index:9,layout:M([K("instruction"),G("base"),Ot("seed"),Le("space"),G("programId")])},AssignWithSeed:{index:10,layout:M([K("instruction"),G("base"),Ot("seed"),G("programId")])},TransferWithSeed:{index:11,layout:M([K("instruction"),Ft("lamports"),Ot("seed"),G("programId")])},UpgradeNonceAccount:{index:12,layout:M([K("instruction")])}});new $("11111111111111111111111111111111");new $("BPFLoader2111111111111111111111111111111111");var kc=Object.prototype.toString,Ec=Object.keys||function(n){var e=[];for(var t in n)e.push(t);return e};function Gt(n,e){var t,r,s,i,o,a,c;if(n===!0)return"true";if(n===!1)return"false";switch(typeof n){case"object":if(n===null)return null;if(n.toJSON&&typeof n.toJSON=="function")return Gt(n.toJSON(),e);if(c=kc.call(n),c==="[object Array]"){for(s="[",r=n.length-1,t=0;t<r;t++)s+=Gt(n[t],!0)+",";return r>-1&&(s+=Gt(n[t],!0)),s+"]"}else if(c==="[object Object]"){for(i=Ec(n).sort(),r=i.length,s="",t=0;t<r;)o=i[t],a=Gt(n[o],!1),a!==void 0&&(s&&(s+=","),s+=JSON.stringify(o)+":"+a),t++;return"{"+s+"}"}else return JSON.stringify(n);case"function":case"undefined":return e?null:void 0;case"string":return JSON.stringify(n);default:return isFinite(n)?n:null}}var _c=function(n){var e=Gt(n,!1);if(e!==void 0)return""+e},us=_c;const Ht=32;function Zr(n){let e=0;for(;n>1;)n/=2,e++;return e}function Ac(n){return n===0?1:(n--,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>16,n|=n>>32,n+1)}class Rc{constructor(e,t,r,s,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=r,this.firstNormalEpoch=s,this.firstNormalSlot=i}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=Zr(Ac(e+Ht+1))-Zr(Ht)-1,r=this.getSlotsInEpoch(t),s=e-(r-Ht);return[t,s]}else{const t=e-this.firstNormalSlot,r=Math.floor(t/this.slotsPerEpoch),s=this.firstNormalEpoch+r,i=t%this.slotsPerEpoch;return[s,i]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*Ht:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+Zr(Ht)):this.slotsPerEpoch}}class ls extends Error{constructor(e,t){super(e),this.logs=void 0,this.logs=t}}class F extends Error{constructor({code:e,message:t,data:r},s){super(s!=null?`${s}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=r,this.name="SolanaJSONRPCError"}}var Ic=globalThis.fetch;class xc extends ac{constructor(e,t,r){const s=i=>{const o=cc(i,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(s,e,t,r),this.underlyingSocket=void 0}call(...e){const t=this.underlyingSocket?.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){const t=this.underlyingSocket?.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}const Bc=160,Cc=64,Pc=Bc/Cc,Tc=1e3/Pc;function Oc(n,e){let t;try{t=n.layout.decode(e)}catch(r){throw new Error("invalid instruction; "+r)}if(t.typeIndex!==n.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${n.index}`);return t}const ds=56;class fs{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=Oc(Lc,e),r=e.length-ds;he(r>=0,"lookup table is invalid"),he(r%32===0,"lookup table is invalid");const s=r/32,{addresses:i}=M([Ie(G(),s,"addresses")]).decode(e.slice(ds));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new $(t.authority[0]):void 0,addresses:i.map(o=>new $(o))}}}const Lc={index:1,layout:M([K("typeIndex"),Ft("deactivationSlot"),we("lastExtendedSlot"),Y("lastExtendedStartIndex"),Y(),Ie(G(),_t(Y(),-1),"authority")])},Nc=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function Uc(n){const e=n.match(Nc);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${n}\``);const[t,r,s,i]=e,o=n.startsWith("https:")?"wss:":"ws:",a=s==null?null:parseInt(s.slice(1),10),c=a==null?"":`:${a+1}`;return`${o}//${r}${c}${i}`}const ge=nr(xn($),R(),n=>new $(n)),Bi=Bn([R(),ue("base64")]),Pn=nr(xn(U),Bi,n=>U.from(n[0],"base64")),Mc=30*1e3;function Fc(n){if(/^https?:/.test(n)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return n}function ce(n){let e,t;if(typeof n=="string")e=n;else if(n){const{commitment:r,...s}=n;e=r,t=s}return{commitment:e,config:t}}function Ci(n){return Pe([_({jsonrpc:ue("2.0"),id:R(),result:n}),_({jsonrpc:ue("2.0"),id:R(),error:_({code:rr(),message:R(),data:D(Ba())})})])}const qc=Ci(rr());function W(n){return nr(Ci(n),qc,e=>"error"in e?e:{...e,result:x(e.result,n)})}function pe(n){return W(_({context:_({slot:w()}),value:n}))}function Ur(n){return _({context:_({slot:w()}),value:n})}function Xr(n,e){return n===0?new kr({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new $(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:ne.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new yt(e)}const Kc=_({foundation:w(),foundationTerm:w(),initial:w(),taper:w(),terminal:w()}),$c=W(P(T(_({epoch:w(),effectiveSlot:w(),amount:w(),postBalance:w(),commission:D(T(w()))})))),Dc=P(_({slot:w(),prioritizationFee:w()})),zc=_({total:w(),validator:w(),foundation:w(),epoch:w()}),jc=_({epoch:w(),slotIndex:w(),slotsInEpoch:w(),absoluteSlot:w(),blockHeight:D(w()),transactionCount:D(w())}),Hc=_({slotsPerEpoch:w(),leaderScheduleSlotOffset:w(),warmup:it(),firstNormalEpoch:w(),firstNormalSlot:w()}),Wc=ui(R(),P(w())),Bt=T(Pe([_({}),R()])),Gc=_({err:Bt}),Vc=ue("receivedSignature"),Jc=_({"solana-core":R(),"feature-set":D(w())}),hs=pe(_({err:T(Pe([_({}),R()])),logs:T(P(R())),accounts:D(T(P(T(_({executable:it(),owner:R(),lamports:w(),data:P(R()),rentEpoch:D(w())}))))),unitsConsumed:D(w()),returnData:D(T(_({programId:R(),data:Bn([R(),ue("base64")])})))})),Zc=pe(_({byIdentity:ui(R(),P(w())),range:_({firstSlot:w(),lastSlot:w()})}));function Xc(n,e,t,r,s,i){const o=t||Ic;let a;i!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let c;return r&&(c=async(u,h)=>{const f=await new Promise((d,p)=>{try{r(u,h,(g,y)=>d([g,y]))}catch(g){p(g)}});return await o(...f)}),new sc(async(u,h)=>{const f={method:"POST",body:u,agent:a,headers:Object.assign({"Content-Type":"application/json"},e||{},Xu)};try{let d=5,p,g=500;for(;c?p=await c(n,f):p=await o(n,f),!(p.status!==429||s===!0||(d-=1,d===0));)console.log(`Server responded with ${p.status} ${p.statusText}.  Retrying after ${g}ms delay...`),await Tt(g),g*=2;const y=await p.text();p.ok?h(null,y):h(new Error(`${p.status} ${p.statusText}: ${y}`))}catch(d){d instanceof Error&&h(d)}},{})}function Yc(n){return(e,t)=>new Promise((r,s)=>{n.request(e,t,(i,o)=>{if(i){s(i);return}r(o)})})}function Qc(n){return e=>new Promise((t,r)=>{e.length===0&&t([]);const s=e.map(i=>n.request(i.methodName,i.args));n.request(s,(i,o)=>{if(i){r(i);return}t(o)})})}const eu=W(Kc),tu=W(zc),ru=W(Dc),nu=W(jc),su=W(Hc),iu=W(Wc),ou=W(w()),au=pe(_({total:w(),circulating:w(),nonCirculating:w(),nonCirculatingAccounts:P(ge)})),nn=_({amount:R(),uiAmount:T(w()),decimals:w(),uiAmountString:D(R())}),cu=pe(P(_({address:ge,amount:R(),uiAmount:T(w()),decimals:w(),uiAmountString:D(R())}))),uu=pe(P(_({pubkey:ge,account:_({executable:it(),owner:ge,lamports:w(),data:Pn,rentEpoch:w()})}))),sn=_({program:R(),parsed:rr(),space:w()}),lu=pe(P(_({pubkey:ge,account:_({executable:it(),owner:ge,lamports:w(),data:sn,rentEpoch:w()})}))),du=pe(P(_({lamports:w(),address:ge}))),Yt=_({executable:it(),owner:ge,lamports:w(),data:Pn,rentEpoch:w()}),fu=_({pubkey:ge,account:Yt}),hu=nr(Pe([xn(U),sn]),Pe([Bi,sn]),n=>Array.isArray(n)?x(n,Pn):n),on=_({executable:it(),owner:ge,lamports:w(),data:hu,rentEpoch:w()}),pu=_({pubkey:ge,account:on}),gu=_({state:Pe([ue("active"),ue("inactive"),ue("activating"),ue("deactivating")]),active:w(),inactive:w()}),mu=W(P(_({signature:R(),slot:w(),err:Bt,memo:T(R()),blockTime:D(T(w()))}))),yu=W(P(_({signature:R(),slot:w(),err:Bt,memo:T(R()),blockTime:D(T(w()))}))),wu=_({subscription:w(),result:Ur(Yt)}),bu=_({pubkey:ge,account:Yt}),vu=_({subscription:w(),result:Ur(bu)}),Su=_({parent:w(),slot:w(),root:w()}),ku=_({subscription:w(),result:Su}),Eu=Pe([_({type:Pe([ue("firstShredReceived"),ue("completed"),ue("optimisticConfirmation"),ue("root")]),slot:w(),timestamp:w()}),_({type:ue("createdBank"),parent:w(),slot:w(),timestamp:w()}),_({type:ue("frozen"),slot:w(),timestamp:w(),stats:_({numTransactionEntries:w(),numSuccessfulTransactions:w(),numFailedTransactions:w(),maxTransactionsPerEntry:w()})}),_({type:ue("dead"),slot:w(),timestamp:w(),err:R()})]),_u=_({subscription:w(),result:Eu}),Au=_({subscription:w(),result:Ur(Pe([Gc,Vc]))}),Ru=_({subscription:w(),result:w()}),Iu=_({pubkey:R(),gossip:T(R()),tpu:T(R()),rpc:T(R()),version:T(R())}),ps=_({votePubkey:R(),nodePubkey:R(),activatedStake:w(),epochVoteAccount:it(),epochCredits:P(Bn([w(),w(),w()])),commission:w(),lastVote:w(),rootSlot:T(w())}),xu=W(_({current:P(ps),delinquent:P(ps)})),Bu=Pe([ue("processed"),ue("confirmed"),ue("finalized")]),Cu=_({slot:w(),confirmations:T(w()),err:Bt,confirmationStatus:D(Bu)}),Pu=pe(P(T(Cu))),Tu=W(w()),Pi=_({accountKey:ge,writableIndexes:P(w()),readonlyIndexes:P(w())}),Tn=_({signatures:P(R()),message:_({accountKeys:P(R()),header:_({numRequiredSignatures:w(),numReadonlySignedAccounts:w(),numReadonlyUnsignedAccounts:w()}),instructions:P(_({accounts:P(w()),data:R(),programIdIndex:w()})),recentBlockhash:R(),addressTableLookups:D(P(Pi))})}),Ti=_({pubkey:ge,signer:it(),writable:it(),source:D(Pe([ue("transaction"),ue("lookupTable")]))}),Oi=_({accountKeys:P(Ti),signatures:P(R())}),Li=_({parsed:rr(),program:R(),programId:ge}),Ni=_({accounts:P(ge),data:R(),programId:ge}),Ou=Pe([Ni,Li]),Lu=Pe([_({parsed:rr(),program:R(),programId:R()}),_({accounts:P(R()),data:R(),programId:R()})]),Ui=nr(Ou,Lu,n=>"accounts"in n?x(n,Ni):x(n,Li)),Mi=_({signatures:P(R()),message:_({accountKeys:P(Ti),instructions:P(Ui),recentBlockhash:R(),addressTableLookups:D(T(P(Pi)))})}),Er=_({accountIndex:w(),mint:R(),owner:D(R()),uiTokenAmount:nn}),Fi=_({writable:P(ge),readonly:P(ge)}),Mr=_({err:Bt,fee:w(),innerInstructions:D(T(P(_({index:w(),instructions:P(_({accounts:P(w()),data:R(),programIdIndex:w()}))})))),preBalances:P(w()),postBalances:P(w()),logMessages:D(T(P(R()))),preTokenBalances:D(T(P(Er))),postTokenBalances:D(T(P(Er))),loadedAddresses:D(Fi),computeUnitsConsumed:D(w())}),On=_({err:Bt,fee:w(),innerInstructions:D(T(P(_({index:w(),instructions:P(Ui)})))),preBalances:P(w()),postBalances:P(w()),logMessages:D(T(P(R()))),preTokenBalances:D(T(P(Er))),postTokenBalances:D(T(P(Er))),loadedAddresses:D(Fi),computeUnitsConsumed:D(w())}),Dt=Pe([ue(0),ue("legacy")]),Ct=_({pubkey:R(),lamports:w(),postBalance:T(w()),rewardType:T(R()),commission:D(T(w()))}),Nu=W(T(_({blockhash:R(),previousBlockhash:R(),parentSlot:w(),transactions:P(_({transaction:Tn,meta:T(Mr),version:D(Dt)})),rewards:D(P(Ct)),blockTime:T(w()),blockHeight:T(w())}))),Uu=W(T(_({blockhash:R(),previousBlockhash:R(),parentSlot:w(),rewards:D(P(Ct)),blockTime:T(w()),blockHeight:T(w())}))),Mu=W(T(_({blockhash:R(),previousBlockhash:R(),parentSlot:w(),transactions:P(_({transaction:Oi,meta:T(Mr),version:D(Dt)})),rewards:D(P(Ct)),blockTime:T(w()),blockHeight:T(w())}))),Fu=W(T(_({blockhash:R(),previousBlockhash:R(),parentSlot:w(),transactions:P(_({transaction:Mi,meta:T(On),version:D(Dt)})),rewards:D(P(Ct)),blockTime:T(w()),blockHeight:T(w())}))),qu=W(T(_({blockhash:R(),previousBlockhash:R(),parentSlot:w(),transactions:P(_({transaction:Oi,meta:T(On),version:D(Dt)})),rewards:D(P(Ct)),blockTime:T(w()),blockHeight:T(w())}))),Ku=W(T(_({blockhash:R(),previousBlockhash:R(),parentSlot:w(),rewards:D(P(Ct)),blockTime:T(w()),blockHeight:T(w())}))),$u=W(T(_({blockhash:R(),previousBlockhash:R(),parentSlot:w(),transactions:P(_({transaction:Tn,meta:T(Mr)})),rewards:D(P(Ct)),blockTime:T(w())}))),gs=W(T(_({blockhash:R(),previousBlockhash:R(),parentSlot:w(),signatures:P(R()),blockTime:T(w())}))),Yr=W(T(_({slot:w(),meta:Mr,blockTime:D(T(w())),transaction:Tn,version:D(Dt)}))),dr=W(T(_({slot:w(),transaction:Mi,meta:T(On),blockTime:D(T(w())),version:D(Dt)}))),Du=pe(_({blockhash:R(),feeCalculator:_({lamportsPerSignature:w()})})),zu=pe(_({blockhash:R(),lastValidBlockHeight:w()})),ju=_({slot:w(),numTransactions:w(),numSlots:w(),samplePeriodSecs:w()}),Hu=W(P(ju)),Wu=pe(T(_({feeCalculator:_({lamportsPerSignature:w()})}))),Gu=W(R()),Vu=W(R()),Ju=_({err:Bt,logs:P(R()),signature:R()}),Zu=_({result:Ur(Ju),subscription:w()}),Xu={"solana-client":"js/0.0.0-development"};class Ln{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const l={};return async u=>{const{commitment:h,config:f}=ce(u),d=this._buildArgs([],h,void 0,f),p=us(d);return l[p]=l[p]??(async()=>{try{const g=await this._rpcRequest("getBlockHeight",d),y=x(g,W(w()));if("error"in y)throw new F(y.error,"failed to get block height information");return y.result}finally{delete l[p]}})(),await l[p]}})();let r,s,i,o,a,c;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,r=t.wsEndpoint,s=t.httpHeaders,i=t.fetch,o=t.fetchMiddleware,a=t.disableRetryOnRateLimit,c=t.httpAgent),this._rpcEndpoint=Fc(e),this._rpcWsEndpoint=r||Uc(e),this._rpcClient=Xc(e,s,i,o,a,c),this._rpcRequest=Yc(this._rpcClient),this._rpcBatchRequest=Qc(this._rpcClient),this._rpcWebSocket=new xc(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:r,config:s}=ce(t),i=this._buildArgs([e.toBase58()],r,void 0,s),o=await this._rpcRequest("getBalance",i),a=x(o,pe(w()));if("error"in a)throw new F(a.error,`failed to get balance for ${e.toBase58()}`);return a.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+r)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),r=x(t,W(T(w())));if("error"in r)throw new F(r.error,`failed to get block time for slot ${e}`);return r.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=x(e,W(w()));if("error"in t)throw new F(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=x(e,ou);if("error"in t)throw new F(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const r=await this._rpcRequest("getSupply",[t]),s=x(r,au);if("error"in s)throw new F(s.error,"failed to get supply");return s.result}async getTokenSupply(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenSupply",r),i=x(s,pe(nn));if("error"in i)throw new F(i.error,"failed to get token supply");return i.result}async getTokenAccountBalance(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenAccountBalance",r),i=x(s,pe(nn));if("error"in i)throw new F(i.error,"failed to get token account balance");return i.result}async getTokenAccountsByOwner(e,t,r){const{commitment:s,config:i}=ce(r);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const a=this._buildArgs(o,s,"base64",i),c=await this._rpcRequest("getTokenAccountsByOwner",a),l=x(c,uu);if("error"in l)throw new F(l.error,`failed to get token accounts owned by account ${e.toBase58()}`);return l.result}async getParsedTokenAccountsByOwner(e,t,r){let s=[e.toBase58()];"mint"in t?s.push({mint:t.mint.toBase58()}):s.push({programId:t.programId.toBase58()});const i=this._buildArgs(s,r,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",i),a=x(o,lu);if("error"in a)throw new F(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},r=t.filter||t.commitment?[t]:[],s=await this._rpcRequest("getLargestAccounts",r),i=x(s,du);if("error"in i)throw new F(i.error,"failed to get largest accounts");return i.result}async getTokenLargestAccounts(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenLargestAccounts",r),i=x(s,cu);if("error"in i)throw new F(i.error,"failed to get token largest accounts");return i.result}async getAccountInfoAndContext(e,t){const{commitment:r,config:s}=ce(t),i=this._buildArgs([e.toBase58()],r,"base64",s),o=await this._rpcRequest("getAccountInfo",i),a=x(o,pe(T(Yt)));if("error"in a)throw new F(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getParsedAccountInfo(e,t){const{commitment:r,config:s}=ce(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",s),o=await this._rpcRequest("getAccountInfo",i),a=x(o,pe(T(on)));if("error"in a)throw new F(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(r){throw new Error("failed to get info about account "+e.toBase58()+": "+r)}}async getMultipleParsedAccounts(e,t){const{commitment:r,config:s}=ce(t),i=e.map(l=>l.toBase58()),o=this._buildArgs([i],r,"jsonParsed",s),a=await this._rpcRequest("getMultipleAccounts",o),c=x(a,pe(P(T(on))));if("error"in c)throw new F(c.error,`failed to get info for accounts ${i}`);return c.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:r,config:s}=ce(t),i=e.map(l=>l.toBase58()),o=this._buildArgs([i],r,"base64",s),a=await this._rpcRequest("getMultipleAccounts",o),c=x(a,pe(P(T(Yt))));if("error"in c)throw new F(c.error,`failed to get info for accounts ${i}`);return c.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,r){const{commitment:s,config:i}=ce(t),o=this._buildArgs([e.toBase58()],s,void 0,{...i,epoch:r??i?.epoch}),a=await this._rpcRequest("getStakeActivation",o),c=x(a,W(gu));if("error"in c)throw new F(c.error,`failed to get Stake Activation ${e.toBase58()}`);return c.result}async getProgramAccounts(e,t){const{commitment:r,config:s}=ce(t),{encoding:i,...o}=s||{},a=this._buildArgs([e.toBase58()],r,i||"base64",o),c=await this._rpcRequest("getProgramAccounts",a),l=x(c,W(P(fu)));if("error"in l)throw new F(l.error,`failed to get accounts owned by program ${e.toBase58()}`);return l.result}async getParsedProgramAccounts(e,t){const{commitment:r,config:s}=ce(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",s),o=await this._rpcRequest("getProgramAccounts",i),a=x(o,W(P(pu)));if("error"in a)throw new F(a.error,`failed to get accounts owned by program ${e.toBase58()}`);return a.result}async confirmTransaction(e,t){let r;if(typeof e=="string")r=e;else{const i=e;if(i.abortSignal?.aborted)return Promise.reject(i.abortSignal.reason);r=i.signature}let s;try{s=ne.decode(r)}catch{throw new Error("signature must be base58 encoded: "+r)}return he(s.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:r}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,r)=>{e!=null&&(e.aborted?r(e.reason):e.addEventListener("abort",()=>{r(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let r,s,i=!1;const o=new Promise((c,l)=>{try{r=this.onSignature(t,(h,f)=>{r=void 0;const d={context:f,value:h};c({__type:Ze.PROCESSED,response:d})},e);const u=new Promise(h=>{r==null?h():s=this._onSubscriptionStateChange(r,f=>{f==="subscribed"&&h()})});(async()=>{if(await u,i)return;const h=await this.getSignatureStatus(t);if(i||h==null)return;const{context:f,value:d}=h;if(d!=null)if(d?.err)l(d.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(d.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(d.confirmationStatus==="processed"||d.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}i=!0,c({__type:Ze.PROCESSED,response:{context:f,value:d}})}})()}catch(u){l(u)}});return{abortConfirmation:()=>{s&&(s(),s=void 0),r!=null&&(this.removeSignatureListener(r),r=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:r,signature:s}}){let i=!1;const o=new Promise(h=>{const f=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let d=await f();if(!i){for(;d<=r;)if(await Tt(1e3),i||(d=await f(),i))return;h({__type:Ze.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:a,confirmationPromise:c}=this.getTransactionConfirmationPromise({commitment:e,signature:s}),l=this.getCancellationPromise(t);let u;try{const h=await Promise.race([l,c,o]);if(h.__type===Ze.PROCESSED)u=h.response;else throw new Ri(s)}finally{i=!0,a()}return u}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:r,nonceAccountPubkey:s,nonceValue:i,signature:o}}){let a=!1;const c=new Promise(d=>{let p=i,g=null;const y=async()=>{try{const{context:E,value:v}=await this.getNonceAndContext(s,{commitment:e,minContextSlot:r});return g=E.slot,v?.nonce}catch{return p}};(async()=>{if(p=await y(),!a)for(;;){if(i!==p){d({__type:Ze.NONCE_INVALID,slotInWhichNonceDidAdvance:g});return}if(await Tt(2e3),a||(p=await y(),a))return}})()}),{abortConfirmation:l,confirmationPromise:u}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),h=this.getCancellationPromise(t);let f;try{const d=await Promise.race([h,u,c]);if(d.__type===Ze.PROCESSED)f=d.response;else{let p;for(;;){const g=await this.getSignatureStatus(o);if(g==null)break;if(g.context.slot<(d.slotInWhichNonceDidAdvance??r)){await Tt(400);continue}p=g;break}if(p?.value){const g=e||"finalized",{confirmationStatus:y}=p.value;switch(g){case"processed":case"recent":if(y!=="processed"&&y!=="confirmed"&&y!=="finalized")throw new Wt(o);break;case"confirmed":case"single":case"singleGossip":if(y!=="confirmed"&&y!=="finalized")throw new Wt(o);break;case"finalized":case"max":case"root":if(y!=="finalized")throw new Wt(o);break;default:(E=>{})(g)}f={context:p.context,value:{err:p.value.err}}}else throw new Wt(o)}}finally{a=!0,l()}return f}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let r;const s=new Promise(c=>{let l=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{l=this._confirmTransactionInitialTimeout||3e4;break}}r=setTimeout(()=>c({__type:Ze.TIMED_OUT,timeoutMs:l}),l)}),{abortConfirmation:i,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let a;try{const c=await Promise.race([o,s]);if(c.__type===Ze.PROCESSED)a=c.response;else throw new Ii(t,c.timeoutMs/1e3)}finally{clearTimeout(r),i()}return a}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=x(e,W(P(Iu)));if("error"in t)throw new F(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getVoteAccounts",t),s=x(r,xu);if("error"in s)throw new F(s.error,"failed to get vote accounts");return s.result}async getSlot(e){const{commitment:t,config:r}=ce(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlot",s),o=x(i,W(w()));if("error"in o)throw new F(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:r}=ce(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlotLeader",s),o=x(i,W(R()));if("error"in o)throw new F(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const r=[e,t],s=await this._rpcRequest("getSlotLeaders",r),i=x(s,W(P(ge)));if("error"in i)throw new F(i.error,"failed to get slot leaders");return i.result}async getSignatureStatus(e,t){const{context:r,value:s}=await this.getSignatureStatuses([e],t);he(s.length===1);const i=s[0];return{context:r,value:i}}async getSignatureStatuses(e,t){const r=[e];t&&r.push(t);const s=await this._rpcRequest("getSignatureStatuses",r),i=x(s,Pu);if("error"in i)throw new F(i.error,"failed to get signature status");return i.result}async getTransactionCount(e){const{commitment:t,config:r}=ce(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getTransactionCount",s),o=x(i,W(w()));if("error"in o)throw new F(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getInflationGovernor",t),s=x(r,eu);if("error"in s)throw new F(s.error,"failed to get inflation");return s.result}async getInflationReward(e,t,r){const{commitment:s,config:i}=ce(r),o=this._buildArgs([e.map(l=>l.toBase58())],s,void 0,{...i,epoch:t??i?.epoch}),a=await this._rpcRequest("getInflationReward",o),c=x(a,$c);if("error"in c)throw new F(c.error,"failed to get inflation reward");return c.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=x(e,tu);if("error"in t)throw new F(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:r}=ce(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getEpochInfo",s),o=x(i,nu);if("error"in o)throw new F(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=x(e,su);if("error"in t)throw new F(t.error,"failed to get epoch schedule");const r=t.result;return new Rc(r.slotsPerEpoch,r.leaderScheduleSlotOffset,r.warmup,r.firstNormalEpoch,r.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=x(e,iu);if("error"in t)throw new F(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const r=this._buildArgs([e],t),s=await this._rpcRequest("getMinimumBalanceForRentExemption",r),i=x(s,Tu);return"error"in i?(console.warn("Unable to fetch minimum balance for rent exemption"),0):i.result}async getRecentBlockhashAndContext(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getRecentBlockhash",t),s=x(r,Du);if("error"in s)throw new F(s.error,"failed to get recent blockhash");return s.result}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),r=x(t,Hu);if("error"in r)throw new F(r.error,"failed to get recent performance samples");return r.result}async getFeeCalculatorForBlockhash(e,t){const r=this._buildArgs([e],t),s=await this._rpcRequest("getFeeCalculatorForBlockhash",r),i=x(s,Wu);if("error"in i)throw new F(i.error,"failed to get fee calculator");const{context:o,value:a}=i.result;return{context:o,value:a!==null?a.feeCalculator:null}}async getFeeForMessage(e,t){const r=Mt(e.serialize()).toString("base64"),s=this._buildArgs([r],t),i=await this._rpcRequest("getFeeForMessage",s),o=x(i,pe(T(w())));if("error"in o)throw new F(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){const t=e?.lockedWritableAccounts?.map(o=>o.toBase58()),r=this._buildArgs(t?.length?[t]:[]),s=await this._rpcRequest("getRecentPrioritizationFees",r),i=x(s,ru);if("error"in i)throw new F(i.error,"failed to get recent prioritization fees");return i.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:r}=ce(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getLatestBlockhash",s),o=x(i,zu);if("error"in o)throw new F(o.error,"failed to get latest blockhash");return o.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=x(e,W(Jc));if("error"in t)throw new F(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=x(e,W(R()));if("error"in t)throw new F(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:r,config:s}=ce(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,s),o=await this._rpcRequest("getBlock",i);try{switch(s?.transactionDetails){case"accounts":{const a=x(o,Mu);if("error"in a)throw a.error;return a.result}case"none":{const a=x(o,Uu);if("error"in a)throw a.error;return a.result}default:{const a=x(o,Nu);if("error"in a)throw a.error;const{result:c}=a;return c?{...c,transactions:c.transactions.map(({transaction:l,meta:u,version:h})=>({meta:u,transaction:{...l,message:Xr(h,l.message)},version:h}))}:null}}}catch(a){throw new F(a,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:r,config:s}=ce(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",s),o=await this._rpcRequest("getBlock",i);try{switch(s?.transactionDetails){case"accounts":{const a=x(o,qu);if("error"in a)throw a.error;return a.result}case"none":{const a=x(o,Ku);if("error"in a)throw a.error;return a.result}default:{const a=x(o,Fu);if("error"in a)throw a.error;return a.result}}}catch(a){throw new F(a,"failed to get block")}}async getBlockProduction(e){let t,r;if(typeof e=="string")r=e;else if(e){const{commitment:a,...c}=e;r=a,t=c}const s=this._buildArgs([],r,"base64",t),i=await this._rpcRequest("getBlockProduction",s),o=x(i,Zc);if("error"in o)throw new F(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:r,config:s}=ce(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,s),o=await this._rpcRequest("getTransaction",i),a=x(o,Yr);if("error"in a)throw new F(a.error,"failed to get transaction");const c=a.result;return c&&{...c,transaction:{...c.transaction,message:Xr(c.version,c.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:r,config:s}=ce(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",s),o=await this._rpcRequest("getTransaction",i),a=x(o,dr);if("error"in a)throw new F(a.error,"failed to get transaction");return a.result}async getParsedTransactions(e,t){const{commitment:r,config:s}=ce(t),i=e.map(c=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([c],r,"jsonParsed",s)}));return(await this._rpcBatchRequest(i)).map(c=>{const l=x(c,dr);if("error"in l)throw new F(l.error,"failed to get transactions");return l.result})}async getTransactions(e,t){const{commitment:r,config:s}=ce(t),i=e.map(c=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([c],r,void 0,s)}));return(await this._rpcBatchRequest(i)).map(c=>{const l=x(c,Yr);if("error"in l)throw new F(l.error,"failed to get transactions");const u=l.result;return u&&{...u,transaction:{...u.transaction,message:Xr(u.version,u.transaction.message)}}})}async getConfirmedBlock(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),s=await this._rpcRequest("getConfirmedBlock",r),i=x(s,$u);if("error"in i)throw new F(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");const a={...o,transactions:o.transactions.map(({transaction:c,meta:l})=>{const u=new yt(c.message);return{meta:l,transaction:{...c,message:u}}})};return{...a,transactions:a.transactions.map(({transaction:c,meta:l})=>({meta:l,transaction:dt.populate(c.message,c.signatures)}))}}async getBlocks(e,t,r){const s=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],r),i=await this._rpcRequest("getBlocks",s),o=x(i,W(P(w())));if("error"in o)throw new F(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getBlock",r),i=x(s,gs);if("error"in i)throw new F(i.error,"failed to get block");const o=i.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getConfirmedBlock",r),i=x(s,gs);if("error"in i)throw new F(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),s=await this._rpcRequest("getConfirmedTransaction",r),i=x(s,Yr);if("error"in i)throw new F(i.error,"failed to get transaction");const o=i.result;if(!o)return o;const a=new yt(o.transaction.message),c=o.transaction.signatures;return{...o,transaction:dt.populate(a,c)}}async getParsedConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),s=await this._rpcRequest("getConfirmedTransaction",r),i=x(s,dr);if("error"in i)throw new F(i.error,"failed to get confirmed transaction");return i.result}async getParsedConfirmedTransactions(e,t){const r=e.map(o=>({methodName:"getConfirmedTransaction",args:this._buildArgsAtLeastConfirmed([o],t,"jsonParsed")}));return(await this._rpcBatchRequest(r)).map(o=>{const a=x(o,dr);if("error"in a)throw new F(a.error,"failed to get confirmed transactions");return a.result})}async getConfirmedSignaturesForAddress(e,t,r){let s={},i=await this.getFirstAvailableBlock();for(;!("until"in s)&&(t--,!(t<=0||t<i));)try{const c=await this.getConfirmedBlockSignatures(t,"finalized");c.signatures.length>0&&(s.until=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}let o=await this.getSlot("finalized");for(;!("before"in s)&&(r++,!(r>o));)try{const c=await this.getConfirmedBlockSignatures(r);c.signatures.length>0&&(s.before=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}return(await this.getConfirmedSignaturesForAddress2(e,s)).map(c=>c.signature)}async getConfirmedSignaturesForAddress2(e,t,r){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getConfirmedSignaturesForAddress2",s),o=x(i,mu);if("error"in o)throw new F(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,r){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getSignaturesForAddress",s),o=x(i,yu);if("error"in o)throw new F(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:r,value:s}=await this.getAccountInfoAndContext(e,t);let i=null;return s!==null&&(i=new fs({key:e,state:fs.deserialize(s.data)})),{context:r,value:i}}async getNonceAndContext(e,t){const{context:r,value:s}=await this.getAccountInfoAndContext(e,t);let i=null;return s!==null&&(i=Cn.fromAccountData(s.data)),{context:r,value:i}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+r)})}async requestAirdrop(e,t){const r=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),s=x(r,Gu);if("error"in s)throw new F(s.error,`airdrop to ${e.toBase58()} failed`);return s.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await Tt(100);const r=Date.now()-this._blockhashInfo.lastFetch>=Mc;if(this._blockhashInfo.latestBlockhash!==null&&!r)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,r=t?t.blockhash:null;for(let s=0;s<50;s++){const i=await this.getLatestBlockhash("finalized");if(r!==i.blockhash)return this._blockhashInfo={latestBlockhash:i,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},i;await Tt(Tc/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:r}=ce(e),s=this._buildArgs([],t,"base64",r),i=await this._rpcRequest("getStakeMinimumDelegation",s),o=x(i,pe(w()));if("error"in o)throw new F(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,r){if("message"in e){const g=e.serialize(),y=U.from(g).toString("base64");if(Array.isArray(t)||r!==void 0)throw new Error("Invalid arguments");const E=t||{};E.encoding="base64","commitment"in E||(E.commitment=this.commitment);const v=[y,E],m=await this._rpcRequest("simulateTransaction",v),A=x(m,hs);if("error"in A)throw new Error("failed to simulate transaction: "+A.error.message);return A.result}let s;if(e instanceof dt){let p=e;s=new dt,s.feePayer=p.feePayer,s.instructions=e.instructions,s.nonceInfo=p.nonceInfo,s.signatures=p.signatures}else s=dt.populate(e),s._message=s._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(s.nonceInfo&&i)s.sign(...i);else{let p=this._disableBlockhashCaching;for(;;){const g=await this._blockhashWithExpiryBlockHeight(p);if(s.lastValidBlockHeight=g.lastValidBlockHeight,s.recentBlockhash=g.blockhash,!i)break;if(s.sign(...i),!s.signature)throw new Error("!signature");const y=s.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(y)&&!this._blockhashInfo.transactionSignatures.includes(y)){this._blockhashInfo.simulatedSignatures.push(y);break}else p=!0}}const o=s._compile(),a=o.serialize(),l=s._serialize(a).toString("base64"),u={encoding:"base64",commitment:this.commitment};if(r){const p=(Array.isArray(r)?r:o.nonProgramIds()).map(g=>g.toBase58());u.accounts={encoding:"base64",addresses:p}}i&&(u.sigVerify=!0);const h=[l,u],f=await this._rpcRequest("simulateTransaction",h),d=x(f,hs);if("error"in d){let p;if("data"in d.error&&(p=d.error.data.logs,p&&Array.isArray(p))){const g=`
    `,y=g+p.join(g);console.error(d.error.message,y)}throw new ls("failed to simulate transaction: "+d.error.message,p)}return d.result}async sendTransaction(e,t,r){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(e.nonceInfo)e.sign(...s);else{let o=this._disableBlockhashCaching;for(;;){const a=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=a.lastValidBlockHeight,e.recentBlockhash=a.blockhash,e.sign(...s),!e.signature)throw new Error("!signature");const c=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(c))o=!0;else{this._blockhashInfo.transactionSignatures.push(c);break}}}const i=e.serialize();return await this.sendRawTransaction(i,r)}async sendRawTransaction(e,t){const r=Mt(e).toString("base64");return await this.sendEncodedTransaction(r,t)}async sendEncodedTransaction(e,t){const r={encoding:"base64"},s=t&&t.skipPreflight,i=t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(r.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(r.minContextSlot=t.minContextSlot),s&&(r.skipPreflight=s),i&&(r.preflightCommitment=i);const o=[e,r],a=await this._rpcRequest("sendTransaction",o),c=x(a,Vu);if("error"in c){let l;throw"data"in c.error&&(l=c.error.data.logs),new ls("failed to send transaction: "+c.error.message,l)}return c.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,r])=>{this._setSubscription(t,{...r,state:"pending"})})}_setSubscription(e,t){const r=this._subscriptionsByHash[e]?.state;if(this._subscriptionsByHash[e]=t,r!==t.state){const s=this._subscriptionStateChangeCallbacksByHash[e];s&&s.forEach(i=>{try{i(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){var i;const r=this._subscriptionHashByClientSubscriptionId[e];if(r==null)return()=>{};const s=(i=this._subscriptionStateChangeCallbacksByHash)[r]||(i[r]=new Set);return s.add(t),()=>{s.delete(t),s.size===0&&delete this._subscriptionStateChangeCallbacksByHash[r]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(r){r instanceof Error&&console.log(`Error when closing socket connection: ${r.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async r=>{const s=this._subscriptionsByHash[r];if(s!==void 0)switch(s.state){case"pending":case"unsubscribed":if(s.callbacks.size===0){delete this._subscriptionsByHash[r],s.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[s.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:i,method:o}=s;try{this._setSubscription(r,{...s,state:"subscribing"});const a=await this._rpcWebSocket.call(o,i);this._setSubscription(r,{...s,serverSubscriptionId:a,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[a]=s.callbacks,await this._updateSubscriptions()}catch(a){if(a instanceof Error&&console.error(`${o} error for argument`,i,a.message),!t())return;this._setSubscription(r,{...s,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":s.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:i,unsubscribeMethod:o}=s;if(this._subscriptionsAutoDisposedByRpc.has(i))this._subscriptionsAutoDisposedByRpc.delete(i);else{this._setSubscription(r,{...s,state:"unsubscribing"}),this._setSubscription(r,{...s,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[i])}catch(a){if(a instanceof Error&&console.error(`${o} error:`,a.message),!t())return;this._setSubscription(r,{...s,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(r,{...s,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const r=this._subscriptionCallbacksByServerSubscriptionId[e];r!==void 0&&r.forEach(s=>{try{s(...t)}catch(i){console.error(i)}})}_wsOnAccountNotification(e){const{result:t,subscription:r}=x(e,wu);this._handleServerNotification(r,[t.value,t.context])}_makeSubscription(e,t){const r=this._nextClientSubscriptionId++,s=us([e.method,t]),i=this._subscriptionsByHash[s];return i===void 0?this._subscriptionsByHash[s]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:i.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[r]=s,this._subscriptionDisposeFunctionsByClientSubscriptionId[r]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[r],delete this._subscriptionHashByClientSubscriptionId[r];const o=this._subscriptionsByHash[s];he(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${r}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),r}onAccountChange(e,t,r){const s=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},s)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:r}=x(e,vu);this._handleServerNotification(r,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,r,s){const i=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64",s?{filters:s}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},i)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,r){const s=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],r||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},s)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:r}=x(e,Zu);this._handleServerNotification(r,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:r}=x(e,ku);this._handleServerNotification(r,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:r}=x(e,_u);this._handleServerNotification(r,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const r=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];r?await r():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,r,s){const i=t||this._commitment;if(i||r||s){let o={};r&&(o.encoding=r),i&&(o.commitment=i),s&&(o=Object.assign(o,s)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,r,s){const i=t||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,r,s)}_wsOnSignatureNotification(e){const{result:t,subscription:r}=x(e,Au);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(r),this._handleServerNotification(r,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,r){const s=this._buildArgs([e],r||this._commitment||"finalized"),i=this._makeSubscription({callback:(o,a)=>{if(o.type==="status"){t(o.result,a);try{this.removeSignatureListener(i)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},s);return i}onSignatureWithOptions(e,t,r){const{commitment:s,...i}={...r,commitment:r&&r.commitment||this._commitment||"finalized"},o=this._buildArgs([e],s,void 0,i),a=this._makeSubscription({callback:(c,l)=>{t(c,l);try{this.removeSignatureListener(a)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return a}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:r}=x(e,Ru);this._handleServerNotification(r,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class Vt{constructor(e){this._keypair=void 0,this._keypair=e??is()}static generate(){return new Vt(is())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const r=e.slice(32,64);if(!t||!t.skipValidation){const s=e.slice(0,32),i=tn(s);for(let o=0;o<32;o++)if(r[o]!==i[o])throw new Error("provided secretKey is invalid")}return new Vt({publicKey:r,secretKey:e})}static fromSeed(e){const t=tn(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),new Vt({publicKey:t,secretKey:r})}get publicKey(){return new $(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}Object.freeze({CreateLookupTable:{index:0,layout:M([K("instruction"),Ft("recentSlot"),Y("bumpSeed")])},FreezeLookupTable:{index:1,layout:M([K("instruction")])},ExtendLookupTable:{index:2,layout:M([K("instruction"),Ft(),Ie(G(),_t(K(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:M([K("instruction")])},CloseLookupTable:{index:4,layout:M([K("instruction")])}});new $("AddressLookupTab1e1111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:M([Y("instruction"),K("units"),K("additionalFee")])},RequestHeapFrame:{index:1,layout:M([Y("instruction"),K("bytes")])},SetComputeUnitLimit:{index:2,layout:M([Y("instruction"),K("units")])},SetComputeUnitPrice:{index:3,layout:M([Y("instruction"),Ft("microLamports")])}});new $("ComputeBudget111111111111111111111111111111");M([Y("numSignatures"),Y("padding"),qe("signatureOffset"),qe("signatureInstructionIndex"),qe("publicKeyOffset"),qe("publicKeyInstructionIndex"),qe("messageDataOffset"),qe("messageDataSize"),qe("messageInstructionIndex")]);new $("Ed25519SigVerify111111111111111111111111111");Bs.utils.isValidPrivateKey;Bs.getPublicKey;M([Y("numSignatures"),qe("signatureOffset"),Y("signatureInstructionIndex"),qe("ethAddressOffset"),Y("ethAddressInstructionIndex"),qe("messageDataOffset"),qe("messageDataSize"),Y("messageInstructionIndex"),le(20,"ethAddress"),le(64,"signature"),Y("recoveryId")]);new $("KeccakSecp256k11111111111111111111111111111");new $("StakeConfig11111111111111111111111111111111");class ms{constructor(e,t,r){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=r}}ms.default=new ms(0,0,$.default);Object.freeze({Initialize:{index:0,layout:M([K("instruction"),pc(),gc()])},Authorize:{index:1,layout:M([K("instruction"),G("newAuthorized"),K("stakeAuthorizationType")])},Delegate:{index:2,layout:M([K("instruction")])},Split:{index:3,layout:M([K("instruction"),Le("lamports")])},Withdraw:{index:4,layout:M([K("instruction"),Le("lamports")])},Deactivate:{index:5,layout:M([K("instruction")])},Merge:{index:7,layout:M([K("instruction")])},AuthorizeWithSeed:{index:8,layout:M([K("instruction"),G("newAuthorized"),K("stakeAuthorizationType"),Ot("authoritySeed"),G("authorityOwner")])}});new $("Stake11111111111111111111111111111111111111");Object.freeze({InitializeAccount:{index:0,layout:M([K("instruction"),mc()])},Authorize:{index:1,layout:M([K("instruction"),G("newAuthorized"),K("voteAuthorizationType")])},Withdraw:{index:3,layout:M([K("instruction"),Le("lamports")])},AuthorizeWithSeed:{index:10,layout:M([K("instruction"),yc()])}});new $("Vote111111111111111111111111111111111111111");new $("Va1idator1nfo111111111111111111111111111111");_({name:R(),website:D(R()),details:D(R()),keybaseUsername:D(R())});new $("Vote111111111111111111111111111111111111111");M([G("nodePubkey"),G("authorizedWithdrawer"),Y("commission"),we(),Ie(M([we("slot"),K("confirmationCount")]),_t(K(),-8),"votes"),Y("rootSlotValid"),we("rootSlot"),we(),Ie(M([we("epoch"),G("authorizedVoter")]),_t(K(),-8),"authorizedVoters"),M([Ie(M([G("authorizedPubkey"),we("epochOfLastAuthorizedSwitch"),we("targetEpoch")]),32,"buf"),we("idx"),Y("isEmpty")],"priorVoters"),we(),Ie(M([we("epoch"),we("credits"),we("prevCredits")]),_t(K(),-8),"epochCredits"),M([we("slot"),we("timestamp")],"lastTimestamp")]);function Yu(n){return function(e,t,r,s){return e.method==="solana_chainId"?(t.result=n,s()):r()}}function Qu(n){return function(e,t,r,s){return e.method==="solana_provider_config"?(t.result=n,s()):r()}}function qi(n){var e=n.chainId;return Qt([Yu(e),Qu(n)])}function el(n){var e=n.rpcTarget,t=wo({rpcTarget:e}),r=Qt([qi(n),t]);return{networkMiddleware:r,fetchMiddleware:t}}function tl(n){var e=n.getAccounts;return Rr(function(){var t=L(k.mark(function r(s,i,o){var a,c;return k.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=s.method,a==="getAccounts"){u.next=3;break}return u.abrupt("return",o());case 3:if(e){u.next=5;break}throw new Error("WalletMiddleware - opts.getAccounts not provided");case 5:return u.next=7,e(s);case 7:return c=u.sent,i.result=c,u.abrupt("return",void 0);case 10:case"end":return u.stop()}},r)}));return function(r,s,i){return t.apply(this,arguments)}}())}function rl(n){var e=n.requestAccounts;return Rr(function(){var t=L(k.mark(function r(s,i,o){var a,c;return k.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=s.method,a==="requestAccounts"){u.next=3;break}return u.abrupt("return",o());case 3:if(e){u.next=5;break}throw new Error("WalletMiddleware - opts.requestAccounts not provided");case 5:return u.next=7,e(s);case 7:return c=u.sent,i.result=c,u.abrupt("return",void 0);case 10:case"end":return u.stop()}},r)}));return function(r,s,i){return t.apply(this,arguments)}}())}function nt(n,e){return Rr(function(){var t=L(k.mark(function r(s,i,o){var a,c;return k.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=s.method,a===n){u.next=3;break}return u.abrupt("return",o());case 3:if(e){u.next=5;break}throw new Error("WalletMiddleware - ".concat(n," not provided"));case 5:return u.next=7,e(s);case 7:return c=u.sent,i.result=c,u.abrupt("return",void 0);case 10:case"end":return u.stop()}},r)}));return function(r,s,i){return t.apply(this,arguments)}}())}function Nn(n){var e=n.getAccounts,t=n.requestAccounts,r=n.signTransaction,s=n.signAndSendTransaction,i=n.signAllTransactions,o=n.signMessage,a=n.getPrivateKey,c=n.getSecretKey;return Qt([rl({requestAccounts:t}),tl({getAccounts:e}),nt("signTransaction",r),nt("signAndSendTransaction",s),nt("signAllTransactions",i),nt("signMessage",o),nt("solanaPrivateKey",a),nt("solanaSecretKey",c)])}function nl(n){var e=n.addNewChainConfig,t=n.switchSolanaChain;return Qt([nt("addSolanaChain",e),nt("switchSolanaChain",t)])}function sl(n){var e=n.updatePrivatekey;return Qt([nt("updateAccount",e)])}function ys(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function ws(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ys(Object(t),!0).forEach(function(r){qt(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ys(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function il(n){var e=ol();return function(){var r=Ce(n),s;if(e){var i=Ce(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return Rt(this,s)}}function ol(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Fr=function(n){At(t,n);var e=il(t);function t(r){var s=r.config,i=r.state;return wt(this,t),e.call(this,{config:{chainConfig:ws(ws({},s.chainConfig),{},{chainNamespace:pr.SOLANA})},state:i})}return bt(t,[{key:"switchChain",value:function(){var r=L(k.mark(function i(o){return k.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Promise.resolve());case 1:case"end":return c.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"setupProvider",value:function(){var r=L(k.mark(function i(o){var a,c,l,u,h,f;return k.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return a=new ln,c=this.getProviderHandlers(o),l=Nn(c),a.push(l),u=qi(this.config.chainConfig),a.push(u),h=this.getInjectedProviderProxy(o),h&&a.push(h),f=dn(a),this.updateProviderEngineProxy(f),p.next=12,this.lookupNetwork();case 12:case"end":return p.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"lookupNetwork",value:function(){var r=L(k.mark(function i(){var o;return k.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=this.config.chainConfig,this.update({chainId:o.chainId}),c.abrupt("return",o.chainId||"");case 3:case"end":return c.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"getInjectedProviderProxy",value:function(s){}}]),t}(cn),Un=function(e){var t={requestAccounts:function(){var r=L(k.mark(function i(){return k.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e.publicKey?[ne.encode(e.publicKey.toBytes())]:[]);case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getAccounts:function(){var r=L(k.mark(function i(){return k.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e.publicKey?[ne.encode(e.publicKey.toBytes())]:[]);case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getPrivateKey:function(){var r=L(k.mark(function i(){return k.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw J.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getSecretKey:function(){var r=L(k.mark(function i(){return k.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw J.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),signTransaction:function(){var r=L(k.mark(function i(o){var a;return k.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,e.signTransaction(o.params.message);case 2:return a=l.sent,l.abrupt("return",a);case 4:case"end":return l.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signMessage:function(){var r=L(k.mark(function i(o){var a;return k.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,e.signMessage(o.params.message,o.params.display);case 2:return a=l.sent,l.abrupt("return",a.signature);case 4:case"end":return l.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAllTransactions:function(){var r=L(k.mark(function i(o){var a,c,l;return k.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(!((a=o.params)!==null&&a!==void 0&&a.message)||!((c=o.params)!==null&&c!==void 0&&c.message.length))){h.next=2;break}throw J.ethErrors.rpc.invalidParams("message");case 2:return h.next=4,e.signAllTransactions(o.params.message);case 4:return l=h.sent,h.abrupt("return",l);case 6:case"end":return h.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAndSendTransaction:function(){var r=L(k.mark(function i(o){var a;return k.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,e.signAndSendTransaction(o.params.message);case 2:return a=l.sent,l.abrupt("return",{signature:a.signature});case 4:case"end":return l.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()};return t};function bs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function al(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?bs(Object(t),!0).forEach(function(r){qt(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):bs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Ki(n){return Rr(function(){var e=L(k.mark(function t(r,s,i){var o;return k.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,n.request(al({},r));case 2:o=c.sent,s.result=o;case 4:case"end":return c.stop()}},t)}));return function(t,r,s){return e.apply(this,arguments)}}())}function cl(n){var e=ul();return function(){var r=Ce(n),s;if(e){var i=Ce(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return Rt(this,s)}}function ul(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Pl=function(n){At(t,n);var e=cl(t);function t(){return wt(this,t),e.apply(this,arguments)}return bt(t,[{key:"getProviderHandlers",value:function(s){return Un(s)}},{key:"getInjectedProviderProxy",value:function(s){return Ki(s)}}]),t}(Fr),ll=function(e,t){var r={requestAccounts:function(){var s=L(k.mark(function o(){var a,c;return k.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,e.connect();case 2:return a=u.sent,c=a.data,u.abrupt("return",[c.publicKey]);case 5:case"end":return u.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),getAccounts:function(){var s=L(k.mark(function o(){var a,c;return k.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,e.connect();case 2:return a=u.sent,c=a.data,u.abrupt("return",[c.publicKey]);case 5:case"end":return u.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),getPrivateKey:function(){var s=L(k.mark(function o(){return k.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:throw J.ethErrors.rpc.methodNotSupported();case 1:case"end":return c.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),getSecretKey:function(){var s=L(k.mark(function o(){return k.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:throw J.ethErrors.rpc.methodNotSupported();case 1:case"end":return c.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),signTransaction:function(){var s=L(k.mark(function o(a){var c,l,u,h,f;return k.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(c=a.params.message,c){p.next=3;break}throw J.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});case 3:return p.next=5,e.signTransaction(ne.encode(c.serializeMessage()));case 5:if(l=p.sent,u=l.data,!(!u.publicKey||!u.signature)){p.next=9;break}throw new Error("Invalid signature from slope wallet");case 9:return h=new $(u.publicKey),f=ne.decode(u.signature),c.addSignature(h,U.from(f)),p.abrupt("return",c);case 13:case"end":return p.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}(),signMessage:function(){var s=L(k.mark(function o(a){var c;return k.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,e.signMessage(a.params.message);case 2:return c=u.sent,u.abrupt("return",ne.decode(c.data.signature));case 4:case"end":return u.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}(),signAndSendTransaction:function(){var s=L(k.mark(function o(a){var c,l,u,h,f,d,p,g,y;return k.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(c=t(),c){v.next=3;break}throw J.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:if(l=a.params.message,l){v.next=6;break}throw J.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});case 6:return v.next=8,e.signTransaction(ne.encode(l.serializeMessage()));case 8:if(u=v.sent,h=u.data,!(!h.publicKey||!h.signature)){v.next=12;break}throw new Error("Invalid signature from slope wallet");case 12:return f=new $(h.publicKey),d=ne.decode(h.signature),l.addSignature(f,U.from(d)),v.next=17,c.request({method:"solana_provider_config",params:[]});case 17:return p=v.sent,g=new Ln(p.rpcTarget),v.next=21,g.sendRawTransaction(l.serialize());case 21:return y=v.sent,v.abrupt("return",{signature:y});case 23:case"end":return v.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}(),signAllTransactions:function(){var s=L(k.mark(function o(a){var c,l,u,h,f,d,p,g,y,E,v,m;return k.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(!((c=a.params)!==null&&c!==void 0&&c.message)||!((l=a.params)!==null&&l!==void 0&&l.message.length))){S.next=2;break}throw J.ethErrors.rpc.invalidParams("message");case 2:for(h=a.params.message,f=h.length,d=[],p=0;p<f;p++)d.push(ne.encode(a.params.message[p].serializeMessage()));return S.next=8,e.signAllTransactions(d);case 8:if(g=S.sent,y=g.msg,E=g.data,!(!E.publicKey||((u=E.signatures)===null||u===void 0?void 0:u.length)!==f)){S.next=13;break}throw new Error(y);case 13:for(v=new $(E.publicKey),p=0;p<f;p++)m=ne.decode(E.signatures[p]),h[p].addSignature(v,U.from(m));return S.abrupt("return",h);case 16:case"end":return S.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}()};return r};function dl(n){var e=fl();return function(){var r=Ce(n),s;if(e){var i=Ce(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return Rt(this,s)}}function fl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Tl=function(n){At(t,n);var e=dl(t);function t(){return wt(this,t),e.apply(this,arguments)}return bt(t,[{key:"getProviderHandlers",value:function(s){return ll(s,this.getProviderEngineProxy.bind(this))}}]),t}(Fr),hl=function(e,t){var r=Un(e);return r.signAndSendTransaction=function(){var s=L(k.mark(function i(o){var a,c,l,u,h;return k.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(a=t(),a){d.next=3;break}throw J.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return d.next=5,e.signTransaction(o.params.message);case 5:return c=d.sent,d.next=8,a.request({method:"solana_provider_config",params:[]});case 8:return l=d.sent,u=new Ln(l.rpcTarget),d.next=12,u.sendRawTransaction(c.serialize());case 12:return h=d.sent,d.abrupt("return",{signature:h});case 14:case"end":return d.stop()}},i)}));return function(i){return s.apply(this,arguments)}}(),r};function pl(n){var e=gl();return function(){var r=Ce(n),s;if(e){var i=Ce(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return Rt(this,s)}}function gl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ol=function(n){At(t,n);var e=pl(t);function t(){return wt(this,t),e.apply(this,arguments)}return bt(t,[{key:"getProviderHandlers",value:function(s){return hl(s,this.getProviderEngineProxy.bind(this))}}]),t}(Fr),ml=function(e,t){var r=Un(e);return r.signMessage=function(){var s=L(k.mark(function i(o){var a,c;return k.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,e.sign(o.params.message,"utf8");case 2:return a=u.sent,c=a.signature,u.abrupt("return",c);case 5:case"end":return u.stop()}},i)}));return function(i){return s.apply(this,arguments)}}(),r.signAndSendTransaction=function(){var s=L(k.mark(function i(o){var a,c,l,u,h;return k.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(a=t(),a){d.next=3;break}throw J.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return d.next=5,e.signTransaction(o.params.message);case 5:return c=d.sent,d.next=8,a.request({method:"solana_provider_config",params:[]});case 8:return l=d.sent,u=new Ln(l.rpcTarget),d.next=12,u.sendRawTransaction(c.serialize());case 12:return h=d.sent,d.abrupt("return",{signature:h});case 14:case"end":return d.stop()}},i)}));return function(i){return s.apply(this,arguments)}}(),r};function yl(n){var e=wl();return function(){var r=Ce(n),s;if(e){var i=Ce(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return Rt(this,s)}}function wl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ll=function(n){At(t,n);var e=yl(t);function t(){return wt(this,t),e.apply(this,arguments)}return bt(t,[{key:"getProviderHandlers",value:function(s){return ml(s,this.getProviderEngineProxy.bind(this))}}]),t}(Fr),bl=function(e){var t={requestAccounts:function(){var r=L(k.mark(function i(){var o;return k.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,e.request({method:"solana_requestAccounts",params:{}});case 2:return o=c.sent,c.abrupt("return",o);case 4:case"end":return c.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getAccounts:function(){var r=L(k.mark(function i(){var o;return k.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,e.request({method:"solana_requestAccounts",params:{}});case 2:return o=c.sent,c.abrupt("return",o);case 4:case"end":return c.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getPrivateKey:function(){var r=L(k.mark(function i(){return k.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw J.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getSecretKey:function(){var r=L(k.mark(function i(){return k.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw J.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),signMessage:function(){var r=L(k.mark(function i(o){var a,c;return k.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if((a=o.params)!==null&&a!==void 0&&a.message){u.next=2;break}throw J.ethErrors.rpc.invalidParams("message");case 2:return u.next=4,e.signMessage(o.params.message);case 4:return c=u.sent,u.abrupt("return",c);case 6:case"end":return u.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signTransaction:function(){var r=L(k.mark(function i(o){var a,c,l;return k.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if((a=o.params)!==null&&a!==void 0&&a.message){h.next=2;break}throw J.ethErrors.rpc.invalidParams("message");case 2:return c=o.params.message,h.next=5,e.signTransaction(c);case 5:return l=h.sent,h.abrupt("return",l);case 7:case"end":return h.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAndSendTransaction:function(){var r=L(k.mark(function i(o){var a,c,l;return k.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if((a=o.params)!==null&&a!==void 0&&a.message){h.next=2;break}throw J.ethErrors.rpc.invalidParams("message");case 2:return c=o.params.message,h.next=5,e.sendTransaction(c);case 5:return l=h.sent,h.abrupt("return",{signature:l});case 7:case"end":return h.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAllTransactions:function(){var r=L(k.mark(function i(o){var a,c,l,u;return k.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(!((a=o.params)!==null&&a!==void 0&&a.message)||!((c=o.params)!==null&&c!==void 0&&c.message.length))){f.next=2;break}throw J.ethErrors.rpc.invalidParams("message");case 2:return l=o.params.message,f.next=5,e.signAllTransactions(l);case 5:return u=f.sent,f.abrupt("return",u);case 7:case"end":return f.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()};return t};function vs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function fr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?vs(Object(t),!0).forEach(function(r){qt(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):vs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function vl(n){var e=Sl();return function(){var r=Ce(n),s;if(e){var i=Ce(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return Rt(this,s)}}function Sl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Nl=function(n){At(t,n);var e=vl(t);function t(r){var s=r.config,i=r.state;return wt(this,t),e.call(this,{config:{chainConfig:fr(fr({},s.chainConfig),{},{chainNamespace:pr.SOLANA})},state:i})}return bt(t,[{key:"switchChain",value:function(){var r=L(k.mark(function i(o){return k.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Promise.resolve());case 1:case"end":return c.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"setupProvider",value:function(){var r=L(k.mark(function i(o){return k.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.handleInjectedProviderUpdate(o),c.next=3,this.setupEngine(o);case 3:case"end":return c.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"lookupNetwork",value:function(){var r=L(k.mark(function i(){var o,a,c;return k.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.provider){u.next=2;break}throw J.ethErrors.provider.custom({message:"Torus solana provider is not initialized",code:4902});case 2:return o=this.config.chainConfig.chainId,u.next=5,this.provider.request({method:"solana_chainId"});case 5:if(a=u.sent,c=Jn(a.toString())?a:"0x".concat(parseInt(a,10).toString(16)),o===c){u.next=9;break}throw un.rpcConnectionError("Invalid network, net_version is: ".concat(c,", expected: ").concat(o));case 9:return this.update({chainId:c}),this.provider.emit("connect",{chainId:this.state.chainId}),this.provider.emit("chainChanged",this.state.chainId),u.abrupt("return",this.state.chainId);case 13:case"end":return u.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"setupEngine",value:function(){var r=L(k.mark(function i(o){var a,c,l,u,h;return k.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a=bl(o),c=Nn(a),l=Ki(o),u=new ln,u.push(c),u.push(l),h=dn(u),this.updateProviderEngineProxy(h),d.next=10,this.lookupNetwork();case 10:case"end":return d.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"handleInjectedProviderUpdate",value:function(){var r=L(k.mark(function i(o){var a=this;return k.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:o.on("accountsChanged",function(){var u=L(k.mark(function h(f){return k.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:a.provider.emit("accountsChanged",f);case 1:case"end":return p.stop()}},h)}));return function(h){return u.apply(this,arguments)}}()),o.on("chainChanged",function(){var u=L(k.mark(function h(f){var d;return k.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return d=Jn(f)?f:"0x".concat(parseInt(f,10).toString(16)),a.configure({chainConfig:fr(fr({},a.config.chainConfig),{},{chainId:d})}),g.next=4,a.setupProvider(o);case 4:case"end":return g.stop()}},h)}));return function(h){return u.apply(this,arguments)}}());case 2:case"end":return l.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()}]),t}(cn);function kl(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=El(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,s=function(){};return{s,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(l){throw l},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,a;return{s:function(){t=t.call(n)},n:function(){var l=t.next();return i=l.done,l},e:function(l){o=!0,a=l},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw a}}}}function El(n,e){if(n){if(typeof n=="string")return Ss(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ss(n,e)}}function Ss(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function _l(n){return an.apply(this,arguments)}function an(){return an=L(k.mark(function n(e){var t,r,s,i,o;return k.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.privKey,r=e.getProviderEngineProxy,s=function(){return Vt.fromSecretKey(U.from(t,"hex"))},typeof t=="string"){c.next=4;break}throw un.invalidParams("privKey must be a string");case 4:return i=s(),o={requestAccounts:function(){var l=L(k.mark(function h(){return k.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[i.publicKey.toBase58()]);case 1:case"end":return d.stop()}},h)}));function u(){return l.apply(this,arguments)}return u}(),getAccounts:function(){var l=L(k.mark(function h(){return k.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[i.publicKey.toBase58()]);case 1:case"end":return d.stop()}},h)}));function u(){return l.apply(this,arguments)}return u}(),getPrivateKey:function(){var l=L(k.mark(function h(){return k.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",t);case 1:case"end":return d.stop()}},h)}));function u(){return l.apply(this,arguments)}return u}(),getSecretKey:function(){var l=L(k.mark(function h(){return k.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",ne.encode(i.secretKey));case 1:case"end":return d.stop()}},h)}));function u(){return l.apply(this,arguments)}return u}(),signTransaction:function(){var l=L(k.mark(function h(f){var d,p;return k.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if((d=f.params)!==null&&d!==void 0&&d.message){y.next=2;break}throw J.ethErrors.rpc.invalidParams("message");case 2:return p=f.params.message,p.partialSign(i),y.abrupt("return",p);case 5:case"end":return y.stop()}},h)}));function u(h){return l.apply(this,arguments)}return u}(),signMessage:function(){var l=L(k.mark(function h(f){var d,p;return k.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if((d=f.params)!==null&&d!==void 0&&d.message){y.next=2;break}throw J.ethErrors.rpc.invalidParams("message");case 2:return p=bo.sign.detached(f.params.message,i.secretKey),y.abrupt("return",p);case 4:case"end":return y.stop()}},h)}));function u(h){return l.apply(this,arguments)}return u}(),signAndSendTransaction:function(){var l=L(k.mark(function h(f){var d,p,g,y;return k.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if((d=f.params)!==null&&d!==void 0&&d.message){v.next=2;break}throw J.ethErrors.rpc.invalidParams("message");case 2:if(p=r(),p){v.next=5;break}throw J.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 5:return g=f.params.message,g.sign(i),v.next=9,p.request({method:"sendTransaction",params:[ne.encode(g.serialize())]});case 9:return y=v.sent,v.abrupt("return",{signature:y});case 11:case"end":return v.stop()}},h)}));function u(h){return l.apply(this,arguments)}return u}(),signAllTransactions:function(){var l=L(k.mark(function h(f){var d,p,g,y,E,v,m,A;return k.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(!(!((d=f.params)!==null&&d!==void 0&&d.message)||!((p=f.params)!==null&&p!==void 0&&p.message.length))){C.next=2;break}throw J.ethErrors.rpc.invalidParams("message");case 2:y=(g=f.params)===null||g===void 0?void 0:g.message,E=kl(y||[]);try{for(E.s();!(v=E.n()).done;)m=v.value,A=m,A.partialSign(i)}catch(B){E.e(B)}finally{E.f()}return C.abrupt("return",y);case 6:case"end":return C.stop()}},h)}));function u(h){return l.apply(this,arguments)}return u}()},c.abrupt("return",o);case 7:case"end":return c.stop()}},n)})),an.apply(this,arguments)}function ks(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Es(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ks(Object(t),!0).forEach(function(r){qt(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ks(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Al(n){var e=Rl();return function(){var r=Ce(n),s;if(e){var i=Ce(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return Rt(this,s)}}function Rl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _s=function(n){At(t,n);var e=Al(t);function t(r){var s=r.config,i=r.state;return wt(this,t),e.call(this,{config:{chainConfig:Es(Es({},s.chainConfig),{},{chainNamespace:pr.SOLANA})},state:i})}return bt(t,[{key:"enable",value:function(){var r=L(k.mark(function i(){return k.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.state.privateKey){a.next=2;break}throw J.ethErrors.provider.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});case 2:return a.next=4,this.setupProvider(this.state.privateKey);case 4:return a.abrupt("return",this._providerEngineProxy.request({method:"eth_accounts"}));case 5:case"end":return a.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"setupProvider",value:function(){var r=L(k.mark(function i(o){var a,c,l,u,h,f;return k.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,_l({privKey:o,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)});case 2:return a=p.sent,c=Nn(a),l=new ln,u=el(this.config.chainConfig),h=u.networkMiddleware,l.push(this.getChainSwitchMiddleware()),l.push(this.getAccountMiddleware()),l.push(c),l.push(h),f=dn(l),this.updateProviderEngineProxy(f),p.next=14,this.lookupNetwork();case 14:case"end":return p.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"updateAccount",value:function(){var r=L(k.mark(function i(o){var a;return k.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this._providerEngineProxy){l.next=2;break}throw J.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return l.next=4,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 4:if(a=l.sent,a===o.privateKey){l.next=14;break}return l.next=8,this.setupProvider(o.privateKey);case 8:return l.t0=this._providerEngineProxy,l.next=11,this._providerEngineProxy.request({method:"requestAccounts"});case 11:l.t1=l.sent,l.t2={accounts:l.t1},l.t0.emit.call(l.t0,"accountsChanged",l.t2);case 14:case"end":return l.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"switchChain",value:function(){var r=L(k.mark(function i(o){var a,c;return k.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this._providerEngineProxy){u.next=2;break}throw J.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return a=this.getChainConfig(o.chainId),this.update({chainId:"loading"}),this.configure({chainConfig:a}),u.next=7,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 7:return c=u.sent,u.next=10,this.setupProvider(c);case 10:case"end":return u.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"lookupNetwork",value:function(){var r=L(k.mark(function i(){var o,a;return k.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this._providerEngineProxy){l.next=2;break}throw J.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return l.next=4,this._providerEngineProxy.request({method:"getHealth",params:[]});case 4:if(o=l.sent,a=this.config.chainConfig,o==="ok"){l.next=8;break}throw un.rpcConnectionError("Failed to lookup network for following rpc target: ".concat(a.rpcTarget));case 8:return this.update({chainId:a.chainId}),this.state.chainId!==a.chainId&&(this.provider.emit("chainChanged",this.state.chainId),this.provider.emit("connect",{chainId:this.state.chainId})),l.abrupt("return",this.state.chainId);case 11:case"end":return l.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"getChainSwitchMiddleware",value:function(){var s=this,i={addNewChainConfig:function(){var a=L(k.mark(function l(u){var h,f,d,p,g,y;return k.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(u.params){v.next=2;break}throw J.ethErrors.rpc.invalidParams("Missing request params");case 2:if(h=u.params,f=h.chainId,d=h.chainName,p=h.rpcUrls,g=h.blockExplorerUrls,y=h.nativeCurrency,f){v.next=5;break}throw J.ethErrors.rpc.invalidParams("Missing chainId in chainParams");case 5:if(!(!p||p.length===0)){v.next=7;break}throw J.ethErrors.rpc.invalidParams("Missing rpcUrls in chainParams");case 7:if(y){v.next=9;break}throw J.ethErrors.rpc.invalidParams("Missing nativeCurrency in chainParams");case 9:s.addChain({chainNamespace:pr.SOLANA,chainId:f,ticker:y?.symbol||"SOL",tickerName:y?.name||"Solana",displayName:d,rpcTarget:p[0],blockExplorer:g?.[0]||""});case 10:case"end":return v.stop()}},l)}));function c(l){return a.apply(this,arguments)}return c}(),switchSolanaChain:function(){var a=L(k.mark(function l(u){return k.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(u.params){f.next=2;break}throw J.ethErrors.rpc.invalidParams("Missing request params");case 2:if(u.params.chainId){f.next=4;break}throw J.ethErrors.rpc.invalidParams("Missing chainId");case 4:return f.next=6,s.switchChain(u.params);case 6:case"end":return f.stop()}},l)}));function c(l){return a.apply(this,arguments)}return c}()},o=nl(i);return o}},{key:"getAccountMiddleware",value:function(){var s=this,i={updatePrivatekey:function(){var o=L(k.mark(function c(l){var u;return k.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(l.params){f.next=2;break}throw J.ethErrors.rpc.invalidParams("Missing request params");case 2:if(l.params.privateKey){f.next=4;break}throw J.ethErrors.rpc.invalidParams("Missing privateKey");case 4:return u=l.params.privateKey,f.next=7,s.updateAccount({privateKey:u});case 7:case"end":return f.stop()}},c)}));function a(c){return o.apply(this,arguments)}return a}()};return sl(i)}}]),t}(cn);qt(_s,"getProviderInstance",function(){var n=L(k.mark(function e(t){var r;return k.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=new _s({config:{chainConfig:t.chainConfig}}),i.next=3,r.setupProvider(t.privKey);case 3:return i.abrupt("return",r);case 4:case"end":return i.stop()}},e)}));return function(e){return n.apply(this,arguments)}}());var Ul=function(){function n(e){wt(this,n),qt(this,"provider",void 0),this.provider=e}return bt(n,[{key:"requestAccounts",value:function(){var e=L(k.mark(function r(){var s;return k.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.provider.request({method:"requestAccounts",params:{}});case 2:return s=o.sent,o.abrupt("return",s);case 4:case"end":return o.stop()}},r,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"signAndSendTransaction",value:function(){var e=L(k.mark(function r(s){var i,o;return k.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.provider.request({method:"signAndSendTransaction",params:{message:s}});case 2:return i=c.sent,o=i.signature,c.abrupt("return",{signature:o});case 5:case"end":return c.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"signTransaction",value:function(){var e=L(k.mark(function r(s){var i;return k.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request({method:"signTransaction",params:{message:s}});case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"signAllTransactions",value:function(){var e=L(k.mark(function r(s){var i;return k.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request({method:"signAllTransactions",params:{message:s}});case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"signMessage",value:function(){var e=L(k.mark(function r(s){var i;return k.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request({method:"signMessage",params:{message:s}});case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"request",value:function(){var e=L(k.mark(function r(s){var i;return k.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request(s);case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()}]),n}();export{Pl as PhantomInjectedProvider,Tl as SlopeInjectedProxyProvider,_s as SolanaPrivateKeyProvider,Ul as SolanaWallet,Ol as SolflareInjectedProvider,Ll as SolletInjectedProvider,Nl as TorusInjectedProvider};
