import{s as Wi,u as D,w as Tr,S as Gi,n as Us,g as Ve,b as Vi,c as Me,B as L,r as Zi,a as Xi,_ as Ji,d as Yi,e as Qi,i as eo,p as to,f as ro,h as v,j as Ns,k as $s,l as no,m as un,o as Xn,q as wt,t as ct,v as ut,C as yr,x as An,y as Nt,z as Qt,A as Pr,D as Ae,E as bt,F as P,G as j,H as Jn,W as En,J as xn,I as In,K as so}from"./index-b839d271.js";import{n as io}from"./nacl-fast-5bb3a95e.js";var ar=Wi.Buffer;function oo(n){if(n.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),t=0;t<e.length;t++)e[t]=255;for(var r=0;r<n.length;r++){var s=n.charAt(r),i=s.charCodeAt(0);if(e[i]!==255)throw new TypeError(s+" is ambiguous");e[i]=r}var o=n.length,a=n.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function l(d){if((Array.isArray(d)||d instanceof Uint8Array)&&(d=ar.from(d)),!ar.isBuffer(d))throw new TypeError("Expected Buffer");if(d.length===0)return"";for(var p=0,g=0,m=0,k=d.length;m!==k&&d[m]===0;)m++,p++;for(var b=(k-m)*u+1>>>0,S=new Uint8Array(b);m!==k;){for(var T=d[m],E=0,U=b-1;(T!==0||E<g)&&U!==-1;U--,E++)T+=256*S[U]>>>0,S[U]=T%o>>>0,T=T/o>>>0;if(T!==0)throw new Error("Non-zero carry");g=E,m++}for(var C=b-g;C!==b&&S[C]===0;)C++;for(var M=a.repeat(p);C<b;++C)M+=n.charAt(S[C]);return M}function f(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return ar.alloc(0);for(var p=0,g=0,m=0;d[p]===a;)g++,p++;for(var k=(d.length-p)*c+1>>>0,b=new Uint8Array(k);d[p];){var S=e[d.charCodeAt(p)];if(S===255)return;for(var T=0,E=k-1;(S!==0||T<m)&&E!==-1;E--,T++)S+=o*b[E]>>>0,b[E]=S%256>>>0,S=S/256>>>0;if(S!==0)throw new Error("Non-zero carry");m=T,p++}for(var U=k-m;U!==k&&b[U]===0;)U++;var C=ar.allocUnsafe(g+(k-U));C.fill(0,0,g);for(var M=g;U!==k;)C[M++]=b[U++];return C}function h(d){var p=f(d);if(p)return p;throw new Error("Non-base"+o+" character")}return{encode:l,decodeUnsafe:f,decode:h}}var ao=oo,co=ao,uo="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",Y=co(uo);const[lo,fo]=D.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),Xe=new Uint32Array(80),Je=new Uint32Array(80);class Or extends Gi{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:f,Fl:h,Gh:d,Gl:p,Hh:g,Hl:m}=this;return[e,t,r,s,i,o,a,c,u,l,f,h,d,p,g,m]}set(e,t,r,s,i,o,a,c,u,l,f,h,d,p,g,m){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=f|0,this.Fl=h|0,this.Gh=d|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,t){for(let S=0;S<16;S++,t+=4)Xe[S]=e.getUint32(t),Je[S]=e.getUint32(t+=4);for(let S=16;S<80;S++){const T=Xe[S-15]|0,E=Je[S-15]|0,U=D.rotrSH(T,E,1)^D.rotrSH(T,E,8)^D.shrSH(T,E,7),C=D.rotrSL(T,E,1)^D.rotrSL(T,E,8)^D.shrSL(T,E,7),M=Xe[S-2]|0,te=Je[S-2]|0,Be=D.rotrSH(M,te,19)^D.rotrBH(M,te,61)^D.shrSH(M,te,6),Ze=D.rotrSL(M,te,19)^D.rotrBL(M,te,61)^D.shrSL(M,te,6),ze=D.add4L(C,Ze,Je[S-7],Je[S-16]),Et=D.add4H(ze,U,Be,Xe[S-7],Xe[S-16]);Xe[S]=Et|0,Je[S]=ze|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:f,El:h,Fh:d,Fl:p,Gh:g,Gl:m,Hh:k,Hl:b}=this;for(let S=0;S<80;S++){const T=D.rotrSH(f,h,14)^D.rotrSH(f,h,18)^D.rotrBH(f,h,41),E=D.rotrSL(f,h,14)^D.rotrSL(f,h,18)^D.rotrBL(f,h,41),U=f&d^~f&g,C=h&p^~h&m,M=D.add5L(b,E,C,fo[S],Je[S]),te=D.add5H(M,k,T,U,lo[S],Xe[S]),Be=M|0,Ze=D.rotrSH(r,s,28)^D.rotrBH(r,s,34)^D.rotrBH(r,s,39),ze=D.rotrSL(r,s,28)^D.rotrBL(r,s,34)^D.rotrBL(r,s,39),Et=r&i^r&a^i&a,Wr=s&o^s&c^o&c;k=g|0,b=m|0,g=d|0,m=p|0,d=f|0,p=h|0,{h:f,l:h}=D.add(u|0,l|0,te|0,Be|0),u=a|0,l=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const or=D.add3L(Be,ze,Wr);r=D.add3H(or,te,Ze,Et),s=or|0}({h:r,l:s}=D.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=D.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=D.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=D.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:f,l:h}=D.add(this.Eh|0,this.El|0,f|0,h|0),{h:d,l:p}=D.add(this.Fh|0,this.Fl|0,d|0,p|0),{h:g,l:m}=D.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:k,l:b}=D.add(this.Hh|0,this.Hl|0,k|0,b|0),this.set(r,s,i,o,a,c,u,l,f,h,d,p,g,m,k,b)}roundClean(){Xe.fill(0),Je.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class ho extends Or{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class po extends Or{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class go extends Or{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const yo=Tr(()=>new Or);Tr(()=>new ho);Tr(()=>new po);Tr(()=>new go);/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const ge=BigInt(0),G=BigInt(1),et=BigInt(2),mo=BigInt(8),Yn=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),ee=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:Yn,n:Yn,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),Fs=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),jt=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742");const wo=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),bo=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),vo=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),So=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class W{constructor(e,t,r,s){this.x=e,this.y=t,this.z=r,this.t=s}static fromAffine(e){if(!(e instanceof ue))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(ue.ZERO)?W.ZERO:new W(e.x,e.y,G,A(e.x*e.y))}static toAffineBatch(e){const t=Eo(e.map(r=>r.z));return e.map((r,s)=>r.toAffine(t[s]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){es(e);const{x:t,y:r,z:s}=this,{x:i,y:o,z:a}=e,c=A(t*a),u=A(i*s),l=A(r*a),f=A(o*s);return c===u&&l===f}negate(){return new W(A(-this.x),this.y,this.z,A(-this.t))}double(){const{x:e,y:t,z:r}=this,{a:s}=ee,i=A(e*e),o=A(t*t),a=A(et*A(r*r)),c=A(s*i),u=e+t,l=A(A(u*u)-i-o),f=c+o,h=f-a,d=c-o,p=A(l*h),g=A(f*d),m=A(l*d),k=A(h*f);return new W(p,g,k,m)}add(e){es(e);const{x:t,y:r,z:s,t:i}=this,{x:o,y:a,z:c,t:u}=e,l=A((r-t)*(a+o)),f=A((r+t)*(a-o)),h=A(f-l);if(h===ge)return this.double();const d=A(s*et*u),p=A(i*et*c),g=p+d,m=f+l,k=p-d,b=A(g*h),S=A(m*k),T=A(g*k),E=A(h*m);return new W(b,S,E,T)}subtract(e){return this.add(e.negate())}precomputeWindow(e){const t=1+256/e,r=[];let s=this,i=s;for(let o=0;o<t;o++){i=s,r.push(i);for(let a=1;a<2**(e-1);a++)i=i.add(s),r.push(i);s=i.double()}return r}wNAF(e,t){!t&&this.equals(W.BASE)&&(t=ue.BASE);const r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let s=t&&ln.get(t);s||(s=this.precomputeWindow(r),t&&r!==1&&(s=W.normalizeZ(s),ln.set(t,s)));let i=W.ZERO,o=W.BASE;const a=1+256/r,c=2**(r-1),u=BigInt(2**r-1),l=2**r,f=BigInt(r);for(let h=0;h<a;h++){const d=h*c;let p=Number(e&u);e>>=f,p>c&&(p-=l,e+=G);const g=d,m=d+Math.abs(p)-1,k=h%2!==0,b=p<0;p===0?o=o.add(Qn(k,s[g])):i=i.add(Qn(b,s[m]))}return W.normalizeZ([i,o])[0]}multiply(e,t){return this.wNAF(wr(e,ee.l),t)}multiplyUnsafe(e){let t=wr(e,ee.l,!1);const r=W.BASE,s=W.ZERO;if(t===ge)return s;if(this.equals(s)||t===G)return this;if(this.equals(r))return this.wNAF(t);let i=s,o=this;for(;t>ge;)t&G&&(i=i.add(o)),o=o.double(),t>>=G;return i}isSmallOrder(){return this.multiplyUnsafe(ee.h).equals(W.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(ee.l/et).double();return ee.l%et&&(e=e.add(this)),e.equals(W.ZERO)}toAffine(e){const{x:t,y:r,z:s}=this,i=this.equals(W.ZERO);e==null&&(e=i?mo:Lr(s));const o=A(t*e),a=A(r*e),c=A(s*e);if(i)return ue.ZERO;if(c!==G)throw new Error("invZ was invalid");return new ue(o,a)}fromRistrettoBytes(){Vr()}toRistrettoBytes(){Vr()}fromRistrettoHash(){Vr()}}W.BASE=new W(ee.Gx,ee.Gy,G,A(ee.Gx*ee.Gy));W.ZERO=new W(ge,G,G,ge);function Qn(n,e){const t=e.negate();return n?t:e}function es(n){if(!(n instanceof W))throw new TypeError("ExtendedPoint expected")}function Gr(n){if(!(n instanceof Oe))throw new TypeError("RistrettoPoint expected")}function Vr(){throw new Error("Legacy method: switch to RistrettoPoint")}class Oe{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){const{d:t}=ee,r=A(jt*e*e),s=A((r+G)*vo);let i=BigInt(-1);const o=A((i-t*r)*A(r+t));let{isValid:a,value:c}=Bn(s,o),u=A(c*e);Qe(u)||(u=A(-u)),a||(c=u),a||(i=r);const l=A(i*(r-G)*So-o),f=c*c,h=A((c+c)*o),d=A(l*wo),p=A(G-f),g=A(G+f);return new W(A(h*g),A(p*d),A(d*g),A(h*p))}static hashToCurve(e){e=ot(e,64);const t=Zr(e.slice(0,32)),r=this.calcElligatorRistrettoMap(t),s=Zr(e.slice(32,64)),i=this.calcElligatorRistrettoMap(s);return new Oe(r.add(i))}static fromHex(e){e=ot(e,32);const{a:t,d:r}=ee,s="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=Zr(e);if(!Io(Zt(i),e)||Qe(i))throw new Error(s);const o=A(i*i),a=A(G+t*o),c=A(G-t*o),u=A(a*a),l=A(c*c),f=A(t*r*u-l),{isValid:h,value:d}=rs(A(f*l)),p=A(d*c),g=A(d*p*f);let m=A((i+i)*p);Qe(m)&&(m=A(-m));const k=A(a*g),b=A(m*k);if(!h||Qe(b)||k===ge)throw new Error(s);return new Oe(new W(m,k,G,b))}toRawBytes(){let{x:e,y:t,z:r,t:s}=this.ep;const i=A(A(r+t)*A(r-t)),o=A(e*t),a=A(o*o),{value:c}=rs(A(i*a)),u=A(c*i),l=A(c*o),f=A(u*l*s);let h;if(Qe(s*f)){let p=A(t*jt),g=A(e*jt);e=p,t=g,h=A(u*bo)}else h=l;Qe(e*f)&&(t=A(-t));let d=A((r-t)*h);return Qe(d)&&(d=A(-d)),Zt(d)}toHex(){return er(this.toRawBytes())}toString(){return this.toHex()}equals(e){Gr(e);const t=this.ep,r=e.ep,s=A(t.x*r.y)===A(t.y*r.x),i=A(t.y*r.y)===A(t.x*r.x);return s||i}add(e){return Gr(e),new Oe(this.ep.add(e.ep))}subtract(e){return Gr(e),new Oe(this.ep.subtract(e.ep))}multiply(e){return new Oe(this.ep.multiply(e))}multiplyUnsafe(e){return new Oe(this.ep.multiplyUnsafe(e))}}Oe.BASE=new Oe(W.BASE);Oe.ZERO=new Oe(W.ZERO);const ln=new WeakMap;let ue=class fn{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,ln.delete(this)}static fromHex(e,t=!0){const{d:r,P:s}=ee;e=ot(e,32);const i=e.slice();i[31]=e[31]&-129;const o=tr(i);if(t&&o>=s)throw new Error("Expected 0 < hex < P");if(!t&&o>=Fs)throw new Error("Expected 0 < hex < 2**256");const a=A(o*o),c=A(a-G),u=A(r*a+G);let{isValid:l,value:f}=Bn(c,u);if(!l)throw new Error("Point.fromHex: invalid y coordinate");const h=(f&G)===G;return(e[31]&128)!==0!==h&&(f=A(-f)),new fn(f,o)}static async fromPrivateKey(e){return(await Hs(e)).point}toRawBytes(){const e=Zt(this.y);return e[31]|=this.x&G?128:0,e}toHex(){return er(this.toRawBytes())}toX25519(){const{y:e}=this,t=A((G+e)*Lr(G-e));return Zt(t)}isTorsionFree(){return W.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new fn(A(-this.x),this.y)}add(e){return W.fromAffine(this).add(W.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return W.fromAffine(this).multiply(e,this).toAffine()}};ue.BASE=new ue(ee.Gx,ee.Gy);ue.ZERO=new ue(ge,G);let dn=class Ks{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){const t=ot(e,64),r=ue.fromHex(t.slice(0,32),!1),s=tr(t.slice(32,64));return new Ks(r,s)}assertValidity(){const{r:e,s:t}=this;if(!(e instanceof ue))throw new Error("Expected Point instance");return wr(t,ee.l,!1),this}toRawBytes(){const e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Zt(this.s),32),e}toHex(){return er(this.toRawBytes())}};function ts(...n){if(!n.every(r=>r instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(n.length===1)return n[0];const e=n.reduce((r,s)=>r+s.length,0),t=new Uint8Array(e);for(let r=0,s=0;r<n.length;r++){const i=n[r];t.set(i,s),s+=i.length}return t}const ko=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function er(n){if(!(n instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=ko[n[t]];return e}function _n(n){if(typeof n!="string")throw new TypeError("hexToBytes: expected string, got "+typeof n);if(n.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(n.length/2);for(let t=0;t<e.length;t++){const r=t*2,s=n.slice(r,r+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[t]=i}return e}function Ms(n){const t=n.toString(16).padStart(64,"0");return _n(t)}function Zt(n){return Ms(n).reverse()}function Qe(n){return(A(n)&G)===G}function tr(n){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+er(Uint8Array.from(n).reverse()))}const Ao=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Zr(n){return A(tr(n)&Ao)}function A(n,e=ee.P){const t=n%e;return t>=ge?t:e+t}function Lr(n,e=ee.P){if(n===ge||e<=ge)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=A(n,e),r=e,s=ge,i=G;for(;t!==ge;){const a=r/t,c=r%t,u=s-i*a;r=t,t=c,s=i,i=u}if(r!==G)throw new Error("invert: does not exist");return A(s,e)}function Eo(n,e=ee.P){const t=new Array(n.length),r=n.reduce((i,o,a)=>o===ge?i:(t[a]=i,A(i*o,e)),G),s=Lr(r,e);return n.reduceRight((i,o,a)=>o===ge?i:(t[a]=A(i*t[a],e),A(i*o,e)),s),t}function $e(n,e){const{P:t}=ee;let r=n;for(;e-- >ge;)r*=r,r%=t;return r}function xo(n){const{P:e}=ee,t=BigInt(5),r=BigInt(10),s=BigInt(20),i=BigInt(40),o=BigInt(80),c=n*n%e*n%e,u=$e(c,et)*c%e,l=$e(u,G)*n%e,f=$e(l,t)*l%e,h=$e(f,r)*f%e,d=$e(h,s)*h%e,p=$e(d,i)*d%e,g=$e(p,o)*p%e,m=$e(g,o)*p%e,k=$e(m,r)*f%e;return{pow_p_5_8:$e(k,et)*n%e,b2:c}}function Bn(n,e){const t=A(e*e*e),r=A(t*t*e),s=xo(n*r).pow_p_5_8;let i=A(n*t*s);const o=A(e*i*i),a=i,c=A(i*jt),u=o===n,l=o===A(-n),f=o===A(-n*jt);return u&&(i=a),(l||f)&&(i=c),Qe(i)&&(i=A(-i)),{isValid:u||l,value:i}}function rs(n){return Bn(G,n)}function mr(n){return A(tr(n),ee.l)}function Io(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function ot(n,e){const t=n instanceof Uint8Array?Uint8Array.from(n):_n(n);if(typeof e=="number"&&t.length!==e)throw new Error(`Expected ${e} bytes`);return t}function wr(n,e,t=!0){if(!e)throw new TypeError("Specify max value");if(typeof n=="number"&&Number.isSafeInteger(n)&&(n=BigInt(n)),typeof n=="bigint"&&n<e){if(t){if(ge<n)return n}else if(ge<=n)return n}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function _o(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}function qs(n){if(n=typeof n=="bigint"||typeof n=="number"?Ms(wr(n,Fs)):ot(n),n.length!==32)throw new Error("Expected 32 bytes");return n}function Ds(n){const e=_o(n.slice(0,32)),t=n.slice(32,64),r=mr(e),s=ue.BASE.multiply(r),i=s.toRawBytes();return{head:e,prefix:t,scalar:r,point:s,pointBytes:i}}let Wt;function br(...n){if(typeof Wt!="function")throw new Error("utils.sha512Sync must be set to use sync methods");return Wt(...n)}async function Hs(n){return Ds(await mt.sha512(qs(n)))}function Rn(n){return Ds(br(qs(n)))}function Bo(n){return Rn(n).pointBytes}function Ro(n,e){n=ot(n);const{prefix:t,scalar:r,pointBytes:s}=Rn(e),i=mr(br(t,n)),o=ue.BASE.multiply(i),a=mr(br(o.toRawBytes(),s,n)),c=A(i+a*r,ee.l);return new dn(o,c).toRawBytes()}function Co(n,e,t){e=ot(e),t instanceof ue||(t=ue.fromHex(t,!1));const{r,s}=n instanceof dn?n.assertValidity():dn.fromHex(n),i=W.BASE.multiplyUnsafe(s);return{r,s,SB:i,pub:t,msg:e}}function To(n,e,t,r){const s=mr(r),i=W.fromAffine(n).multiplyUnsafe(s);return W.fromAffine(e).add(i).subtract(t).multiplyUnsafe(ee.h).equals(W.ZERO)}function Po(n,e,t){const{r,SB:s,msg:i,pub:o}=Co(n,e,t),a=br(r.toRawBytes(),o.toRawBytes(),i);return To(o,r,s,a)}const Cn={getExtendedPublicKey:Rn,getPublicKey:Bo,sign:Ro,verify:Po};ue.BASE._setWindowSize(8);const Ye={node:Us,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},mt={bytesToHex:er,hexToBytes:_n,concatBytes:ts,getExtendedPublicKey:Hs,mod:A,invert:Lr,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:n=>{if(n=ot(n),n.length<40||n.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return A(tr(n),ee.l-G)+G},randomBytes:(n=32)=>{if(Ye.web)return Ye.web.getRandomValues(new Uint8Array(n));if(Ye.node){const{randomBytes:e}=Ye.node;return new Uint8Array(e(n).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>mt.randomBytes(32),sha512:async(...n)=>{const e=ts(...n);if(Ye.web){const t=await Ye.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(t)}else{if(Ye.node)return Uint8Array.from(Ye.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(n=8,e=ue.BASE){const t=e.equals(ue.BASE)?e:new ue(e.x,e.y);return t._setWindowSize(n),t.multiply(et),t},sha512Sync:void 0};Object.defineProperties(mt,{sha512Sync:{configurable:!1,get(){return Wt},set(n){Wt||(Wt=n)}}});var pe={};function We(n,e,t){return e<=n&&n<=t}function Ur(n){if(n===void 0)return{};if(n===Object(n))return n;throw TypeError("Could not convert argument to dictionary")}function Oo(n){for(var e=String(n),t=e.length,r=0,s=[];r<t;){var i=e.charCodeAt(r);if(i<55296||i>57343)s.push(i);else if(56320<=i&&i<=57343)s.push(65533);else if(55296<=i&&i<=56319)if(r===t-1)s.push(65533);else{var o=n.charCodeAt(r+1);if(56320<=o&&o<=57343){var a=i&1023,c=o&1023;s.push(65536+(a<<10)+c),r+=1}else s.push(65533)}r+=1}return s}function Lo(n){for(var e="",t=0;t<n.length;++t){var r=n[t];r<=65535?e+=String.fromCharCode(r):(r-=65536,e+=String.fromCharCode((r>>10)+55296,(r&1023)+56320))}return e}var vr=-1;function Tn(n){this.tokens=[].slice.call(n)}Tn.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():vr},prepend:function(n){if(Array.isArray(n))for(var e=n;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(n)},push:function(n){if(Array.isArray(n))for(var e=n;e.length;)this.tokens.push(e.shift());else this.tokens.push(n)}};var Pt=-1;function Xr(n,e){if(n)throw TypeError("Decoder error");return e||65533}var Sr="utf-8";function kr(n,e){if(!(this instanceof kr))return new kr(n,e);if(n=n!==void 0?String(n).toLowerCase():Sr,n!==Sr)throw new Error("Encoding not supported. Only utf-8 is supported");e=Ur(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=!!e.fatal,this._ignoreBOM=!!e.ignoreBOM,Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}kr.prototype={decode:function(e,t){var r;typeof e=="object"&&e instanceof ArrayBuffer?r=new Uint8Array(e):typeof e=="object"&&"buffer"in e&&e.buffer instanceof ArrayBuffer?r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):r=new Uint8Array(0),t=Ur(t),this._streaming||(this._decoder=new Uo({fatal:this._fatal}),this._BOMseen=!1),this._streaming=!!t.stream;for(var s=new Tn(r),i=[],o;!s.endOfStream()&&(o=this._decoder.handler(s,s.read()),o!==Pt);)o!==null&&(Array.isArray(o)?i.push.apply(i,o):i.push(o));if(!this._streaming){do{if(o=this._decoder.handler(s,s.read()),o===Pt)break;o!==null&&(Array.isArray(o)?i.push.apply(i,o):i.push(o))}while(!s.endOfStream());this._decoder=null}return i.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(i[0]===65279?(this._BOMseen=!0,i.shift()):this._BOMseen=!0),Lo(i)}};function Ar(n,e){if(!(this instanceof Ar))return new Ar(n,e);if(n=n!==void 0?String(n).toLowerCase():Sr,n!==Sr)throw new Error("Encoding not supported. Only utf-8 is supported");e=Ur(e),this._streaming=!1,this._encoder=null,this._options={fatal:!!e.fatal},Object.defineProperty(this,"encoding",{value:"utf-8"})}Ar.prototype={encode:function(e,t){e=e?String(e):"",t=Ur(t),this._streaming||(this._encoder=new No(this._options)),this._streaming=!!t.stream;for(var r=[],s=new Tn(Oo(e)),i;!s.endOfStream()&&(i=this._encoder.handler(s,s.read()),i!==Pt);)Array.isArray(i)?r.push.apply(r,i):r.push(i);if(!this._streaming){for(;i=this._encoder.handler(s,s.read()),i!==Pt;)Array.isArray(i)?r.push.apply(r,i):r.push(i);this._encoder=null}return new Uint8Array(r)}};function Uo(n){var e=n.fatal,t=0,r=0,s=0,i=128,o=191;this.handler=function(a,c){if(c===vr&&s!==0)return s=0,Xr(e);if(c===vr)return Pt;if(s===0){if(We(c,0,127))return c;if(We(c,194,223))s=1,t=c-192;else if(We(c,224,239))c===224&&(i=160),c===237&&(o=159),s=2,t=c-224;else if(We(c,240,244))c===240&&(i=144),c===244&&(o=143),s=3,t=c-240;else return Xr(e);return t=t<<6*s,null}if(!We(c,i,o))return t=s=r=0,i=128,o=191,a.prepend(c),Xr(e);if(i=128,o=191,r+=1,t+=c-128<<6*(s-r),r!==s)return null;var u=t;return t=s=r=0,u}}function No(n){n.fatal,this.handler=function(e,t){if(t===vr)return Pt;if(We(t,0,127))return t;var r,s;We(t,128,2047)?(r=1,s=192):We(t,2048,65535)?(r=2,s=224):We(t,65536,1114111)&&(r=3,s=240);for(var i=[(t>>6*r)+s];r>0;){var o=t>>6*(r-1);i.push(128|o&63),r-=1}return i}}const $o=Object.freeze(Object.defineProperty({__proto__:null,TextDecoder:kr,TextEncoder:Ar},Symbol.toStringTag,{value:"Module"})),Fo=Ve($o);var Ko=Me&&Me.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Mo=Me&&Me.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),qe=Me&&Me.__decorate||function(n,e,t,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i},qo=Me&&Me.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.hasOwnProperty.call(n,t)&&Ko(e,n,t);return Mo(e,n),e},zs=Me&&Me.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(pe,"__esModule",{value:!0});var js=pe.deserializeUnchecked=Js=pe.deserialize=Xs=pe.serialize=pe.BinaryReader=pe.BinaryWriter=pe.BorshError=pe.baseDecode=pe.baseEncode=void 0;const rt=zs(Vi),Ws=zs(Y),Do=qo(Fo),Ho=typeof TextDecoder!="function"?Do.TextDecoder:TextDecoder,zo=new Ho("utf-8",{fatal:!0});function jo(n){return typeof n=="string"&&(n=L.from(n,"utf8")),Ws.default.encode(L.from(n))}pe.baseEncode=jo;function Wo(n){return L.from(Ws.default.decode(n))}pe.baseDecode=Wo;const Jr=1024;class ve extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}pe.BorshError=ve;class Gs{constructor(){this.buf=L.alloc(Jr),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=L.concat([this.buf,L.alloc(Jr)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(L.from(new rt.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(L.from(new rt.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(L.from(new rt.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(L.from(new rt.default(e).toArray("le",64)))}writeBuffer(e){this.buf=L.concat([L.from(this.buf.subarray(0,this.length)),e,L.alloc(Jr)]),this.length+=e.length}writeString(e){this.maybeResize();const t=L.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(L.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const r of e)this.maybeResize(),t(r)}toArray(){return this.buf.subarray(0,this.length)}}pe.BinaryWriter=Gs;function De(n,e,t){const r=t.value;t.value=function(...s){try{return r.apply(this,s)}catch(i){if(i instanceof RangeError){const o=i.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(o)>=0)throw new ve("Reached the end of buffer when deserializing")}throw i}}}class _e{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new rt.default(e,"le")}readU128(){const e=this.readBuffer(16);return new rt.default(e,"le")}readU256(){const e=this.readBuffer(32);return new rt.default(e,"le")}readU512(){const e=this.readBuffer(64);return new rt.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new ve(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return zo.decode(t)}catch(r){throw new ve(`Error decoding UTF-8 string: ${r}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),r=Array();for(let s=0;s<t;++s)r.push(e());return r}}qe([De],_e.prototype,"readU8",null);qe([De],_e.prototype,"readU16",null);qe([De],_e.prototype,"readU32",null);qe([De],_e.prototype,"readU64",null);qe([De],_e.prototype,"readU128",null);qe([De],_e.prototype,"readU256",null);qe([De],_e.prototype,"readU512",null);qe([De],_e.prototype,"readString",null);qe([De],_e.prototype,"readFixedArray",null);qe([De],_e.prototype,"readArray",null);pe.BinaryReader=_e;function Vs(n){return n.charAt(0).toUpperCase()+n.slice(1)}function lt(n,e,t,r,s){try{if(typeof r=="string")s[`write${Vs(r)}`](t);else if(r instanceof Array)if(typeof r[0]=="number"){if(t.length!==r[0])throw new ve(`Expecting byte array of length ${r[0]}, but got ${t.length} bytes`);s.writeFixedArray(t)}else if(r.length===2&&typeof r[1]=="number"){if(t.length!==r[1])throw new ve(`Expecting byte array of length ${r[1]}, but got ${t.length} bytes`);for(let i=0;i<r[1];i++)lt(n,null,t[i],r[0],s)}else s.writeArray(t,i=>{lt(n,e,i,r[0],s)});else if(r.kind!==void 0)switch(r.kind){case"option":{t==null?s.writeU8(0):(s.writeU8(1),lt(n,e,t,r.type,s));break}case"map":{s.writeU32(t.size),t.forEach((i,o)=>{lt(n,e,o,r.key,s),lt(n,e,i,r.value,s)});break}default:throw new ve(`FieldType ${r} unrecognized`)}else Zs(n,t,s)}catch(i){throw i instanceof ve&&i.addToFieldPath(e),i}}function Zs(n,e,t){if(typeof e.borshSerialize=="function"){e.borshSerialize(t);return}const r=n.get(e.constructor);if(!r)throw new ve(`Class ${e.constructor.name} is missing in schema`);if(r.kind==="struct")r.fields.map(([s,i])=>{lt(n,s,e[s],i,t)});else if(r.kind==="enum"){const s=e[r.field];for(let i=0;i<r.values.length;++i){const[o,a]=r.values[i];if(o===s){t.writeU8(i),lt(n,o,e[o],a,t);break}}}else throw new ve(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function Go(n,e,t=Gs){const r=new t;return Zs(n,e,r),r.toArray()}var Xs=pe.serialize=Go;function ft(n,e,t,r){try{if(typeof t=="string")return r[`read${Vs(t)}`]();if(t instanceof Array){if(typeof t[0]=="number")return r.readFixedArray(t[0]);if(typeof t[1]=="number"){const s=[];for(let i=0;i<t[1];i++)s.push(ft(n,null,t[0],r));return s}else return r.readArray(()=>ft(n,e,t[0],r))}if(t.kind==="option")return r.readU8()?ft(n,e,t.type,r):void 0;if(t.kind==="map"){let s=new Map;const i=r.readU32();for(let o=0;o<i;o++){const a=ft(n,e,t.key,r),c=ft(n,e,t.value,r);s.set(a,c)}return s}return Pn(n,t,r)}catch(s){throw s instanceof ve&&s.addToFieldPath(e),s}}function Pn(n,e,t){if(typeof e.borshDeserialize=="function")return e.borshDeserialize(t);const r=n.get(e);if(!r)throw new ve(`Class ${e.name} is missing in schema`);if(r.kind==="struct"){const s={};for(const[i,o]of n.get(e).fields)s[i]=ft(n,i,o,t);return new e(s)}if(r.kind==="enum"){const s=t.readU8();if(s>=r.values.length)throw new ve(`Enum index: ${s} is out of range`);const[i,o]=r.values[s],a=ft(n,i,o,t);return new e({[i]:a})}throw new ve(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function Vo(n,e,t,r=_e){const s=new r(t),i=Pn(n,e,s);if(s.offset<t.length)throw new ve(`Unexpected ${t.length-s.offset} bytes after deserialized data`);return i}var Js=pe.deserialize=Vo;function Zo(n,e,t,r=_e){const s=new r(t);return Pn(n,e,s)}js=pe.deserializeUnchecked=Zo;var w={};Object.defineProperty(w,"__esModule",{value:!0});w.s16=w.s8=w.nu64be=w.u48be=w.u40be=w.u32be=w.u24be=w.u16be=he=w.nu64=w.u48=w.u40=F=w.u32=w.u24=Ce=w.u16=X=w.u8=ht=w.offset=w.greedy=w.Constant=w.UTF8=w.CString=w.Blob=w.Boolean=w.BitField=w.BitStructure=w.VariantLayout=w.Union=w.UnionLayoutDiscriminator=w.UnionDiscriminator=w.Structure=w.Sequence=w.DoubleBE=w.Double=w.FloatBE=w.Float=w.NearInt64BE=w.NearInt64=w.NearUInt64BE=w.NearUInt64=w.IntBE=w.Int=w.UIntBE=w.UInt=w.OffsetLayout=w.GreedyCount=w.ExternalLayout=w.bindConstructorLayout=w.nameWithProperty=w.Layout=w.uint8ArrayToBuffer=w.checkUint8Array=void 0;w.constant=w.utf8=w.cstr=ie=w.blob=w.unionLayoutDiscriminator=w.union=Se=w.seq=w.bits=N=w.struct=w.f64be=w.f64=w.f32be=w.f32=w.ns64be=w.s48be=w.s40be=w.s32be=w.s24be=w.s16be=Ie=w.ns64=w.s48=w.s40=w.s32=w.s24=void 0;const On=Zi;function $t(n){if(!(n instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}w.checkUint8Array=$t;function V(n){return $t(n),On.Buffer.from(n.buffer,n.byteOffset,n.length)}w.uint8ArrayToBuffer=V;class Q{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}w.Layout=Q;function Ln(n,e){return e.property?n+"["+e.property+"]":n}w.nameWithProperty=Ln;function Xo(n,e){if(typeof n!="function")throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(n,"layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof Q))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(e,"boundConstructor_"))throw new Error("layout is already bound to a constructor");n.layout_=e,e.boundConstructor_=n,e.makeDestinationObject=()=>new n,Object.defineProperty(n.prototype,"encode",{value(t,r){return e.encode(this,t,r)},writable:!0}),Object.defineProperty(n,"decode",{value(t,r){return e.decode(t,r)},writable:!0})}w.bindConstructorLayout=Xo;class ke extends Q{isCount(){throw new Error("ExternalLayout is abstract")}}w.ExternalLayout=ke;class Ys extends ke{constructor(e=1,t){if(!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(e,t=0){$t(e);const r=e.length-t;return Math.floor(r/this.elementSpan)}encode(e,t,r){return 0}}w.GreedyCount=Ys;class Un extends ke{constructor(e,t=0,r){if(!(e instanceof Q))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof Le||this.layout instanceof Ue}decode(e,t=0){return this.layout.decode(e,t+this.offset)}encode(e,t,r=0){return this.layout.encode(e,t,r+this.offset)}}w.OffsetLayout=Un;class Le extends Q{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return V(e).readUIntLE(t,this.span)}encode(e,t,r=0){return V(t).writeUIntLE(e,r,this.span),this.span}}w.UInt=Le;class Ue extends Q{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return V(e).readUIntBE(t,this.span)}encode(e,t,r=0){return V(t).writeUIntBE(e,r,this.span),this.span}}w.UIntBE=Ue;class vt extends Q{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return V(e).readIntLE(t,this.span)}encode(e,t,r=0){return V(t).writeIntLE(e,r,this.span),this.span}}w.Int=vt;class Ft extends Q{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return V(e).readIntBE(t,this.span)}encode(e,t,r=0){return V(t).writeIntBE(e,r,this.span),this.span}}w.IntBE=Ft;const hn=Math.pow(2,32);function Nr(n){const e=Math.floor(n/hn),t=n-e*hn;return{hi32:e,lo32:t}}function $r(n,e){return n*hn+e}class Qs extends Q{constructor(e){super(8,e)}decode(e,t=0){const r=V(e),s=r.readUInt32LE(t),i=r.readUInt32LE(t+4);return $r(i,s)}encode(e,t,r=0){const s=Nr(e),i=V(t);return i.writeUInt32LE(s.lo32,r),i.writeUInt32LE(s.hi32,r+4),8}}w.NearUInt64=Qs;class ei extends Q{constructor(e){super(8,e)}decode(e,t=0){const r=V(e),s=r.readUInt32BE(t),i=r.readUInt32BE(t+4);return $r(s,i)}encode(e,t,r=0){const s=Nr(e),i=V(t);return i.writeUInt32BE(s.hi32,r),i.writeUInt32BE(s.lo32,r+4),8}}w.NearUInt64BE=ei;class ti extends Q{constructor(e){super(8,e)}decode(e,t=0){const r=V(e),s=r.readUInt32LE(t),i=r.readInt32LE(t+4);return $r(i,s)}encode(e,t,r=0){const s=Nr(e),i=V(t);return i.writeUInt32LE(s.lo32,r),i.writeInt32LE(s.hi32,r+4),8}}w.NearInt64=ti;class ri extends Q{constructor(e){super(8,e)}decode(e,t=0){const r=V(e),s=r.readInt32BE(t),i=r.readUInt32BE(t+4);return $r(s,i)}encode(e,t,r=0){const s=Nr(e),i=V(t);return i.writeInt32BE(s.hi32,r),i.writeUInt32BE(s.lo32,r+4),8}}w.NearInt64BE=ri;class ni extends Q{constructor(e){super(4,e)}decode(e,t=0){return V(e).readFloatLE(t)}encode(e,t,r=0){return V(t).writeFloatLE(e,r),4}}w.Float=ni;class si extends Q{constructor(e){super(4,e)}decode(e,t=0){return V(e).readFloatBE(t)}encode(e,t,r=0){return V(t).writeFloatBE(e,r),4}}w.FloatBE=si;class ii extends Q{constructor(e){super(8,e)}decode(e,t=0){return V(e).readDoubleLE(t)}encode(e,t,r=0){return V(t).writeDoubleLE(e,r),8}}w.Double=ii;class oi extends Q{constructor(e){super(8,e)}decode(e,t=0){return V(e).readDoubleBE(t)}encode(e,t,r=0){return V(t).writeDoubleBE(e,r),8}}w.DoubleBE=oi;class ai extends Q{constructor(e,t,r){if(!(e instanceof Q))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof ke&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let s=-1;!(t instanceof ke)&&0<e.span&&(s=t*e.span),super(s,r),this.elementLayout=e,this.count=t}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0,s=this.count;if(s instanceof ke&&(s=s.decode(e,t)),0<this.elementLayout.span)r=s*this.elementLayout.span;else{let i=0;for(;i<s;)r+=this.elementLayout.getSpan(e,t+r),++i}return r}decode(e,t=0){const r=[];let s=0,i=this.count;for(i instanceof ke&&(i=i.decode(e,t));s<i;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),s+=1;return r}encode(e,t,r=0){const s=this.elementLayout,i=e.reduce((o,a)=>o+s.encode(a,t,r+o),0);return this.count instanceof ke&&this.count.encode(e.length,t,r),i}}w.Sequence=ai;class ci extends Q{constructor(e,t,r){if(!(Array.isArray(e)&&e.reduce((i,o)=>i&&o instanceof Q,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&r===void 0&&(r=t,t=void 0);for(const i of e)if(0>i.span&&i.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let s=-1;try{s=e.reduce((i,o)=>i+o.getSpan(),0)}catch{}super(s,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;try{r=this.fields.reduce((s,i)=>{const o=i.getSpan(e,t);return t+=o,s+o},0)}catch{throw new RangeError("indeterminate span")}return r}decode(e,t=0){$t(e);const r=this.makeDestinationObject();for(const s of this.fields)if(s.property!==void 0&&(r[s.property]=s.decode(e,t)),t+=s.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return r}encode(e,t,r=0){const s=r;let i=0,o=0;for(const a of this.fields){let c=a.span;if(o=0<c?c:0,a.property!==void 0){const u=e[a.property];u!==void 0&&(o=a.encode(u,t,r),0>c&&(c=a.getSpan(t,r)))}i=r,r+=c}return i+o-s}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)r.property!==void 0&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}}w.Structure=ci;class Nn{constructor(e){this.property=e}decode(e,t){throw new Error("UnionDiscriminator is abstract")}encode(e,t,r){throw new Error("UnionDiscriminator is abstract")}}w.UnionDiscriminator=Nn;class Er extends Nn{constructor(e,t){if(!(e instanceof ke&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,r){return this.layout.encode(e,t,r)}}w.UnionLayoutDiscriminator=Er;class $n extends Q{constructor(e,t,r){let s;if(e instanceof Le||e instanceof Ue)s=new Er(new Un(e));else if(e instanceof ke&&e.isCount())s=new Er(e);else if(e instanceof Nn)s=e;else throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof Q))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let i=-1;t&&(i=t.span,0<=i&&(e instanceof Le||e instanceof Ue)&&(i+=s.layout.span)),super(i,r),this.discriminator=s,this.usesPrefixDiscriminator=e instanceof Le||e instanceof Ue,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(a){return o(a)},this.configGetSourceVariant=function(a){o=a.bind(this)}}getSpan(e,t=0){if(0<=this.span)return this.span;const r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}defaultGetSourceVariant(e){if(Object.prototype.hasOwnProperty.call(e,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(e,this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||t.property&&Object.prototype.hasOwnProperty.call(e,t.property)))return t}else for(const t in this.registry){const r=this.registry[t];if(r.property&&Object.prototype.hasOwnProperty.call(e,r.property))return r}throw new Error("unable to infer src variant")}decode(e,t=0){let r;const s=this.discriminator,i=s.decode(e,t),o=this.registry[i];if(o===void 0){const a=this.defaultLayout;let c=0;this.usesPrefixDiscriminator&&(c=s.layout.span),r=this.makeDestinationObject(),r[s.property]=i,r[a.property]=a.decode(e,t+c)}else r=o.decode(e,t);return r}encode(e,t,r=0){const s=this.getSourceVariant(e);if(s===void 0){const i=this.discriminator,o=this.defaultLayout;let a=0;return this.usesPrefixDiscriminator&&(a=i.layout.span),i.encode(e[i.property],t,r),a+o.encode(e[o.property],t,r+a)}return s.encode(e,t,r)}addVariant(e,t,r){const s=new ui(this,e,t,r);return this.registry[e]=s,s}getVariant(e,t=0){let r;return e instanceof Uint8Array?r=this.discriminator.decode(e,t):r=e,this.registry[r]}}w.Union=$n;class ui extends Q{constructor(e,t,r,s){if(!(e instanceof $n))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof r=="string"&&s===void 0&&(s=r,r=null),r){if(!(r instanceof Q))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=r.span&&r.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof s!="string")throw new TypeError("variant must have a String property")}let i=e.span;0>e.span&&(i=r?r.span:0,0<=i&&e.usesPrefixDiscriminator&&(i+=e.discriminator.layout.span)),super(i,s),this.union=e,this.variant=t,this.layout=r||null}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span);let s=0;return this.layout&&(s=this.layout.getSpan(e,t+r)),r+s}decode(e,t=0){const r=this.makeDestinationObject();if(this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let s=0;return this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+s):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(e,t,r=0){let s=0;if(this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(e,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);let i=s;if(this.layout&&(this.layout.encode(e[this.property],t,r+s),i+=this.layout.getSpan(t,r+s),0<=this.union.span&&i>this.union.span))throw new Error("encoded variant overruns containing union");return i}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}w.VariantLayout=ui;function xt(n){return 0>n&&(n+=4294967296),n}class Fn extends Q{constructor(e,t,r){if(!(e instanceof Le||e instanceof Ue))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof t=="string"&&r===void 0&&(r=t,t=!1),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,r),this.word=e,this.msb=!!t,this.fields=[];let s=0;this._packedSetValue=function(i){return s=xt(i),this},this._packedGetValue=function(){return s}}decode(e,t=0){const r=this.makeDestinationObject(),s=this.word.decode(e,t);this._packedSetValue(s);for(const i of this.fields)i.property!==void 0&&(r[i.property]=i.decode(e));return r}encode(e,t,r=0){const s=this.word.decode(t,r);this._packedSetValue(s);for(const i of this.fields)if(i.property!==void 0){const o=e[i.property];o!==void 0&&i.encode(o)}return this.word.encode(this._packedGetValue(),t,r)}addField(e,t){const r=new Kn(this,e,t);return this.fields.push(r),r}addBoolean(e){const t=new li(this,e);return this.fields.push(t),t}fieldFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}}w.BitStructure=Fn;class Kn{constructor(e,t,r){if(!(e instanceof Fn))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const s=8*e.span,i=e.fields.reduce((o,a)=>o+a.bits,0);if(t+i>s)throw new Error("bits too long for span remainder ("+(s-i)+" of "+s+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,t===32&&(this.valueMask=4294967295),this.start=i,this.container.msb&&(this.start=s-i-t),this.wordMask=xt(this.valueMask<<this.start),this.property=r}decode(e,t){const r=this.container._packedGetValue();return xt(r&this.wordMask)>>>this.start}encode(e){if(typeof e!="number"||!Number.isInteger(e)||e!==xt(e&this.valueMask))throw new TypeError(Ln("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),r=xt(e<<this.start);this.container._packedSetValue(xt(t&~this.wordMask)|r)}}w.BitField=Kn;let li=class extends Kn{constructor(e,t){super(e,1,t)}decode(e,t){return!!super.decode(e,t)}encode(e){typeof e=="boolean"&&(e=+e),super.encode(e)}};w.Boolean=li;class fi extends Q{constructor(e,t){if(!(e instanceof ke&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof ke||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t=0){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),V(e).slice(t,t+r)}encode(e,t,r){let s=this.length;if(this.length instanceof ke&&(s=e.length),!(e instanceof Uint8Array&&s===e.length))throw new TypeError(Ln("Blob.encode",this)+" requires (length "+s+") Uint8Array as src");if(r+s>t.length)throw new RangeError("encoding overruns Uint8Array");const i=V(e);return V(t).write(i.toString("hex"),r,s,"hex"),this.length instanceof ke&&this.length.encode(s,t,r),s}}w.Blob=fi;class di extends Q{constructor(e){super(-1,e)}getSpan(e,t=0){$t(e);let r=t;for(;r<e.length&&e[r]!==0;)r+=1;return 1+r-t}decode(e,t=0){const r=this.getSpan(e,t);return V(e).slice(t,t+r-1).toString("utf-8")}encode(e,t,r=0){typeof e!="string"&&(e=String(e));const s=On.Buffer.from(e,"utf8"),i=s.length;if(r+i>t.length)throw new RangeError("encoding overruns Buffer");const o=V(t);return s.copy(o,r),o[r+i]=0,i+1}}w.CString=di;class hi extends Q{constructor(e,t){if(typeof e=="string"&&t===void 0&&(t=e,e=void 0),e===void 0)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(e,t=0){return $t(e),e.length-t}decode(e,t=0){const r=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<r)throw new RangeError("text length exceeds maxSpan");return V(e).slice(t,t+r).toString("utf-8")}encode(e,t,r=0){typeof e!="string"&&(e=String(e));const s=On.Buffer.from(e,"utf8"),i=s.length;if(0<=this.maxSpan&&this.maxSpan<i)throw new RangeError("text length exceeds maxSpan");if(r+i>t.length)throw new RangeError("encoding overruns Buffer");return s.copy(V(t),r),i}}w.UTF8=hi;class pi extends Q{constructor(e,t){super(0,t),this.value=e}decode(e,t){return this.value}encode(e,t,r){return 0}}w.Constant=pi;w.greedy=(n,e)=>new Ys(n,e);var ht=w.offset=(n,e,t)=>new Un(n,e,t),X=w.u8=n=>new Le(1,n),Ce=w.u16=n=>new Le(2,n);w.u24=n=>new Le(3,n);var F=w.u32=n=>new Le(4,n);w.u40=n=>new Le(5,n);w.u48=n=>new Le(6,n);var he=w.nu64=n=>new Qs(n);w.u16be=n=>new Ue(2,n);w.u24be=n=>new Ue(3,n);w.u32be=n=>new Ue(4,n);w.u40be=n=>new Ue(5,n);w.u48be=n=>new Ue(6,n);w.nu64be=n=>new ei(n);w.s8=n=>new vt(1,n);w.s16=n=>new vt(2,n);w.s24=n=>new vt(3,n);w.s32=n=>new vt(4,n);w.s40=n=>new vt(5,n);w.s48=n=>new vt(6,n);var Ie=w.ns64=n=>new ti(n);w.s16be=n=>new Ft(2,n);w.s24be=n=>new Ft(3,n);w.s32be=n=>new Ft(4,n);w.s40be=n=>new Ft(5,n);w.s48be=n=>new Ft(6,n);w.ns64be=n=>new ri(n);w.f32=n=>new ni(n);w.f32be=n=>new si(n);w.f64=n=>new ii(n);w.f64be=n=>new oi(n);var N=w.struct=(n,e,t)=>new ci(n,e,t);w.bits=(n,e,t)=>new Fn(n,e,t);var Se=w.seq=(n,e,t)=>new ai(n,e,t);w.union=(n,e,t)=>new $n(n,e,t);w.unionLayoutDiscriminator=(n,e)=>new Er(n,e);var ie=w.blob=(n,e)=>new fi(n,e);w.cstr=n=>new di(n);w.utf8=(n,e)=>new hi(n,e);w.constant=(n,e)=>new pi(n,e);var rr={};Object.defineProperty(rr,"__esModule",{value:!0});function Jo(n){{const e=L.from(n);e.reverse();const t=e.toString("hex");return t.length===0?BigInt(0):BigInt(`0x${t}`)}}var Yo=rr.toBigIntLE=Jo;function Qo(n){{const e=n.toString("hex");return e.length===0?BigInt(0):BigInt(`0x${e}`)}}rr.toBigIntBE=Qo;function ea(n,e){{const t=n.toString(16),r=L.from(t.padStart(e*2,"0").slice(0,e*2),"hex");return r.reverse(),r}}var ta=rr.toBufferLE=ea;function ra(n,e){{const t=n.toString(16);return L.from(t.padStart(e*2,"0").slice(0,e*2),"hex")}}rr.toBufferBE=ra;class na extends TypeError{constructor(e,t){let r;const{message:s,...i}=e,{path:o}=e,a=o.length===0?s:"At path: "+o.join(".")+" -- "+s;super(a),Object.assign(this,i),this.name=this.constructor.name,this.failures=()=>{var c;return(c=r)!=null?c:r=[e,...t()]}}}function sa(n){return it(n)&&typeof n[Symbol.iterator]=="function"}function it(n){return typeof n=="object"&&n!=null}function Ne(n){return typeof n=="string"?JSON.stringify(n):""+n}function ia(n){const{done:e,value:t}=n.next();return e?void 0:t}function oa(n,e,t,r){if(n===!0)return;n===!1?n={}:typeof n=="string"&&(n={message:n});const{path:s,branch:i}=e,{type:o}=t,{refinement:a,message:c="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+Ne(r)+"`"}=n;return{value:r,type:o,refinement:a,key:s[s.length-1],path:s,branch:i,...n,message:c}}function*ns(n,e,t,r){sa(n)||(n=[n]);for(const s of n){const i=oa(s,e,t,r);i&&(yield i)}}function*Mn(n,e,t={}){const{path:r=[],branch:s=[n],coerce:i=!1,mask:o=!1}=t,a={path:r,branch:s};if(i&&(n=e.coercer(n,a),o&&e.type!=="type"&&it(e.schema)&&it(n)&&!Array.isArray(n)))for(const u in n)e.schema[u]===void 0&&delete n[u];let c=!0;for(const u of e.validator(n,a))c=!1,yield[u,void 0];for(let[u,l,f]of e.entries(n,a)){const h=Mn(l,f,{path:u===void 0?r:[...r,u],branch:u===void 0?s:[...s,l],coerce:i,mask:o});for(const d of h)d[0]?(c=!1,yield[d[0],void 0]):i&&(l=d[1],u===void 0?n=l:n instanceof Map?n.set(u,l):n instanceof Set?n.add(l):it(n)&&(n[u]=l))}if(c)for(const u of e.refiner(n,a))c=!1,yield[u,void 0];c&&(yield[void 0,n])}let He=class{constructor(e){const{type:t,schema:r,validator:s,refiner:i,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=t,this.schema=r,this.entries=a,this.coercer=o,s?this.validator=(c,u)=>{const l=s(c,u);return ns(l,u,this,c)}:this.validator=()=>[],i?this.refiner=(c,u)=>{const l=i(c,u);return ns(l,u,this,c)}:this.refiner=()=>[]}assert(e){return aa(e,this)}create(e){return _(e,this)}is(e){return gi(e,this)}mask(e){return ca(e,this)}validate(e,t={}){return nr(e,this,t)}};function aa(n,e){const t=nr(n,e);if(t[0])throw t[0]}function _(n,e){const t=nr(n,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function ca(n,e){const t=nr(n,e,{coerce:!0,mask:!0});if(t[0])throw t[0];return t[1]}function gi(n,e){return!nr(n,e)[0]}function nr(n,e,t={}){const r=Mn(n,e,t),s=ia(r);return s[0]?[new na(s[0],function*(){for(const o of r)o[0]&&(yield o[0])}),void 0]:[void 0,s[1]]}function St(n,e){return new He({type:n,schema:null,validator:e})}function ua(){return St("any",()=>!0)}function B(n){return new He({type:"array",schema:n,*entries(e){if(n&&Array.isArray(e))for(const[t,r]of e.entries())yield[t,r,n]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+Ne(e)}})}function Ge(){return St("boolean",n=>typeof n=="boolean")}function qn(n){return St("instance",e=>e instanceof n||"Expected a `"+n.name+"` instance, but received: "+Ne(e))}function se(n){const e=Ne(n),t=typeof n;return new He({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?n:null,validator(r){return r===n||"Expected the literal `"+e+"`, but received: "+Ne(r)}})}function la(){return St("never",()=>!1)}function R(n){return new He({...n,validator:(e,t)=>e===null||n.validator(e,t),refiner:(e,t)=>e===null||n.refiner(e,t)})}function y(){return St("number",n=>typeof n=="number"&&!isNaN(n)||"Expected a number, but received: "+Ne(n))}function q(n){return new He({...n,validator:(e,t)=>e===void 0||n.validator(e,t),refiner:(e,t)=>e===void 0||n.refiner(e,t)})}function yi(n,e){return new He({type:"record",schema:null,*entries(t){if(it(t))for(const r in t){const s=t[r];yield[r,r,n],yield[r,s,e]}},validator(t){return it(t)||"Expected an object, but received: "+Ne(t)}})}function I(){return St("string",n=>typeof n=="string"||"Expected a string, but received: "+Ne(n))}function Dn(n){const e=la();return new He({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){const r=Math.max(n.length,t.length);for(let s=0;s<r;s++)yield[s,t[s],n[s]||e]}},validator(t){return Array.isArray(t)||"Expected an array, but received: "+Ne(t)}})}function x(n){const e=Object.keys(n);return new He({type:"type",schema:n,*entries(t){if(it(t))for(const r of e)yield[r,t[r],n[r]]},validator(t){return it(t)||"Expected an object, but received: "+Ne(t)}})}function Ee(n){const e=n.map(t=>t.type).join(" | ");return new He({type:"union",schema:null,validator(t,r){const s=[];for(const i of n){const[...o]=Mn(t,i,r),[a]=o;if(a[0])for(const[c]of o)c&&s.push(c);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+Ne(t),...s]}})}function sr(){return St("unknown",()=>!0)}function ir(n,e,t){return new He({...n,coercer:(r,s)=>gi(r,e)?n.coercer(t(r,s),s):n.coercer(r,s)})}var cr,fa=new Uint8Array(16);function mi(){if(!cr&&(cr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!cr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return cr(fa)}const da=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Fr(n){return typeof n=="string"&&da.test(n)}var de=[];for(var Yr=0;Yr<256;++Yr)de.push((Yr+256).toString(16).substr(1));function Kr(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(de[n[e+0]]+de[n[e+1]]+de[n[e+2]]+de[n[e+3]]+"-"+de[n[e+4]]+de[n[e+5]]+"-"+de[n[e+6]]+de[n[e+7]]+"-"+de[n[e+8]]+de[n[e+9]]+"-"+de[n[e+10]]+de[n[e+11]]+de[n[e+12]]+de[n[e+13]]+de[n[e+14]]+de[n[e+15]]).toLowerCase();if(!Fr(t))throw TypeError("Stringified UUID is invalid");return t}var ss,Qr,en=0,tn=0;function ha(n,e,t){var r=e&&t||0,s=e||new Array(16);n=n||{};var i=n.node||ss,o=n.clockseq!==void 0?n.clockseq:Qr;if(i==null||o==null){var a=n.random||(n.rng||mi)();i==null&&(i=ss=[a[0]|1,a[1],a[2],a[3],a[4],a[5]]),o==null&&(o=Qr=(a[6]<<8|a[7])&16383)}var c=n.msecs!==void 0?n.msecs:Date.now(),u=n.nsecs!==void 0?n.nsecs:tn+1,l=c-en+(u-tn)/1e4;if(l<0&&n.clockseq===void 0&&(o=o+1&16383),(l<0||c>en)&&n.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");en=c,tn=u,Qr=o,c+=122192928e5;var f=((c&268435455)*1e4+u)%4294967296;s[r++]=f>>>24&255,s[r++]=f>>>16&255,s[r++]=f>>>8&255,s[r++]=f&255;var h=c/4294967296*1e4&268435455;s[r++]=h>>>8&255,s[r++]=h&255,s[r++]=h>>>24&15|16,s[r++]=h>>>16&255,s[r++]=o>>>8|128,s[r++]=o&255;for(var d=0;d<6;++d)s[r+d]=i[d];return e||Kr(s)}function wi(n){if(!Fr(n))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(n.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(n.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(n.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(n.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(n.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}function pa(n){n=unescape(encodeURIComponent(n));for(var e=[],t=0;t<n.length;++t)e.push(n.charCodeAt(t));return e}var ga="6ba7b810-9dad-11d1-80b4-00c04fd430c8",ya="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function bi(n,e,t){function r(s,i,o,a){if(typeof s=="string"&&(s=pa(s)),typeof i=="string"&&(i=wi(i)),i.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var c=new Uint8Array(16+s.length);if(c.set(i),c.set(s,i.length),c=t(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,o){a=a||0;for(var u=0;u<16;++u)o[a+u]=c[u];return o}return Kr(c)}try{r.name=n}catch{}return r.DNS=ga,r.URL=ya,r}function ma(n){if(typeof n=="string"){var e=unescape(encodeURIComponent(n));n=new Uint8Array(e.length);for(var t=0;t<e.length;++t)n[t]=e.charCodeAt(t)}return wa(ba(va(n),n.length*8))}function wa(n){for(var e=[],t=n.length*32,r="0123456789abcdef",s=0;s<t;s+=8){var i=n[s>>5]>>>s%32&255,o=parseInt(r.charAt(i>>>4&15)+r.charAt(i&15),16);e.push(o)}return e}function vi(n){return(n+64>>>9<<4)+14+1}function ba(n,e){n[e>>5]|=128<<e%32,n[vi(e)-1]=e;for(var t=1732584193,r=-271733879,s=-1732584194,i=271733878,o=0;o<n.length;o+=16){var a=t,c=r,u=s,l=i;t=ye(t,r,s,i,n[o],7,-680876936),i=ye(i,t,r,s,n[o+1],12,-389564586),s=ye(s,i,t,r,n[o+2],17,606105819),r=ye(r,s,i,t,n[o+3],22,-1044525330),t=ye(t,r,s,i,n[o+4],7,-176418897),i=ye(i,t,r,s,n[o+5],12,1200080426),s=ye(s,i,t,r,n[o+6],17,-1473231341),r=ye(r,s,i,t,n[o+7],22,-45705983),t=ye(t,r,s,i,n[o+8],7,1770035416),i=ye(i,t,r,s,n[o+9],12,-1958414417),s=ye(s,i,t,r,n[o+10],17,-42063),r=ye(r,s,i,t,n[o+11],22,-1990404162),t=ye(t,r,s,i,n[o+12],7,1804603682),i=ye(i,t,r,s,n[o+13],12,-40341101),s=ye(s,i,t,r,n[o+14],17,-1502002290),r=ye(r,s,i,t,n[o+15],22,1236535329),t=me(t,r,s,i,n[o+1],5,-165796510),i=me(i,t,r,s,n[o+6],9,-1069501632),s=me(s,i,t,r,n[o+11],14,643717713),r=me(r,s,i,t,n[o],20,-373897302),t=me(t,r,s,i,n[o+5],5,-701558691),i=me(i,t,r,s,n[o+10],9,38016083),s=me(s,i,t,r,n[o+15],14,-660478335),r=me(r,s,i,t,n[o+4],20,-405537848),t=me(t,r,s,i,n[o+9],5,568446438),i=me(i,t,r,s,n[o+14],9,-1019803690),s=me(s,i,t,r,n[o+3],14,-187363961),r=me(r,s,i,t,n[o+8],20,1163531501),t=me(t,r,s,i,n[o+13],5,-1444681467),i=me(i,t,r,s,n[o+2],9,-51403784),s=me(s,i,t,r,n[o+7],14,1735328473),r=me(r,s,i,t,n[o+12],20,-1926607734),t=we(t,r,s,i,n[o+5],4,-378558),i=we(i,t,r,s,n[o+8],11,-2022574463),s=we(s,i,t,r,n[o+11],16,1839030562),r=we(r,s,i,t,n[o+14],23,-35309556),t=we(t,r,s,i,n[o+1],4,-1530992060),i=we(i,t,r,s,n[o+4],11,1272893353),s=we(s,i,t,r,n[o+7],16,-155497632),r=we(r,s,i,t,n[o+10],23,-1094730640),t=we(t,r,s,i,n[o+13],4,681279174),i=we(i,t,r,s,n[o],11,-358537222),s=we(s,i,t,r,n[o+3],16,-722521979),r=we(r,s,i,t,n[o+6],23,76029189),t=we(t,r,s,i,n[o+9],4,-640364487),i=we(i,t,r,s,n[o+12],11,-421815835),s=we(s,i,t,r,n[o+15],16,530742520),r=we(r,s,i,t,n[o+2],23,-995338651),t=be(t,r,s,i,n[o],6,-198630844),i=be(i,t,r,s,n[o+7],10,1126891415),s=be(s,i,t,r,n[o+14],15,-1416354905),r=be(r,s,i,t,n[o+5],21,-57434055),t=be(t,r,s,i,n[o+12],6,1700485571),i=be(i,t,r,s,n[o+3],10,-1894986606),s=be(s,i,t,r,n[o+10],15,-1051523),r=be(r,s,i,t,n[o+1],21,-2054922799),t=be(t,r,s,i,n[o+8],6,1873313359),i=be(i,t,r,s,n[o+15],10,-30611744),s=be(s,i,t,r,n[o+6],15,-1560198380),r=be(r,s,i,t,n[o+13],21,1309151649),t=be(t,r,s,i,n[o+4],6,-145523070),i=be(i,t,r,s,n[o+11],10,-1120210379),s=be(s,i,t,r,n[o+2],15,718787259),r=be(r,s,i,t,n[o+9],21,-343485551),t=nt(t,a),r=nt(r,c),s=nt(s,u),i=nt(i,l)}return[t,r,s,i]}function va(n){if(n.length===0)return[];for(var e=n.length*8,t=new Uint32Array(vi(e)),r=0;r<e;r+=8)t[r>>5]|=(n[r/8]&255)<<r%32;return t}function nt(n,e){var t=(n&65535)+(e&65535),r=(n>>16)+(e>>16)+(t>>16);return r<<16|t&65535}function Sa(n,e){return n<<e|n>>>32-e}function Mr(n,e,t,r,s,i){return nt(Sa(nt(nt(e,n),nt(r,i)),s),t)}function ye(n,e,t,r,s,i,o){return Mr(e&t|~e&r,n,e,s,i,o)}function me(n,e,t,r,s,i,o){return Mr(e&r|t&~r,n,e,s,i,o)}function we(n,e,t,r,s,i,o){return Mr(e^t^r,n,e,s,i,o)}function be(n,e,t,r,s,i,o){return Mr(t^(e|~r),n,e,s,i,o)}var ka=bi("v3",48,ma);const Aa=ka;function Ea(n,e,t){n=n||{};var r=n.random||(n.rng||mi)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(var s=0;s<16;++s)e[t+s]=r[s];return e}return Kr(r)}function xa(n,e,t,r){switch(n){case 0:return e&t^~e&r;case 1:return e^t^r;case 2:return e&t^e&r^t&r;case 3:return e^t^r}}function rn(n,e){return n<<e|n>>>32-e}function Ia(n){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){var r=unescape(encodeURIComponent(n));n=[];for(var s=0;s<r.length;++s)n.push(r.charCodeAt(s))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);for(var i=n.length/4+2,o=Math.ceil(i/16),a=new Array(o),c=0;c<o;++c){for(var u=new Uint32Array(16),l=0;l<16;++l)u[l]=n[c*64+l*4]<<24|n[c*64+l*4+1]<<16|n[c*64+l*4+2]<<8|n[c*64+l*4+3];a[c]=u}a[o-1][14]=(n.length-1)*8/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=(n.length-1)*8&4294967295;for(var f=0;f<o;++f){for(var h=new Uint32Array(80),d=0;d<16;++d)h[d]=a[f][d];for(var p=16;p<80;++p)h[p]=rn(h[p-3]^h[p-8]^h[p-14]^h[p-16],1);for(var g=t[0],m=t[1],k=t[2],b=t[3],S=t[4],T=0;T<80;++T){var E=Math.floor(T/20),U=rn(g,5)+xa(E,m,k,b)+S+e[E]+h[T]>>>0;S=b,b=k,k=rn(m,30)>>>0,m=g,g=U}t[0]=t[0]+g>>>0,t[1]=t[1]+m>>>0,t[2]=t[2]+k>>>0,t[3]=t[3]+b>>>0,t[4]=t[4]+S>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var _a=bi("v5",80,Ia);const Ba=_a,Ra="00000000-0000-0000-0000-000000000000";function Ca(n){if(!Fr(n))throw TypeError("Invalid UUID");return parseInt(n.substr(14,1),16)}const Ta=Object.freeze(Object.defineProperty({__proto__:null,NIL:Ra,parse:wi,stringify:Kr,v1:ha,v3:Aa,v4:Ea,v5:Ba,validate:Fr,version:Ca},Symbol.toStringTag,{value:"Module"})),Si=Ve(Ta),Pa=Si.v4,Oa=function(n,e,t,r){if(typeof n!="string")throw new TypeError(n+" must be a string");r=r||{};const s=typeof r.version=="number"?r.version:2;if(s!==1&&s!==2)throw new TypeError(s+" must be 1 or 2");const i={method:n};if(s===2&&(i.jsonrpc="2.0"),e){if(typeof e!="object"&&!Array.isArray(e))throw new TypeError(e+" must be an object, array or omitted");i.params=e}if(typeof t>"u"){const o=typeof r.generator=="function"?r.generator:function(){return Pa()};i.id=o(i,r)}else s===2&&t===null?r.notificationIdNull&&(i.id=null):i.id=t;return i};var La=Oa;const Ua=Si.v4,Na=La,Xt=function(n,e){if(!(this instanceof Xt))return new Xt(n,e);e||(e={}),this.options={reviver:typeof e.reviver<"u"?e.reviver:null,replacer:typeof e.replacer<"u"?e.replacer:null,generator:typeof e.generator<"u"?e.generator:function(){return Ua()},version:typeof e.version<"u"?e.version:2,notificationIdNull:typeof e.notificationIdNull=="boolean"?e.notificationIdNull:!1},this.callServer=n};var $a=Xt;Xt.prototype.request=function(n,e,t,r){const s=this;let i=null;const o=Array.isArray(n)&&typeof e=="function";if(this.options.version===1&&o)throw new TypeError("JSON-RPC 1.0 does not support batching");if(o||!o&&n&&typeof n=="object"&&typeof e=="function")r=e,i=n;else{typeof t=="function"&&(r=t,t=void 0);const u=typeof r=="function";try{i=Na(n,e,t,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(l){if(u)return r(l);throw l}if(!u)return i}let c;try{c=JSON.stringify(i,this.options.replacer)}catch(u){return r(u)}return this.callServer(c,function(u,l){s._parseResponse(u,l,r)}),i};Xt.prototype._parseResponse=function(n,e,t){if(n){t(n);return}if(!e)return t();let r;try{r=JSON.parse(e,this.options.reviver)}catch(s){return t(s)}if(t.length===3)if(Array.isArray(r)){const s=function(o){return typeof o.error<"u"},i=function(o){return!s(o)};return t(null,r.filter(s),r.filter(i))}else return t(null,r.error,r.result);t(null,r)};var ki={},xr={},Fa={get exports(){return xr},set exports(n){xr=n}};(function(n){function e(t){return t&&t.__esModule?t:{default:t}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(Fa);const Ka=Ve(Xi),Ma=Ve(Ji),Ai=Ve(Yi),Ei=Ve(Qi),xi=Ve(eo),Ii=Ve(to),_i=Ve(ro);(function(n){var e=xr;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(v),r=e(Ka),s=e(Ma),i=e(Ai),o=e(Ei),a=e(xi),c=e(Ii),u=e(_i),l=Ns;function f(g){var m=h();return function(){var b=(0,u.default)(g),S;if(m){var T=(0,u.default)(this).constructor;S=Reflect.construct(b,arguments,T)}else S=b.apply(this,arguments);return(0,c.default)(this,S)}}function h(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var d=function(g,m){var k={};for(var b in g)Object.prototype.hasOwnProperty.call(g,b)&&m.indexOf(b)<0&&(k[b]=g[b]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var S=0,b=Object.getOwnPropertySymbols(g);S<b.length;S++)m.indexOf(b[S])<0&&Object.prototype.propertyIsEnumerable.call(g,b[S])&&(k[b[S]]=g[b[S]]);return k},p=function(g){(0,a.default)(k,g);var m=f(k);function k(b){var S,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"ws://localhost:8080",E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},U=arguments.length>3?arguments[3]:void 0;(0,i.default)(this,k);var C=E.autoconnect,M=C===void 0?!0:C,te=E.reconnect,Be=te===void 0?!0:te,Ze=E.reconnect_interval,ze=Ze===void 0?1e3:Ze,Et=E.max_reconnects,Wr=Et===void 0?5:Et,or=d(E,["autoconnect","reconnect","reconnect_interval","max_reconnects"]);return S=m.call(this),S.webSocketFactory=b,S.queue={},S.rpc_id=0,S.address=T,S.autoconnect=M,S.ready=!1,S.reconnect=Be,S.reconnect_timer_id=void 0,S.reconnect_interval=ze,S.max_reconnects=Wr,S.rest_options=or,S.current_reconnects=0,S.generate_request_id=U||function(){return++S.rpc_id},S.autoconnect&&S._connect(S.address,Object.assign({autoconnect:S.autoconnect,reconnect:S.reconnect,reconnect_interval:S.reconnect_interval,max_reconnects:S.max_reconnects},S.rest_options)),S}return(0,o.default)(k,[{key:"connect",value:function(){this.socket||this._connect(this.address,Object.assign({autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects},this.rest_options))}},{key:"call",value:function(S,T,E,U){var C=this;return!U&&(0,s.default)(E)==="object"&&(U=E,E=null),new Promise(function(M,te){if(!C.ready)return te(new Error("socket not ready"));var Be=C.generate_request_id(S,T),Ze={jsonrpc:"2.0",method:S,params:T||null,id:Be};C.socket.send(JSON.stringify(Ze),U,function(ze){if(ze)return te(ze);C.queue[Be]={promise:[M,te]},E&&(C.queue[Be].timeout=setTimeout(function(){delete C.queue[Be],te(new Error("reply timeout"))},E))})})}},{key:"login",value:function(){var b=(0,r.default)(t.default.mark(function T(E){var U;return t.default.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,this.call("rpc.login",E);case 2:if(U=M.sent,U){M.next=5;break}throw new Error("authentication failed");case 5:return M.abrupt("return",U);case 6:case"end":return M.stop()}},T,this)}));function S(T){return b.apply(this,arguments)}return S}()},{key:"listMethods",value:function(){var b=(0,r.default)(t.default.mark(function T(){return t.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,this.call("__listMethods");case 2:return U.abrupt("return",U.sent);case 3:case"end":return U.stop()}},T,this)}));function S(){return b.apply(this,arguments)}return S}()},{key:"notify",value:function(S,T){var E=this;return new Promise(function(U,C){if(!E.ready)return C(new Error("socket not ready"));var M={jsonrpc:"2.0",method:S,params:T||null};E.socket.send(JSON.stringify(M),function(te){if(te)return C(te);U()})})}},{key:"subscribe",value:function(){var b=(0,r.default)(t.default.mark(function T(E){var U;return t.default.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return typeof E=="string"&&(E=[E]),M.next=3,this.call("rpc.on",E);case 3:if(U=M.sent,!(typeof E=="string"&&U[E]!=="ok")){M.next=6;break}throw new Error("Failed subscribing to an event '"+E+"' with: "+U[E]);case 6:return M.abrupt("return",U);case 7:case"end":return M.stop()}},T,this)}));function S(T){return b.apply(this,arguments)}return S}()},{key:"unsubscribe",value:function(){var b=(0,r.default)(t.default.mark(function T(E){var U;return t.default.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return typeof E=="string"&&(E=[E]),M.next=3,this.call("rpc.off",E);case 3:if(U=M.sent,!(typeof E=="string"&&U[E]!=="ok")){M.next=6;break}throw new Error("Failed unsubscribing from an event with: "+U);case 6:return M.abrupt("return",U);case 7:case"end":return M.stop()}},T,this)}));function S(T){return b.apply(this,arguments)}return S}()},{key:"close",value:function(S,T){this.socket.close(S||1e3,T)}},{key:"_connect",value:function(S,T){var E=this;clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(S,T),this.socket.addEventListener("open",function(){E.ready=!0,E.emit("open"),E.current_reconnects=0}),this.socket.addEventListener("message",function(U){var C=U.data;C instanceof ArrayBuffer&&(C=L.from(C).toString());try{C=JSON.parse(C)}catch{return}if(C.notification&&E.listeners(C.notification).length){if(!Object.keys(C.params).length)return E.emit(C.notification);var M=[C.notification];if(C.params.constructor===Object)M.push(C.params);else for(var te=0;te<C.params.length;te++)M.push(C.params[te]);return Promise.resolve().then(function(){E.emit.apply(E,M)})}if(!E.queue[C.id])return C.method&&C.params?Promise.resolve().then(function(){E.emit(C.method,C.params)}):void 0;"error"in C=="result"in C&&E.queue[C.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),E.queue[C.id].timeout&&clearTimeout(E.queue[C.id].timeout),C.error?E.queue[C.id].promise[1](C.error):E.queue[C.id].promise[0](C.result),delete E.queue[C.id]}),this.socket.addEventListener("error",function(U){return E.emit("error",U)}),this.socket.addEventListener("close",function(U){var C=U.code,M=U.reason;E.ready&&setTimeout(function(){return E.emit("close",C,M)},0),E.ready=!1,E.socket=void 0,C!==1e3&&(E.current_reconnects++,E.reconnect&&(E.max_reconnects>E.current_reconnects||E.max_reconnects===0)&&(E.reconnect_timer_id=setTimeout(function(){return E._connect(S,T)},E.reconnect_interval)))})}}]),k}(l.EventEmitter);n.default=p})(ki);const qa=$s(ki);var Bi={};(function(n){var e=xr;Object.defineProperty(n,"__esModule",{value:!0}),n.default=f;var t=e(Ai),r=e(Ei),s=e(xi),i=e(Ii),o=e(_i),a=Ns;function c(h){var d=u();return function(){var g=(0,o.default)(h),m;if(d){var k=(0,o.default)(this).constructor;m=Reflect.construct(g,arguments,k)}else m=g.apply(this,arguments);return(0,i.default)(this,m)}}function u(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var l=function(h){(0,s.default)(p,h);var d=c(p);function p(g,m,k){var b;return(0,t.default)(this,p),b=d.call(this),b.socket=new window.WebSocket(g,k),b.socket.onopen=function(){return b.emit("open")},b.socket.onmessage=function(S){return b.emit("message",S.data)},b.socket.onerror=function(S){return b.emit("error",S)},b.socket.onclose=function(S){b.emit("close",S.code,S.reason)},b}return(0,r.default)(p,[{key:"send",value:function(m,k,b){var S=b||k;try{this.socket.send(m),S()}catch(T){S(T)}}},{key:"close",value:function(m,k){this.socket.close(m,k)}},{key:"addEventListener",value:function(m,k,b){this.socket.addEventListener(m,k,b)}}]),p}(a.EventEmitter);function f(h,d){return new l(h,d)}})(Bi);const Da=$s(Bi);/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const J=BigInt(0),ne=BigInt(1),st=BigInt(2),Gt=BigInt(3),is=BigInt(8),fe=Object.freeze({a:J,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:ne,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),os=(n,e)=>(n+e/st)/e,ur={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(n){const{n:e}=fe,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-ne*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),a=os(i*n,e),c=os(-r*n,e);let u=O(n-a*t-c*s,e),l=O(-a*r-c*i,e);const f=u>o,h=l>o;if(f&&(u=e-u),h&&(l=e-l),u>o||l>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+n);return{k1neg:f,k1:u,k2neg:h,k2:l}}},_t=32,Jt=32,as=_t+1,cs=2*_t+1;function us(n){const{a:e,b:t}=fe,r=O(n*n),s=O(r*n);return O(s+e*n+t)}const lr=fe.a===J;class Ha extends Error{constructor(e){super(e)}}function ls(n){if(!(n instanceof Z))throw new TypeError("JacobianPoint expected")}class Z{constructor(e,t,r){this.x=e,this.y=t,this.z=r}static fromAffine(e){if(!(e instanceof oe))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(oe.ZERO)?Z.ZERO:new Z(e.x,e.y,ne)}static toAffineBatch(e){const t=Va(e.map(r=>r.z));return e.map((r,s)=>r.toAffine(t[s]))}static normalizeZ(e){return Z.toAffineBatch(e).map(Z.fromAffine)}equals(e){ls(e);const{x:t,y:r,z:s}=this,{x:i,y:o,z:a}=e,c=O(s*s),u=O(a*a),l=O(t*u),f=O(i*c),h=O(O(r*a)*u),d=O(O(o*s)*c);return l===f&&h===d}negate(){return new Z(this.x,O(-this.y),this.z)}double(){const{x:e,y:t,z:r}=this,s=O(e*e),i=O(t*t),o=O(i*i),a=e+i,c=O(st*(O(a*a)-s-o)),u=O(Gt*s),l=O(u*u),f=O(l-st*c),h=O(u*(c-f)-is*o),d=O(st*t*r);return new Z(f,h,d)}add(e){ls(e);const{x:t,y:r,z:s}=this,{x:i,y:o,z:a}=e;if(i===J||o===J)return this;if(t===J||r===J)return e;const c=O(s*s),u=O(a*a),l=O(t*u),f=O(i*c),h=O(O(r*a)*u),d=O(O(o*s)*c),p=O(f-l),g=O(d-h);if(p===J)return g===J?this.double():Z.ZERO;const m=O(p*p),k=O(p*m),b=O(l*m),S=O(g*g-k-st*b),T=O(g*(b-S)-h*k),E=O(s*a*p);return new Z(S,T,E)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){const t=Z.ZERO;if(typeof e=="bigint"&&e===J)return t;let r=ps(e);if(r===ne)return this;if(!lr){let f=t,h=this;for(;r>J;)r&ne&&(f=f.add(h)),h=h.double(),r>>=ne;return f}let{k1neg:s,k1:i,k2neg:o,k2:a}=ur.splitScalar(r),c=t,u=t,l=this;for(;i>J||a>J;)i&ne&&(c=c.add(l)),a&ne&&(u=u.add(l)),l=l.double(),i>>=ne,a>>=ne;return s&&(c=c.negate()),o&&(u=u.negate()),u=new Z(O(u.x*ur.beta),u.y,u.z),c.add(u)}precomputeWindow(e){const t=lr?128/e+1:256/e+1,r=[];let s=this,i=s;for(let o=0;o<t;o++){i=s,r.push(i);for(let a=1;a<2**(e-1);a++)i=i.add(s),r.push(i);s=i.double()}return r}wNAF(e,t){!t&&this.equals(Z.BASE)&&(t=oe.BASE);const r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let s=t&&pn.get(t);s||(s=this.precomputeWindow(r),t&&r!==1&&(s=Z.normalizeZ(s),pn.set(t,s)));let i=Z.ZERO,o=Z.BASE;const a=1+(lr?128/r:256/r),c=2**(r-1),u=BigInt(2**r-1),l=2**r,f=BigInt(r);for(let h=0;h<a;h++){const d=h*c;let p=Number(e&u);e>>=f,p>c&&(p-=l,e+=ne);const g=d,m=d+Math.abs(p)-1,k=h%2!==0,b=p<0;p===0?o=o.add(fr(k,s[g])):i=i.add(fr(b,s[m]))}return{p:i,f:o}}multiply(e,t){let r=ps(e),s,i;if(lr){const{k1neg:o,k1:a,k2neg:c,k2:u}=ur.splitScalar(r);let{p:l,f}=this.wNAF(a,t),{p:h,f:d}=this.wNAF(u,t);l=fr(o,l),h=fr(c,h),h=new Z(O(h.x*ur.beta),h.y,h.z),s=l.add(h),i=f.add(d)}else{const{p:o,f:a}=this.wNAF(r,t);s=o,i=a}return Z.normalizeZ([s,i])[0]}toAffine(e){const{x:t,y:r,z:s}=this,i=this.equals(Z.ZERO);e==null&&(e=i?is:qr(s));const o=e,a=O(o*o),c=O(a*o),u=O(t*a),l=O(r*c),f=O(s*o);if(i)return oe.ZERO;if(f!==ne)throw new Error("invZ was invalid");return new oe(u,l)}}Z.BASE=new Z(fe.Gx,fe.Gy,ne);Z.ZERO=new Z(J,ne,J);function fr(n,e){const t=e.negate();return n?t:e}const pn=new WeakMap;class oe{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,pn.delete(this)}hasEvenY(){return this.y%st===J}static fromCompressedHex(e){const t=e.length===32,r=yt(t?e:e.subarray(1));if(!sn(r))throw new Error("Point is not on curve");const s=us(r);let i=Ga(s);const o=(i&ne)===ne;t?o&&(i=O(-i)):(e[0]&1)===1!==o&&(i=O(-i));const a=new oe(r,i);return a.assertValidity(),a}static fromUncompressedHex(e){const t=yt(e.subarray(1,_t+1)),r=yt(e.subarray(_t+1,_t*2+1)),s=new oe(t,r);return s.assertValidity(),s}static fromHex(e){const t=gn(e),r=t.length,s=t[0];if(r===_t)return this.fromCompressedHex(t);if(r===as&&(s===2||s===3))return this.fromCompressedHex(t);if(r===cs&&s===4)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-${as} compressed bytes or ${cs} uncompressed bytes, not ${r}`)}static fromPrivateKey(e){return oe.BASE.multiply(yn(e))}static fromSignature(e,t,r){const{r:s,s:i}=Ja(t);if(![0,1,2,3].includes(r))throw new Error("Cannot recover: invalid recovery bit");const o=Xa(gn(e)),{n:a}=fe,c=r===2||r===3?s+a:s,u=qr(c,a),l=O(-o*u,a),f=O(i*u,a),h=r&1?"03":"02",d=oe.fromHex(h+Rt(c)),p=oe.BASE.multiplyAndAddUnsafe(d,l,f);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return gt(this.toHex(e))}toHex(e=!1){const t=Rt(this.x);return e?`${this.hasEvenY()?"02":"03"}${t}`:`04${t}${Rt(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const e="Point is not on elliptic curve",{x:t,y:r}=this;if(!sn(t)||!sn(r))throw new Error(e);const s=O(r*r),i=us(t);if(O(s-i)!==J)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new oe(this.x,O(-this.y))}double(){return Z.fromAffine(this).double().toAffine()}add(e){return Z.fromAffine(this).add(Z.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Z.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,r){const s=Z.fromAffine(this),i=t===J||t===ne||this!==oe.BASE?s.multiplyUnsafe(t):s.multiply(t),o=Z.fromAffine(e).multiplyUnsafe(r),a=i.add(o);return a.equals(Z.ZERO)?void 0:a.toAffine()}}oe.BASE=new oe(fe.Gx,fe.Gy);oe.ZERO=new oe(J,J);function fs(n){return Number.parseInt(n[0],16)>=8?"00"+n:n}function ds(n){if(n.length<2||n[0]!==2)throw new Error(`Invalid signature integer tag: ${Ot(n)}`);const e=n[1],t=n.subarray(2,e+2);if(!e||t.length!==e)throw new Error("Invalid signature integer: wrong length");if(t[0]===0&&t[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:yt(t),left:n.subarray(e+2)}}function za(n){if(n.length<2||n[0]!=48)throw new Error(`Invalid signature tag: ${Ot(n)}`);if(n[1]!==n.length-2)throw new Error("Invalid signature: incorrect length");const{data:e,left:t}=ds(n.subarray(2)),{data:r,left:s}=ds(t);if(s.length)throw new Error(`Invalid signature: left bytes after parsing: ${Ot(s)}`);return{r:e,s:r}}class pt{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){const t=e instanceof Uint8Array,r="Signature.fromCompact";if(typeof e!="string"&&!t)throw new TypeError(`${r}: Expected string or Uint8Array`);const s=t?Ot(e):e;if(s.length!==128)throw new Error(`${r}: Expected 64-byte hex`);return new pt(Ir(s.slice(0,64)),Ir(s.slice(64,128)))}static fromDER(e){const t=e instanceof Uint8Array;if(typeof e!="string"&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r,s}=za(t?e:gt(e));return new pt(r,s)}static fromHex(e){return this.fromDER(e)}assertValidity(){const{r:e,s:t}=this;if(!_r(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!_r(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const e=fe.n>>ne;return this.s>e}normalizeS(){return this.hasHighS()?new pt(this.r,O(-this.s,fe.n)):this}toDERRawBytes(){return gt(this.toDERHex())}toDERHex(){const e=fs(qt(this.s)),t=fs(qt(this.r)),r=e.length/2,s=t.length/2,i=qt(r),o=qt(s);return`30${qt(s+r+4)}02${o}${t}02${i}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return gt(this.toCompactHex())}toCompactHex(){return Rt(this.r)+Rt(this.s)}}function Mt(...n){if(!n.every(r=>r instanceof Uint8Array))throw new Error("Uint8Array list expected");if(n.length===1)return n[0];const e=n.reduce((r,s)=>r+s.length,0),t=new Uint8Array(e);for(let r=0,s=0;r<n.length;r++){const i=n[r];t.set(i,s),s+=i.length}return t}const ja=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Ot(n){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let t=0;t<n.length;t++)e+=ja[n[t]];return e}const Wa=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function Rt(n){if(typeof n!="bigint")throw new Error("Expected bigint");if(!(J<=n&&n<Wa))throw new Error("Expected number 0 <= n < 2^256");return n.toString(16).padStart(64,"0")}function hs(n){const e=gt(Rt(n));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function qt(n){const e=n.toString(16);return e.length&1?`0${e}`:e}function Ir(n){if(typeof n!="string")throw new TypeError("hexToNumber: expected string, got "+typeof n);return BigInt(`0x${n}`)}function gt(n){if(typeof n!="string")throw new TypeError("hexToBytes: expected string, got "+typeof n);if(n.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+n.length);const e=new Uint8Array(n.length/2);for(let t=0;t<e.length;t++){const r=t*2,s=n.slice(r,r+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[t]=i}return e}function yt(n){return Ir(Ot(n))}function gn(n){return n instanceof Uint8Array?Uint8Array.from(n):gt(n)}function ps(n){if(typeof n=="number"&&Number.isSafeInteger(n)&&n>0)return BigInt(n);if(typeof n=="bigint"&&_r(n))return n;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function O(n,e=fe.P){const t=n%e;return t>=J?t:e+t}function Re(n,e){const{P:t}=fe;let r=n;for(;e-- >J;)r*=r,r%=t;return r}function Ga(n){const{P:e}=fe,t=BigInt(6),r=BigInt(11),s=BigInt(22),i=BigInt(23),o=BigInt(44),a=BigInt(88),c=n*n*n%e,u=c*c*n%e,l=Re(u,Gt)*u%e,f=Re(l,Gt)*u%e,h=Re(f,st)*c%e,d=Re(h,r)*h%e,p=Re(d,s)*d%e,g=Re(p,o)*p%e,m=Re(g,a)*g%e,k=Re(m,o)*p%e,b=Re(k,Gt)*u%e,S=Re(b,i)*d%e,T=Re(S,t)*c%e,E=Re(T,st);if(E*E%e!==n)throw new Error("Cannot find square root");return E}function qr(n,e=fe.P){if(n===J||e<=J)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=O(n,e),r=e,s=J,i=ne;for(;t!==J;){const a=r/t,c=r%t,u=s-i*a;r=t,t=c,s=i,i=u}if(r!==ne)throw new Error("invert: does not exist");return O(s,e)}function Va(n,e=fe.P){const t=new Array(n.length),r=n.reduce((i,o,a)=>o===J?i:(t[a]=i,O(i*o,e)),ne),s=qr(r,e);return n.reduceRight((i,o,a)=>o===J?i:(t[a]=O(i*t[a],e),O(i*o,e)),s),t}function Za(n){const e=n.length*8-Jt*8,t=yt(n);return e>0?t>>BigInt(e):t}function Xa(n,e=!1){const t=Za(n);if(e)return t;const{n:r}=fe;return t>=r?t-r:t}let Ct,nn;function _r(n){return J<n&&n<fe.n}function sn(n){return J<n&&n<fe.P}function yn(n){let e;if(typeof n=="bigint")e=n;else if(typeof n=="number"&&Number.isSafeInteger(n)&&n>0)e=BigInt(n);else if(typeof n=="string"){if(n.length!==2*Jt)throw new Error("Expected 32 bytes of private key");e=Ir(n)}else if(n instanceof Uint8Array){if(n.length!==Jt)throw new Error("Expected 32 bytes of private key");e=yt(n)}else throw new TypeError("Expected valid private key");if(!_r(e))throw new Error("Expected private key: 0 < key < n");return e}function Ja(n){if(n instanceof pt)return n.assertValidity(),n;try{return pt.fromDER(n)}catch{return pt.fromCompact(n)}}oe.BASE._setWindowSize(8);const xe={node:Us,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},dr={},dt={bytesToHex:Ot,hexToBytes:gt,concatBytes:Mt,mod:O,invert:qr,isValidPrivateKey(n){try{return yn(n),!0}catch{return!1}},_bigintTo32Bytes:hs,_normalizePrivateKey:yn,hashToPrivateKey:n=>{n=gn(n);const e=Jt+8;if(n.length<e||n.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");const t=O(yt(n),fe.n-ne)+ne;return hs(t)},randomBytes:(n=32)=>{if(xe.web)return xe.web.getRandomValues(new Uint8Array(n));if(xe.node){const{randomBytes:e}=xe.node;return Uint8Array.from(e(n))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>dt.hashToPrivateKey(dt.randomBytes(Jt+8)),precompute(n=8,e=oe.BASE){const t=e===oe.BASE?e:new oe(e.x,e.y);return t._setWindowSize(n),t.multiply(Gt),t},sha256:async(...n)=>{if(xe.web){const e=await xe.web.subtle.digest("SHA-256",Mt(...n));return new Uint8Array(e)}else if(xe.node){const{createHash:e}=xe.node,t=e("sha256");return n.forEach(r=>t.update(r)),Uint8Array.from(t.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(n,...e)=>{if(xe.web){const t=await xe.web.subtle.importKey("raw",n,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),r=Mt(...e),s=await xe.web.subtle.sign("HMAC",t,r);return new Uint8Array(s)}else if(xe.node){const{createHmac:t}=xe.node,r=t("sha256",n);return e.forEach(s=>r.update(s)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(n,...e)=>{let t=dr[n];if(t===void 0){const r=await dt.sha256(Uint8Array.from(n,s=>s.charCodeAt(0)));t=Mt(r,r),dr[n]=t}return dt.sha256(t,...e)},taggedHashSync:(n,...e)=>{if(typeof Ct!="function")throw new Ha("sha256Sync is undefined, you need to set it");let t=dr[n];if(t===void 0){const r=Ct(Uint8Array.from(n,s=>s.charCodeAt(0)));t=Mt(r,r),dr[n]=t}return Ct(t,...e)},_JacobianPoint:Z};Object.defineProperties(dt,{sha256Sync:{configurable:!1,get(){return Ct},set(n){Ct||(Ct=n)}},hmacSha256Sync:{configurable:!1,get(){return nn},set(n){nn||(nn=n)}}});mt.sha512Sync=(...n)=>yo(mt.concatBytes(...n));mt.randomPrivateKey;const gs=()=>{const n=mt.randomPrivateKey(),e=mn(n),t=new Uint8Array(64);return t.set(n),t.set(e,32),{publicKey:e,secretKey:t}},mn=Cn.getPublicKey;function ys(n){try{return ue.fromHex(n,!0),!0}catch{return!1}}const Ya=(n,e)=>Cn.sign(n,e.slice(0,32)),Qa=Cn.verify,Lt=n=>L.isBuffer(n)?n:n instanceof Uint8Array?L.from(n.buffer,n.byteOffset,n.byteLength):L.from(n);class ec{constructor(e){Object.assign(this,e)}encode(){return L.from(Xs(gr,this))}static decode(e){return Js(gr,this,e)}static decodeUnchecked(e){return js(gr,this,e)}}const gr=new Map;let Ri;const tc=32,Ke=32;function rc(n){return n._bn!==void 0}let ms=1;Ri=Symbol.toStringTag;class K extends ec{constructor(e){if(super({}),this._bn=void 0,rc(e))this._bn=e._bn;else{if(typeof e=="string"){const t=Y.decode(e);if(t.length!=Ke)throw new Error("Invalid public key input");this._bn=new Xn(t)}else this._bn=new Xn(e);if(this._bn.byteLength()>Ke)throw new Error("Invalid public key input")}}static unique(){const e=new K(ms);return ms+=1,new K(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return Y.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(L);if(e.length===Ke)return e;const t=L.alloc(32);return e.copy(t,32-e.length),t}get[Ri](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,r){const s=L.concat([e.toBuffer(),L.from(t),r.toBuffer()]),i=un(s);return new K(i)}static createProgramAddressSync(e,t){let r=L.alloc(0);e.forEach(function(i){if(i.length>tc)throw new TypeError("Max seed length exceeded");r=L.concat([r,Lt(i)])}),r=L.concat([r,t.toBuffer(),L.from("ProgramDerivedAddress")]);const s=un(r);if(ys(s))throw new Error("Invalid seeds, address must fall off the curve");return new K(s)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let r=255,s;for(;r!=0;){try{const i=e.concat(L.from([r]));s=this.createProgramAddressSync(i,t)}catch(i){if(i instanceof TypeError)throw i;r--;continue}return[s,r]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new K(e);return ys(t.toBytes())}}K.default=new K("11111111111111111111111111111111");gr.set(K,{kind:"struct",fields:[["_bn","u256"]]});new K("BPFLoader1111111111111111111111111111111111");const Tt=1280-40-8,Ci=127,wn=64;class Ti extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Ti.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class Pi extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Pi.prototype,"name",{value:"TransactionExpiredTimeoutError"});class Ht extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Ht.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class Br{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const r=new Map;this.keySegments().flat().forEach((i,o)=>{r.set(i.toBase58(),o)});const s=i=>{const o=r.get(i.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(i=>({programIdIndex:s(i.programId),accountKeyIndexes:i.keys.map(o=>s(o.pubkey)),data:i.data}))}}const z=(n="publicKey")=>ie(32,n),Bt=(n="string")=>{const e=N([F("length"),F("lengthPadding"),ie(ht(F(),-8),"chars")],n),t=e.decode.bind(e),r=e.encode.bind(e),s=e;return s.decode=(i,o)=>t(i,o).chars.toString(),s.encode=(i,o,a)=>{const c={chars:L.from(i,"utf8")};return r(c,o,a)},s.alloc=i=>F().span+F().span+L.from(i,"utf8").length,s},nc=(n="authorized")=>N([z("staker"),z("withdrawer")],n),sc=(n="lockup")=>N([Ie("unixTimestamp"),Ie("epoch"),z("custodian")],n),ic=(n="voteInit")=>N([z("nodePubkey"),z("authorizedVoter"),z("authorizedWithdrawer"),X("commission")],n),oc=(n="voteAuthorizeWithSeedArgs")=>N([F("voteAuthorizationType"),z("currentAuthorityDerivedKeyOwnerPubkey"),Bt("currentAuthorityDerivedKeySeed"),z("newAuthorized")],n);function Te(n){let e=0,t=0;for(;;){let r=n.shift();if(e|=(r&127)<<t*7,t+=1,!(r&128))break}return e}function Pe(n,e){let t=e;for(;;){let r=t&127;if(t>>=7,t==0){n.push(r);break}else r|=128,n.push(r)}}function ae(n,e){if(!n)throw new Error(e||"Assertion failed")}class Dr{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const r=new Map,s=o=>{const a=o.toBase58();let c=r.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},r.set(a,c)),c},i=s(t);i.isSigner=!0,i.isWritable=!0;for(const o of e){s(o.programId).isInvoked=!0;for(const a of o.keys){const c=s(a.pubkey);c.isSigner||(c.isSigner=a.isSigner),c.isWritable||(c.isWritable=a.isWritable)}}return new Dr(t,r)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];ae(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),r=e.filter(([,c])=>c.isSigner&&!c.isWritable),s=e.filter(([,c])=>!c.isSigner&&c.isWritable),i=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:i.length};{ae(t.length>0,"Expected at least one writable signer key");const[c]=t[0];ae(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new K(c)),...r.map(([c])=>new K(c)),...s.map(([c])=>new K(c)),...i.map(([c])=>new K(c))];return[o,a]}extractTableLookup(e){const[t,r]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[s,i]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&s.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:s},{writable:r,readonly:i}]}drainKeysFoundInLookupTable(e,t){const r=new Array,s=new Array;for(const[i,o]of this.keyMetaMap.entries())if(t(o)){const a=new K(i),c=e.findIndex(u=>u.equals(a));c>=0&&(ae(c<256,"Max lookup table index exceeded"),r.push(c),s.push(a),this.keyMetaMap.delete(i))}return[r,s]}}class at{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new K(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:Y.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new Br(this.staticAccountKeys)}static compile(e){const t=Dr.compile(e.instructions,e.payerKey),[r,s]=t.getMessageComponents(),o=new Br(s).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:Y.encode(a.data)}));return new at({header:r,accountKeys:s,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const r=e-t,i=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return r<i}else{const r=t-this.header.numReadonlySignedAccounts;return e<r}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];Pe(t,e);const r=this.instructions.map(f=>{const{accounts:h,programIdIndex:d}=f,p=Array.from(Y.decode(f.data));let g=[];Pe(g,h.length);let m=[];return Pe(m,p.length),{programIdIndex:d,keyIndicesCount:L.from(g),keyIndices:h,dataLength:L.from(m),data:p}});let s=[];Pe(s,r.length);let i=L.alloc(Tt);L.from(s).copy(i);let o=s.length;r.forEach(f=>{const d=N([X("programIdIndex"),ie(f.keyIndicesCount.length,"keyIndicesCount"),Se(X("keyIndex"),f.keyIndices.length,"keyIndices"),ie(f.dataLength.length,"dataLength"),Se(X("userdatum"),f.data.length,"data")]).encode(f,i,o);o+=d}),i=i.slice(0,o);const a=N([ie(1,"numRequiredSignatures"),ie(1,"numReadonlySignedAccounts"),ie(1,"numReadonlyUnsignedAccounts"),ie(t.length,"keyCount"),Se(z("key"),e,"keys"),z("recentBlockhash")]),c={numRequiredSignatures:L.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:L.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:L.from([this.header.numReadonlyUnsignedAccounts]),keyCount:L.from(t),keys:this.accountKeys.map(f=>Lt(f.toBytes())),recentBlockhash:Y.decode(this.recentBlockhash)};let u=L.alloc(2048);const l=a.encode(c,u);return i.copy(u,l),u.slice(0,l+i.length)}static from(e){let t=[...e];const r=t.shift();if(r!==(r&Ci))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const s=t.shift(),i=t.shift(),o=Te(t);let a=[];for(let h=0;h<o;h++){const d=t.slice(0,Ke);t=t.slice(Ke),a.push(new K(L.from(d)))}const c=t.slice(0,Ke);t=t.slice(Ke);const u=Te(t);let l=[];for(let h=0;h<u;h++){const d=t.shift(),p=Te(t),g=t.slice(0,p);t=t.slice(p);const m=Te(t),k=t.slice(0,m),b=Y.encode(L.from(k));t=t.slice(m),l.push({programIdIndex:d,accounts:g,data:b})}const f={header:{numRequiredSignatures:r,numReadonlySignedAccounts:s,numReadonlyUnsignedAccounts:i},recentBlockhash:Y.encode(L.from(c)),accountKeys:a,instructions:l};return new at(f)}}class Rr{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new Br(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;if(e>=r){const s=e-r,i=this.addressTableLookups.reduce((o,a)=>o+a.writableIndexes.length,0);return s<i}else if(e>=this.header.numRequiredSignatures){const s=e-t,o=r-t-this.header.numReadonlyUnsignedAccounts;return s<o}else{const s=t-this.header.numReadonlySignedAccounts;return e<s}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const r of this.addressTableLookups){const s=e.find(i=>i.key.equals(r.accountKey));if(!s)throw new Error(`Failed to find address lookup table account for table key ${r.accountKey.toBase58()}`);for(const i of r.writableIndexes)if(i<s.state.addresses.length)t.writable.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`);for(const i of r.readonlyIndexes)if(i<s.state.addresses.length)t.readonly.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`)}return t}static compile(e){const t=Dr.compile(e.instructions,e.payerKey),r=new Array,s={writable:new Array,readonly:new Array},i=e.addressLookupTableAccounts||[];for(const l of i){const f=t.extractTableLookup(l);if(f!==void 0){const[h,{writable:d,readonly:p}]=f;r.push(h),s.writable.push(...d),s.readonly.push(...p)}}const[o,a]=t.getMessageComponents(),u=new Br(a,s).compileInstructions(e.instructions);return new Rr({header:o,staticAccountKeys:a,recentBlockhash:e.recentBlockhash,compiledInstructions:u,addressTableLookups:r})}serialize(){const e=Array();Pe(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),r=Array();Pe(r,this.compiledInstructions.length);const s=this.serializeAddressTableLookups(),i=Array();Pe(i,this.addressTableLookups.length);const o=N([X("prefix"),N([X("numRequiredSignatures"),X("numReadonlySignedAccounts"),X("numReadonlyUnsignedAccounts")],"header"),ie(e.length,"staticAccountKeysLength"),Se(z(),this.staticAccountKeys.length,"staticAccountKeys"),z("recentBlockhash"),ie(r.length,"instructionsLength"),ie(t.length,"serializedInstructions"),ie(i.length,"addressTableLookupsLength"),ie(s.length,"serializedAddressTableLookups")]),a=new Uint8Array(Tt),c=1<<7,u=o.encode({prefix:c,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(l=>l.toBytes()),recentBlockhash:Y.decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:s},a);return a.slice(0,u)}serializeInstructions(){let e=0;const t=new Uint8Array(Tt);for(const r of this.compiledInstructions){const s=Array();Pe(s,r.accountKeyIndexes.length);const i=Array();Pe(i,r.data.length);const o=N([X("programIdIndex"),ie(s.length,"encodedAccountKeyIndexesLength"),Se(X(),r.accountKeyIndexes.length,"accountKeyIndexes"),ie(i.length,"encodedDataLength"),ie(r.data.length,"data")]);e+=o.encode({programIdIndex:r.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(s),accountKeyIndexes:r.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:r.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(Tt);for(const r of this.addressTableLookups){const s=Array();Pe(s,r.writableIndexes.length);const i=Array();Pe(i,r.readonlyIndexes.length);const o=N([z("accountKey"),ie(s.length,"encodedWritableIndexesLength"),Se(X(),r.writableIndexes.length,"writableIndexes"),ie(i.length,"encodedReadonlyIndexesLength"),Se(X(),r.readonlyIndexes.length,"readonlyIndexes")]);e+=o.encode({accountKey:r.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(s),writableIndexes:r.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:r.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const r=t.shift(),s=r&Ci;ae(r!==s,"Expected versioned message but received legacy message");const i=s;ae(i===0,`Expected versioned message with version 0 but found version ${i}`);const o={numRequiredSignatures:t.shift(),numReadonlySignedAccounts:t.shift(),numReadonlyUnsignedAccounts:t.shift()},a=[],c=Te(t);for(let p=0;p<c;p++)a.push(new K(t.splice(0,Ke)));const u=Y.encode(t.splice(0,Ke)),l=Te(t),f=[];for(let p=0;p<l;p++){const g=t.shift(),m=Te(t),k=t.splice(0,m),b=Te(t),S=new Uint8Array(t.splice(0,b));f.push({programIdIndex:g,accountKeyIndexes:k,data:S})}const h=Te(t),d=[];for(let p=0;p<h;p++){const g=new K(t.splice(0,Ke)),m=Te(t),k=t.splice(0,m),b=Te(t),S=t.splice(0,b);d.push({accountKey:g,writableIndexes:k,readonlyIndexes:S})}return new Rr({header:o,staticAccountKeys:a,recentBlockhash:u,compiledInstructions:f,addressTableLookups:d})}}let Fe;(function(n){n[n.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",n[n.PROCESSED=1]="PROCESSED",n[n.TIMED_OUT=2]="TIMED_OUT",n[n.NONCE_INVALID=3]="NONCE_INVALID"})(Fe||(Fe={}));const ac=L.alloc(wn).fill(0);class ws{constructor(e){this.keys=void 0,this.programId=void 0,this.data=L.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:r})=>({pubkey:e.toJSON(),isSigner:t,isWritable:r})),programId:this.programId.toJSON(),data:[...this.data]}}}class tt{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:r}=e;this.minNonceContextSlot=t,this.nonceInfo=r}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:r}=e;this.recentBlockhash=t,this.lastValidBlockHeight=r}else{const{recentBlockhash:t,nonceInfo:r}=e;r&&(this.nonceInfo=r),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new ws(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let r;if(this.feePayer)r=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)r=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let g=0;g<t.length;g++)if(t[g].programId===void 0)throw new Error(`Transaction instruction index ${g} has undefined program id`);const s=[],i=[];t.forEach(g=>{g.keys.forEach(k=>{i.push({...k})});const m=g.programId.toString();s.includes(m)||s.push(m)}),s.forEach(g=>{i.push({pubkey:new K(g),isSigner:!1,isWritable:!1})});const o=[];i.forEach(g=>{const m=g.pubkey.toString(),k=o.findIndex(b=>b.pubkey.toString()===m);k>-1?(o[k].isWritable=o[k].isWritable||g.isWritable,o[k].isSigner=o[k].isSigner||g.isSigner):o.push(g)}),o.sort(function(g,m){return g.isSigner!==m.isSigner?g.isSigner?-1:1:g.isWritable!==m.isWritable?g.isWritable?-1:1:g.pubkey.toBase58().localeCompare(m.pubkey.toBase58())});const a=o.findIndex(g=>g.pubkey.equals(r));if(a>-1){const[g]=o.splice(a,1);g.isSigner=!0,g.isWritable=!0,o.unshift(g)}else o.unshift({pubkey:r,isSigner:!0,isWritable:!0});for(const g of this.signatures){const m=o.findIndex(k=>k.pubkey.equals(g.publicKey));if(m>-1)o[m].isSigner||(o[m].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${g.publicKey.toString()}`)}let c=0,u=0,l=0;const f=[],h=[];o.forEach(({pubkey:g,isSigner:m,isWritable:k})=>{m?(f.push(g.toString()),c+=1,k||(u+=1)):(h.push(g.toString()),k||(l+=1))});const d=f.concat(h),p=t.map(g=>{const{data:m,programId:k}=g;return{programIdIndex:d.indexOf(k.toString()),accounts:g.keys.map(b=>d.indexOf(b.pubkey.toString())),data:Y.encode(m)}});return p.forEach(g=>{ae(g.programIdIndex>=0),g.accounts.forEach(m=>ae(m>=0))}),new at({header:{numRequiredSignatures:c,numReadonlySignedAccounts:u,numReadonlyUnsignedAccounts:l},accountKeys:d,recentBlockhash:e,instructions:p})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((s,i)=>t[i].equals(s.publicKey))||(this.signatures=t.map(r=>({signature:null,publicKey:r}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(r=>{const s=r.toString();return t.has(s)?!1:(t.add(s),!0)}).map(r=>({signature:null,publicKey:r}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const i of e){const o=i.publicKey.toString();t.has(o)||(t.add(o),r.push(i))}this.signatures=r.map(i=>({signature:null,publicKey:i.publicKey}));const s=this._compile();this._partialSign(s,...r)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const i of e){const o=i.publicKey.toString();t.has(o)||(t.add(o),r.push(i))}const s=this._compile();this._partialSign(s,...r)}_partialSign(e,...t){const r=e.serialize();t.forEach(s=>{const i=Ya(r,s.secretKey);this._addSignature(s.publicKey,Lt(i))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){ae(t.length===64);const r=this.signatures.findIndex(s=>e.equals(s.publicKey));if(r<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[r].signature=L.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:r,publicKey:s}of this.signatures)if(r===null){if(t)return!1}else if(!Qa(r,e,s.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:r}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),s=this.serializeMessage();if(r&&!this._verifySignatures(s,t))throw new Error("Signature verification failed");return this._serialize(s)}_serialize(e){const{signatures:t}=this,r=[];Pe(r,t.length);const s=r.length+t.length*64+e.length,i=L.alloc(s);return ae(t.length<256),L.from(r).copy(i,0),t.forEach(({signature:o},a)=>{o!==null&&(ae(o.length===64,"signature has invalid length"),L.from(o).copy(i,r.length+a*64))}),e.copy(i,r.length+t.length*64),ae(i.length<=Tt,`Transaction too large: ${i.length} > ${Tt}`),i}get keys(){return ae(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return ae(this.instructions.length===1),this.instructions[0].programId}get data(){return ae(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const r=Te(t);let s=[];for(let i=0;i<r;i++){const o=t.slice(0,wn);t=t.slice(wn),s.push(Y.encode(L.from(o)))}return tt.populate(at.from(t),s)}static populate(e,t=[]){const r=new tt;return r.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(r.feePayer=e.accountKeys[0]),t.forEach((s,i)=>{const o={signature:s==Y.encode(ac)?null:Y.decode(s),publicKey:e.accountKeys[i]};r.signatures.push(o)}),e.instructions.forEach(s=>{const i=s.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:r.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});r.instructions.push(new ws({keys:i,programId:e.accountKeys[s.programIdIndex],data:Y.decode(s.data)}))}),r._message=e,r._json=r.toJSON(),r}}new K("SysvarC1ock11111111111111111111111111111111");new K("SysvarEpochSchedu1e111111111111111111111111");new K("Sysvar1nstructions1111111111111111111111111");new K("SysvarRecentB1ockHashes11111111111111111111");new K("SysvarRent111111111111111111111111111111111");new K("SysvarRewards111111111111111111111111111111");new K("SysvarS1otHashes111111111111111111111111111");new K("SysvarS1otHistory11111111111111111111111111");new K("SysvarStakeHistory1111111111111111111111111");function It(n){return new Promise(e=>setTimeout(e,n))}const cc=he("lamportsPerSignature"),Oi=N([F("version"),F("state"),z("authorizedPubkey"),z("nonce"),N([cc],"feeCalculator")]);Oi.span;class Hn{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=Oi.decode(Lt(e),0);return new Hn({authorizedPubkey:new K(t.authorizedPubkey),nonce:new K(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const uc=n=>{const e=n.decode.bind(n),t=n.encode.bind(n);return{decode:e,encode:t}},lc=n=>e=>{const t=ie(n,e),{encode:r,decode:s}=uc(t),i=t;return i.decode=(o,a)=>{const c=s(o,a);return Yo(L.from(c))},i.encode=(o,a,c)=>{const u=ta(o,n);return r(u,a,c)},i},Ut=lc(8);Object.freeze({Create:{index:0,layout:N([F("instruction"),Ie("lamports"),Ie("space"),z("programId")])},Assign:{index:1,layout:N([F("instruction"),z("programId")])},Transfer:{index:2,layout:N([F("instruction"),Ut("lamports")])},CreateWithSeed:{index:3,layout:N([F("instruction"),z("base"),Bt("seed"),Ie("lamports"),Ie("space"),z("programId")])},AdvanceNonceAccount:{index:4,layout:N([F("instruction")])},WithdrawNonceAccount:{index:5,layout:N([F("instruction"),Ie("lamports")])},InitializeNonceAccount:{index:6,layout:N([F("instruction"),z("authorized")])},AuthorizeNonceAccount:{index:7,layout:N([F("instruction"),z("authorized")])},Allocate:{index:8,layout:N([F("instruction"),Ie("space")])},AllocateWithSeed:{index:9,layout:N([F("instruction"),z("base"),Bt("seed"),Ie("space"),z("programId")])},AssignWithSeed:{index:10,layout:N([F("instruction"),z("base"),Bt("seed"),z("programId")])},TransferWithSeed:{index:11,layout:N([F("instruction"),Ut("lamports"),Bt("seed"),z("programId")])},UpgradeNonceAccount:{index:12,layout:N([F("instruction")])}});new K("11111111111111111111111111111111");new K("BPFLoader2111111111111111111111111111111111");var fc=Object.prototype.toString,dc=Object.keys||function(n){var e=[];for(var t in n)e.push(t);return e};function zt(n,e){var t,r,s,i,o,a,c;if(n===!0)return"true";if(n===!1)return"false";switch(typeof n){case"object":if(n===null)return null;if(n.toJSON&&typeof n.toJSON=="function")return zt(n.toJSON(),e);if(c=fc.call(n),c==="[object Array]"){for(s="[",r=n.length-1,t=0;t<r;t++)s+=zt(n[t],!0)+",";return r>-1&&(s+=zt(n[t],!0)),s+"]"}else if(c==="[object Object]"){for(i=dc(n).sort(),r=i.length,s="",t=0;t<r;)o=i[t],a=zt(n[o],!1),a!==void 0&&(s&&(s+=","),s+=JSON.stringify(o)+":"+a),t++;return"{"+s+"}"}else return JSON.stringify(n);case"function":case"undefined":return e?null:void 0;case"string":return JSON.stringify(n);default:return isFinite(n)?n:null}}var hc=function(n){var e=zt(n,!1);if(e!==void 0)return""+e},bs=hc;const Dt=32;function on(n){let e=0;for(;n>1;)n/=2,e++;return e}function pc(n){return n===0?1:(n--,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>16,n|=n>>32,n+1)}class gc{constructor(e,t,r,s,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=r,this.firstNormalEpoch=s,this.firstNormalSlot=i}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=on(pc(e+Dt+1))-on(Dt)-1,r=this.getSlotsInEpoch(t),s=e-(r-Dt);return[t,s]}else{const t=e-this.firstNormalSlot,r=Math.floor(t/this.slotsPerEpoch),s=this.firstNormalEpoch+r,i=t%this.slotsPerEpoch;return[s,i]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*Dt:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+on(Dt)):this.slotsPerEpoch}}class vs extends Error{constructor(e,t){super(e),this.logs=void 0,this.logs=t}}class $ extends Error{constructor({code:e,message:t,data:r},s){super(s!=null?`${s}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=r,this.name="SolanaJSONRPCError"}}var yc=globalThis.fetch;class mc extends qa{constructor(e,t,r){const s=i=>{const o=Da(i,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(s,e,t,r),this.underlyingSocket=void 0}call(...e){const t=this.underlyingSocket?.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){const t=this.underlyingSocket?.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}const wc=160,bc=64,vc=wc/bc,Sc=1e3/vc;function kc(n,e){let t;try{t=n.layout.decode(e)}catch(r){throw new Error("invalid instruction; "+r)}if(t.typeIndex!==n.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${n.index}`);return t}const Ss=56;class ks{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=kc(Ac,e),r=e.length-Ss;ae(r>=0,"lookup table is invalid"),ae(r%32===0,"lookup table is invalid");const s=r/32,{addresses:i}=N([Se(z(),s,"addresses")]).decode(e.slice(Ss));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new K(t.authority[0]):void 0,addresses:i.map(o=>new K(o))}}}const Ac={index:1,layout:N([F("typeIndex"),Ut("deactivationSlot"),he("lastExtendedSlot"),X("lastExtendedStartIndex"),X(),Se(z(),ht(X(),-1),"authority")])},Ec=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function xc(n){const e=n.match(Ec);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${n}\``);const[t,r,s,i]=e,o=n.startsWith("https:")?"wss:":"ws:",a=s==null?null:parseInt(s.slice(1),10),c=a==null?"":`:${a+1}`;return`${o}//${r}${c}${i}`}const le=ir(qn(K),I(),n=>new K(n)),Li=Dn([I(),se("base64")]),zn=ir(qn(L),Li,n=>L.from(n[0],"base64")),Ic=30*1e3;function _c(n){if(/^https?:/.test(n)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return n}function re(n){let e,t;if(typeof n=="string")e=n;else if(n){const{commitment:r,...s}=n;e=r,t=s}return{commitment:e,config:t}}function Ui(n){return Ee([x({jsonrpc:se("2.0"),id:I(),result:n}),x({jsonrpc:se("2.0"),id:I(),error:x({code:sr(),message:I(),data:q(ua())})})])}const Bc=Ui(sr());function H(n){return ir(Ui(n),Bc,e=>"error"in e?e:{...e,result:_(e.result,n)})}function ce(n){return H(x({context:x({slot:y()}),value:n}))}function Hr(n){return x({context:x({slot:y()}),value:n})}function an(n,e){return n===0?new Rr({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new K(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:Y.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new at(e)}const Rc=x({foundation:y(),foundationTerm:y(),initial:y(),taper:y(),terminal:y()}),Cc=H(B(R(x({epoch:y(),effectiveSlot:y(),amount:y(),postBalance:y(),commission:q(R(y()))})))),Tc=B(x({slot:y(),prioritizationFee:y()})),Pc=x({total:y(),validator:y(),foundation:y(),epoch:y()}),Oc=x({epoch:y(),slotIndex:y(),slotsInEpoch:y(),absoluteSlot:y(),blockHeight:q(y()),transactionCount:q(y())}),Lc=x({slotsPerEpoch:y(),leaderScheduleSlotOffset:y(),warmup:Ge(),firstNormalEpoch:y(),firstNormalSlot:y()}),Uc=yi(I(),B(y())),kt=R(Ee([x({}),I()])),Nc=x({err:kt}),$c=se("receivedSignature"),Fc=x({"solana-core":I(),"feature-set":q(y())}),As=ce(x({err:R(Ee([x({}),I()])),logs:R(B(I())),accounts:q(R(B(R(x({executable:Ge(),owner:I(),lamports:y(),data:B(I()),rentEpoch:q(y())}))))),unitsConsumed:q(y()),returnData:q(R(x({programId:I(),data:Dn([I(),se("base64")])})))})),Kc=ce(x({byIdentity:yi(I(),B(y())),range:x({firstSlot:y(),lastSlot:y()})}));function Mc(n,e,t,r,s,i){const o=t||yc;let a;i!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let c;return r&&(c=async(l,f)=>{const h=await new Promise((d,p)=>{try{r(l,f,(g,m)=>d([g,m]))}catch(g){p(g)}});return await o(...h)}),new $a(async(l,f)=>{const h={method:"POST",body:l,agent:a,headers:Object.assign({"Content-Type":"application/json"},e||{},Mu)};try{let d=5,p,g=500;for(;c?p=await c(n,h):p=await o(n,h),!(p.status!==429||s===!0||(d-=1,d===0));)console.log(`Server responded with ${p.status} ${p.statusText}.  Retrying after ${g}ms delay...`),await It(g),g*=2;const m=await p.text();p.ok?f(null,m):f(new Error(`${p.status} ${p.statusText}: ${m}`))}catch(d){d instanceof Error&&f(d)}},{})}function qc(n){return(e,t)=>new Promise((r,s)=>{n.request(e,t,(i,o)=>{if(i){s(i);return}r(o)})})}function Dc(n){return e=>new Promise((t,r)=>{e.length===0&&t([]);const s=e.map(i=>n.request(i.methodName,i.args));n.request(s,(i,o)=>{if(i){r(i);return}t(o)})})}const Hc=H(Rc),zc=H(Pc),jc=H(Tc),Wc=H(Oc),Gc=H(Lc),Vc=H(Uc),Zc=H(y()),Xc=ce(x({total:y(),circulating:y(),nonCirculating:y(),nonCirculatingAccounts:B(le)})),bn=x({amount:I(),uiAmount:R(y()),decimals:y(),uiAmountString:q(I())}),Jc=ce(B(x({address:le,amount:I(),uiAmount:R(y()),decimals:y(),uiAmountString:q(I())}))),Yc=ce(B(x({pubkey:le,account:x({executable:Ge(),owner:le,lamports:y(),data:zn,rentEpoch:y()})}))),vn=x({program:I(),parsed:sr(),space:y()}),Qc=ce(B(x({pubkey:le,account:x({executable:Ge(),owner:le,lamports:y(),data:vn,rentEpoch:y()})}))),eu=ce(B(x({lamports:y(),address:le}))),Yt=x({executable:Ge(),owner:le,lamports:y(),data:zn,rentEpoch:y()}),tu=x({pubkey:le,account:Yt}),ru=ir(Ee([qn(L),vn]),Ee([Li,vn]),n=>Array.isArray(n)?_(n,zn):n),Sn=x({executable:Ge(),owner:le,lamports:y(),data:ru,rentEpoch:y()}),nu=x({pubkey:le,account:Sn}),su=x({state:Ee([se("active"),se("inactive"),se("activating"),se("deactivating")]),active:y(),inactive:y()}),iu=H(B(x({signature:I(),slot:y(),err:kt,memo:R(I()),blockTime:q(R(y()))}))),ou=H(B(x({signature:I(),slot:y(),err:kt,memo:R(I()),blockTime:q(R(y()))}))),au=x({subscription:y(),result:Hr(Yt)}),cu=x({pubkey:le,account:Yt}),uu=x({subscription:y(),result:Hr(cu)}),lu=x({parent:y(),slot:y(),root:y()}),fu=x({subscription:y(),result:lu}),du=Ee([x({type:Ee([se("firstShredReceived"),se("completed"),se("optimisticConfirmation"),se("root")]),slot:y(),timestamp:y()}),x({type:se("createdBank"),parent:y(),slot:y(),timestamp:y()}),x({type:se("frozen"),slot:y(),timestamp:y(),stats:x({numTransactionEntries:y(),numSuccessfulTransactions:y(),numFailedTransactions:y(),maxTransactionsPerEntry:y()})}),x({type:se("dead"),slot:y(),timestamp:y(),err:I()})]),hu=x({subscription:y(),result:du}),pu=x({subscription:y(),result:Hr(Ee([Nc,$c]))}),gu=x({subscription:y(),result:y()}),yu=x({pubkey:I(),gossip:R(I()),tpu:R(I()),rpc:R(I()),version:R(I())}),Es=x({votePubkey:I(),nodePubkey:I(),activatedStake:y(),epochVoteAccount:Ge(),epochCredits:B(Dn([y(),y(),y()])),commission:y(),lastVote:y(),rootSlot:R(y())}),mu=H(x({current:B(Es),delinquent:B(Es)})),wu=Ee([se("processed"),se("confirmed"),se("finalized")]),bu=x({slot:y(),confirmations:R(y()),err:kt,confirmationStatus:q(wu)}),vu=ce(B(R(bu))),Su=H(y()),Ni=x({accountKey:le,writableIndexes:B(y()),readonlyIndexes:B(y())}),jn=x({signatures:B(I()),message:x({accountKeys:B(I()),header:x({numRequiredSignatures:y(),numReadonlySignedAccounts:y(),numReadonlyUnsignedAccounts:y()}),instructions:B(x({accounts:B(y()),data:I(),programIdIndex:y()})),recentBlockhash:I(),addressTableLookups:q(B(Ni))})}),$i=x({pubkey:le,signer:Ge(),writable:Ge(),source:q(Ee([se("transaction"),se("lookupTable")]))}),Fi=x({accountKeys:B($i),signatures:B(I())}),Ki=x({parsed:sr(),program:I(),programId:le}),Mi=x({accounts:B(le),data:I(),programId:le}),ku=Ee([Mi,Ki]),Au=Ee([x({parsed:sr(),program:I(),programId:I()}),x({accounts:B(I()),data:I(),programId:I()})]),qi=ir(ku,Au,n=>"accounts"in n?_(n,Mi):_(n,Ki)),Di=x({signatures:B(I()),message:x({accountKeys:B($i),instructions:B(qi),recentBlockhash:I(),addressTableLookups:q(R(B(Ni)))})}),Cr=x({accountIndex:y(),mint:I(),owner:q(I()),uiTokenAmount:bn}),Hi=x({writable:B(le),readonly:B(le)}),zr=x({err:kt,fee:y(),innerInstructions:q(R(B(x({index:y(),instructions:B(x({accounts:B(y()),data:I(),programIdIndex:y()}))})))),preBalances:B(y()),postBalances:B(y()),logMessages:q(R(B(I()))),preTokenBalances:q(R(B(Cr))),postTokenBalances:q(R(B(Cr))),loadedAddresses:q(Hi),computeUnitsConsumed:q(y())}),Wn=x({err:kt,fee:y(),innerInstructions:q(R(B(x({index:y(),instructions:B(qi)})))),preBalances:B(y()),postBalances:B(y()),logMessages:q(R(B(I()))),preTokenBalances:q(R(B(Cr))),postTokenBalances:q(R(B(Cr))),loadedAddresses:q(Hi),computeUnitsConsumed:q(y())}),Kt=Ee([se(0),se("legacy")]),At=x({pubkey:I(),lamports:y(),postBalance:R(y()),rewardType:R(I()),commission:q(R(y()))}),Eu=H(R(x({blockhash:I(),previousBlockhash:I(),parentSlot:y(),transactions:B(x({transaction:jn,meta:R(zr),version:q(Kt)})),rewards:q(B(At)),blockTime:R(y()),blockHeight:R(y())}))),xu=H(R(x({blockhash:I(),previousBlockhash:I(),parentSlot:y(),rewards:q(B(At)),blockTime:R(y()),blockHeight:R(y())}))),Iu=H(R(x({blockhash:I(),previousBlockhash:I(),parentSlot:y(),transactions:B(x({transaction:Fi,meta:R(zr),version:q(Kt)})),rewards:q(B(At)),blockTime:R(y()),blockHeight:R(y())}))),_u=H(R(x({blockhash:I(),previousBlockhash:I(),parentSlot:y(),transactions:B(x({transaction:Di,meta:R(Wn),version:q(Kt)})),rewards:q(B(At)),blockTime:R(y()),blockHeight:R(y())}))),Bu=H(R(x({blockhash:I(),previousBlockhash:I(),parentSlot:y(),transactions:B(x({transaction:Fi,meta:R(Wn),version:q(Kt)})),rewards:q(B(At)),blockTime:R(y()),blockHeight:R(y())}))),Ru=H(R(x({blockhash:I(),previousBlockhash:I(),parentSlot:y(),rewards:q(B(At)),blockTime:R(y()),blockHeight:R(y())}))),Cu=H(R(x({blockhash:I(),previousBlockhash:I(),parentSlot:y(),transactions:B(x({transaction:jn,meta:R(zr)})),rewards:q(B(At)),blockTime:R(y())}))),xs=H(R(x({blockhash:I(),previousBlockhash:I(),parentSlot:y(),signatures:B(I()),blockTime:R(y())}))),cn=H(R(x({slot:y(),meta:zr,blockTime:q(R(y())),transaction:jn,version:q(Kt)}))),hr=H(R(x({slot:y(),transaction:Di,meta:R(Wn),blockTime:q(R(y())),version:q(Kt)}))),Tu=ce(x({blockhash:I(),feeCalculator:x({lamportsPerSignature:y()})})),Pu=ce(x({blockhash:I(),lastValidBlockHeight:y()})),Ou=x({slot:y(),numTransactions:y(),numSlots:y(),samplePeriodSecs:y()}),Lu=H(B(Ou)),Uu=ce(R(x({feeCalculator:x({lamportsPerSignature:y()})}))),Nu=H(I()),$u=H(I()),Fu=x({err:kt,logs:B(I()),signature:I()}),Ku=x({result:Hr(Fu),subscription:y()}),Mu={"solana-client":"js/0.0.0-development"};class Gn{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const u={};return async l=>{const{commitment:f,config:h}=re(l),d=this._buildArgs([],f,void 0,h),p=bs(d);return u[p]=u[p]??(async()=>{try{const g=await this._rpcRequest("getBlockHeight",d),m=_(g,H(y()));if("error"in m)throw new $(m.error,"failed to get block height information");return m.result}finally{delete u[p]}})(),await u[p]}})();let r,s,i,o,a,c;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,r=t.wsEndpoint,s=t.httpHeaders,i=t.fetch,o=t.fetchMiddleware,a=t.disableRetryOnRateLimit,c=t.httpAgent),this._rpcEndpoint=_c(e),this._rpcWsEndpoint=r||xc(e),this._rpcClient=Mc(e,s,i,o,a,c),this._rpcRequest=qc(this._rpcClient),this._rpcBatchRequest=Dc(this._rpcClient),this._rpcWebSocket=new mc(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:r,config:s}=re(t),i=this._buildArgs([e.toBase58()],r,void 0,s),o=await this._rpcRequest("getBalance",i),a=_(o,ce(y()));if("error"in a)throw new $(a.error,`failed to get balance for ${e.toBase58()}`);return a.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+r)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),r=_(t,H(R(y())));if("error"in r)throw new $(r.error,`failed to get block time for slot ${e}`);return r.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=_(e,H(y()));if("error"in t)throw new $(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=_(e,Zc);if("error"in t)throw new $(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const r=await this._rpcRequest("getSupply",[t]),s=_(r,Xc);if("error"in s)throw new $(s.error,"failed to get supply");return s.result}async getTokenSupply(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenSupply",r),i=_(s,ce(bn));if("error"in i)throw new $(i.error,"failed to get token supply");return i.result}async getTokenAccountBalance(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenAccountBalance",r),i=_(s,ce(bn));if("error"in i)throw new $(i.error,"failed to get token account balance");return i.result}async getTokenAccountsByOwner(e,t,r){const{commitment:s,config:i}=re(r);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const a=this._buildArgs(o,s,"base64",i),c=await this._rpcRequest("getTokenAccountsByOwner",a),u=_(c,Yc);if("error"in u)throw new $(u.error,`failed to get token accounts owned by account ${e.toBase58()}`);return u.result}async getParsedTokenAccountsByOwner(e,t,r){let s=[e.toBase58()];"mint"in t?s.push({mint:t.mint.toBase58()}):s.push({programId:t.programId.toBase58()});const i=this._buildArgs(s,r,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",i),a=_(o,Qc);if("error"in a)throw new $(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},r=t.filter||t.commitment?[t]:[],s=await this._rpcRequest("getLargestAccounts",r),i=_(s,eu);if("error"in i)throw new $(i.error,"failed to get largest accounts");return i.result}async getTokenLargestAccounts(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenLargestAccounts",r),i=_(s,Jc);if("error"in i)throw new $(i.error,"failed to get token largest accounts");return i.result}async getAccountInfoAndContext(e,t){const{commitment:r,config:s}=re(t),i=this._buildArgs([e.toBase58()],r,"base64",s),o=await this._rpcRequest("getAccountInfo",i),a=_(o,ce(R(Yt)));if("error"in a)throw new $(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getParsedAccountInfo(e,t){const{commitment:r,config:s}=re(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",s),o=await this._rpcRequest("getAccountInfo",i),a=_(o,ce(R(Sn)));if("error"in a)throw new $(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(r){throw new Error("failed to get info about account "+e.toBase58()+": "+r)}}async getMultipleParsedAccounts(e,t){const{commitment:r,config:s}=re(t),i=e.map(u=>u.toBase58()),o=this._buildArgs([i],r,"jsonParsed",s),a=await this._rpcRequest("getMultipleAccounts",o),c=_(a,ce(B(R(Sn))));if("error"in c)throw new $(c.error,`failed to get info for accounts ${i}`);return c.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:r,config:s}=re(t),i=e.map(u=>u.toBase58()),o=this._buildArgs([i],r,"base64",s),a=await this._rpcRequest("getMultipleAccounts",o),c=_(a,ce(B(R(Yt))));if("error"in c)throw new $(c.error,`failed to get info for accounts ${i}`);return c.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,r){const{commitment:s,config:i}=re(t),o=this._buildArgs([e.toBase58()],s,void 0,{...i,epoch:r??i?.epoch}),a=await this._rpcRequest("getStakeActivation",o),c=_(a,H(su));if("error"in c)throw new $(c.error,`failed to get Stake Activation ${e.toBase58()}`);return c.result}async getProgramAccounts(e,t){const{commitment:r,config:s}=re(t),{encoding:i,...o}=s||{},a=this._buildArgs([e.toBase58()],r,i||"base64",o),c=await this._rpcRequest("getProgramAccounts",a),u=_(c,H(B(tu)));if("error"in u)throw new $(u.error,`failed to get accounts owned by program ${e.toBase58()}`);return u.result}async getParsedProgramAccounts(e,t){const{commitment:r,config:s}=re(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",s),o=await this._rpcRequest("getProgramAccounts",i),a=_(o,H(B(nu)));if("error"in a)throw new $(a.error,`failed to get accounts owned by program ${e.toBase58()}`);return a.result}async confirmTransaction(e,t){let r;if(typeof e=="string")r=e;else{const i=e;if(i.abortSignal?.aborted)return Promise.reject(i.abortSignal.reason);r=i.signature}let s;try{s=Y.decode(r)}catch{throw new Error("signature must be base58 encoded: "+r)}return ae(s.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:r}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,r)=>{e!=null&&(e.aborted?r(e.reason):e.addEventListener("abort",()=>{r(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let r,s,i=!1;const o=new Promise((c,u)=>{try{r=this.onSignature(t,(f,h)=>{r=void 0;const d={context:h,value:f};c({__type:Fe.PROCESSED,response:d})},e);const l=new Promise(f=>{r==null?f():s=this._onSubscriptionStateChange(r,h=>{h==="subscribed"&&f()})});(async()=>{if(await l,i)return;const f=await this.getSignatureStatus(t);if(i||f==null)return;const{context:h,value:d}=f;if(d!=null)if(d?.err)u(d.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(d.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(d.confirmationStatus==="processed"||d.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}i=!0,c({__type:Fe.PROCESSED,response:{context:h,value:d}})}})()}catch(l){u(l)}});return{abortConfirmation:()=>{s&&(s(),s=void 0),r!=null&&(this.removeSignatureListener(r),r=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:r,signature:s}}){let i=!1;const o=new Promise(f=>{const h=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let d=await h();if(!i){for(;d<=r;)if(await It(1e3),i||(d=await h(),i))return;f({__type:Fe.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:a,confirmationPromise:c}=this.getTransactionConfirmationPromise({commitment:e,signature:s}),u=this.getCancellationPromise(t);let l;try{const f=await Promise.race([u,c,o]);if(f.__type===Fe.PROCESSED)l=f.response;else throw new Ti(s)}finally{i=!0,a()}return l}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:r,nonceAccountPubkey:s,nonceValue:i,signature:o}}){let a=!1;const c=new Promise(d=>{let p=i,g=null;const m=async()=>{try{const{context:k,value:b}=await this.getNonceAndContext(s,{commitment:e,minContextSlot:r});return g=k.slot,b?.nonce}catch{return p}};(async()=>{if(p=await m(),!a)for(;;){if(i!==p){d({__type:Fe.NONCE_INVALID,slotInWhichNonceDidAdvance:g});return}if(await It(2e3),a||(p=await m(),a))return}})()}),{abortConfirmation:u,confirmationPromise:l}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),f=this.getCancellationPromise(t);let h;try{const d=await Promise.race([f,l,c]);if(d.__type===Fe.PROCESSED)h=d.response;else{let p;for(;;){const g=await this.getSignatureStatus(o);if(g==null)break;if(g.context.slot<(d.slotInWhichNonceDidAdvance??r)){await It(400);continue}p=g;break}if(p?.value){const g=e||"finalized",{confirmationStatus:m}=p.value;switch(g){case"processed":case"recent":if(m!=="processed"&&m!=="confirmed"&&m!=="finalized")throw new Ht(o);break;case"confirmed":case"single":case"singleGossip":if(m!=="confirmed"&&m!=="finalized")throw new Ht(o);break;case"finalized":case"max":case"root":if(m!=="finalized")throw new Ht(o);break;default:(k=>{})(g)}h={context:p.context,value:{err:p.value.err}}}else throw new Ht(o)}}finally{a=!0,u()}return h}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let r;const s=new Promise(c=>{let u=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{u=this._confirmTransactionInitialTimeout||3e4;break}}r=setTimeout(()=>c({__type:Fe.TIMED_OUT,timeoutMs:u}),u)}),{abortConfirmation:i,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let a;try{const c=await Promise.race([o,s]);if(c.__type===Fe.PROCESSED)a=c.response;else throw new Pi(t,c.timeoutMs/1e3)}finally{clearTimeout(r),i()}return a}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=_(e,H(B(yu)));if("error"in t)throw new $(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getVoteAccounts",t),s=_(r,mu);if("error"in s)throw new $(s.error,"failed to get vote accounts");return s.result}async getSlot(e){const{commitment:t,config:r}=re(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlot",s),o=_(i,H(y()));if("error"in o)throw new $(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:r}=re(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlotLeader",s),o=_(i,H(I()));if("error"in o)throw new $(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const r=[e,t],s=await this._rpcRequest("getSlotLeaders",r),i=_(s,H(B(le)));if("error"in i)throw new $(i.error,"failed to get slot leaders");return i.result}async getSignatureStatus(e,t){const{context:r,value:s}=await this.getSignatureStatuses([e],t);ae(s.length===1);const i=s[0];return{context:r,value:i}}async getSignatureStatuses(e,t){const r=[e];t&&r.push(t);const s=await this._rpcRequest("getSignatureStatuses",r),i=_(s,vu);if("error"in i)throw new $(i.error,"failed to get signature status");return i.result}async getTransactionCount(e){const{commitment:t,config:r}=re(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getTransactionCount",s),o=_(i,H(y()));if("error"in o)throw new $(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getInflationGovernor",t),s=_(r,Hc);if("error"in s)throw new $(s.error,"failed to get inflation");return s.result}async getInflationReward(e,t,r){const{commitment:s,config:i}=re(r),o=this._buildArgs([e.map(u=>u.toBase58())],s,void 0,{...i,epoch:t??i?.epoch}),a=await this._rpcRequest("getInflationReward",o),c=_(a,Cc);if("error"in c)throw new $(c.error,"failed to get inflation reward");return c.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=_(e,zc);if("error"in t)throw new $(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:r}=re(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getEpochInfo",s),o=_(i,Wc);if("error"in o)throw new $(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=_(e,Gc);if("error"in t)throw new $(t.error,"failed to get epoch schedule");const r=t.result;return new gc(r.slotsPerEpoch,r.leaderScheduleSlotOffset,r.warmup,r.firstNormalEpoch,r.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=_(e,Vc);if("error"in t)throw new $(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const r=this._buildArgs([e],t),s=await this._rpcRequest("getMinimumBalanceForRentExemption",r),i=_(s,Su);return"error"in i?(console.warn("Unable to fetch minimum balance for rent exemption"),0):i.result}async getRecentBlockhashAndContext(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getRecentBlockhash",t),s=_(r,Tu);if("error"in s)throw new $(s.error,"failed to get recent blockhash");return s.result}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),r=_(t,Lu);if("error"in r)throw new $(r.error,"failed to get recent performance samples");return r.result}async getFeeCalculatorForBlockhash(e,t){const r=this._buildArgs([e],t),s=await this._rpcRequest("getFeeCalculatorForBlockhash",r),i=_(s,Uu);if("error"in i)throw new $(i.error,"failed to get fee calculator");const{context:o,value:a}=i.result;return{context:o,value:a!==null?a.feeCalculator:null}}async getFeeForMessage(e,t){const r=Lt(e.serialize()).toString("base64"),s=this._buildArgs([r],t),i=await this._rpcRequest("getFeeForMessage",s),o=_(i,ce(R(y())));if("error"in o)throw new $(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){const t=e?.lockedWritableAccounts?.map(o=>o.toBase58()),r=this._buildArgs(t?.length?[t]:[]),s=await this._rpcRequest("getRecentPrioritizationFees",r),i=_(s,jc);if("error"in i)throw new $(i.error,"failed to get recent prioritization fees");return i.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:r}=re(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getLatestBlockhash",s),o=_(i,Pu);if("error"in o)throw new $(o.error,"failed to get latest blockhash");return o.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=_(e,H(Fc));if("error"in t)throw new $(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=_(e,H(I()));if("error"in t)throw new $(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:r,config:s}=re(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,s),o=await this._rpcRequest("getBlock",i);try{switch(s?.transactionDetails){case"accounts":{const a=_(o,Iu);if("error"in a)throw a.error;return a.result}case"none":{const a=_(o,xu);if("error"in a)throw a.error;return a.result}default:{const a=_(o,Eu);if("error"in a)throw a.error;const{result:c}=a;return c?{...c,transactions:c.transactions.map(({transaction:u,meta:l,version:f})=>({meta:l,transaction:{...u,message:an(f,u.message)},version:f}))}:null}}}catch(a){throw new $(a,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:r,config:s}=re(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",s),o=await this._rpcRequest("getBlock",i);try{switch(s?.transactionDetails){case"accounts":{const a=_(o,Bu);if("error"in a)throw a.error;return a.result}case"none":{const a=_(o,Ru);if("error"in a)throw a.error;return a.result}default:{const a=_(o,_u);if("error"in a)throw a.error;return a.result}}}catch(a){throw new $(a,"failed to get block")}}async getBlockProduction(e){let t,r;if(typeof e=="string")r=e;else if(e){const{commitment:a,...c}=e;r=a,t=c}const s=this._buildArgs([],r,"base64",t),i=await this._rpcRequest("getBlockProduction",s),o=_(i,Kc);if("error"in o)throw new $(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:r,config:s}=re(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,s),o=await this._rpcRequest("getTransaction",i),a=_(o,cn);if("error"in a)throw new $(a.error,"failed to get transaction");const c=a.result;return c&&{...c,transaction:{...c.transaction,message:an(c.version,c.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:r,config:s}=re(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",s),o=await this._rpcRequest("getTransaction",i),a=_(o,hr);if("error"in a)throw new $(a.error,"failed to get transaction");return a.result}async getParsedTransactions(e,t){const{commitment:r,config:s}=re(t),i=e.map(c=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([c],r,"jsonParsed",s)}));return(await this._rpcBatchRequest(i)).map(c=>{const u=_(c,hr);if("error"in u)throw new $(u.error,"failed to get transactions");return u.result})}async getTransactions(e,t){const{commitment:r,config:s}=re(t),i=e.map(c=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([c],r,void 0,s)}));return(await this._rpcBatchRequest(i)).map(c=>{const u=_(c,cn);if("error"in u)throw new $(u.error,"failed to get transactions");const l=u.result;return l&&{...l,transaction:{...l.transaction,message:an(l.version,l.transaction.message)}}})}async getConfirmedBlock(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),s=await this._rpcRequest("getConfirmedBlock",r),i=_(s,Cu);if("error"in i)throw new $(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");const a={...o,transactions:o.transactions.map(({transaction:c,meta:u})=>{const l=new at(c.message);return{meta:u,transaction:{...c,message:l}}})};return{...a,transactions:a.transactions.map(({transaction:c,meta:u})=>({meta:u,transaction:tt.populate(c.message,c.signatures)}))}}async getBlocks(e,t,r){const s=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],r),i=await this._rpcRequest("getBlocks",s),o=_(i,H(B(y())));if("error"in o)throw new $(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getBlock",r),i=_(s,xs);if("error"in i)throw new $(i.error,"failed to get block");const o=i.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getConfirmedBlock",r),i=_(s,xs);if("error"in i)throw new $(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),s=await this._rpcRequest("getConfirmedTransaction",r),i=_(s,cn);if("error"in i)throw new $(i.error,"failed to get transaction");const o=i.result;if(!o)return o;const a=new at(o.transaction.message),c=o.transaction.signatures;return{...o,transaction:tt.populate(a,c)}}async getParsedConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),s=await this._rpcRequest("getConfirmedTransaction",r),i=_(s,hr);if("error"in i)throw new $(i.error,"failed to get confirmed transaction");return i.result}async getParsedConfirmedTransactions(e,t){const r=e.map(o=>({methodName:"getConfirmedTransaction",args:this._buildArgsAtLeastConfirmed([o],t,"jsonParsed")}));return(await this._rpcBatchRequest(r)).map(o=>{const a=_(o,hr);if("error"in a)throw new $(a.error,"failed to get confirmed transactions");return a.result})}async getConfirmedSignaturesForAddress(e,t,r){let s={},i=await this.getFirstAvailableBlock();for(;!("until"in s)&&(t--,!(t<=0||t<i));)try{const c=await this.getConfirmedBlockSignatures(t,"finalized");c.signatures.length>0&&(s.until=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}let o=await this.getSlot("finalized");for(;!("before"in s)&&(r++,!(r>o));)try{const c=await this.getConfirmedBlockSignatures(r);c.signatures.length>0&&(s.before=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}return(await this.getConfirmedSignaturesForAddress2(e,s)).map(c=>c.signature)}async getConfirmedSignaturesForAddress2(e,t,r){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getConfirmedSignaturesForAddress2",s),o=_(i,iu);if("error"in o)throw new $(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,r){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getSignaturesForAddress",s),o=_(i,ou);if("error"in o)throw new $(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:r,value:s}=await this.getAccountInfoAndContext(e,t);let i=null;return s!==null&&(i=new ks({key:e,state:ks.deserialize(s.data)})),{context:r,value:i}}async getNonceAndContext(e,t){const{context:r,value:s}=await this.getAccountInfoAndContext(e,t);let i=null;return s!==null&&(i=Hn.fromAccountData(s.data)),{context:r,value:i}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+r)})}async requestAirdrop(e,t){const r=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),s=_(r,Nu);if("error"in s)throw new $(s.error,`airdrop to ${e.toBase58()} failed`);return s.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await It(100);const r=Date.now()-this._blockhashInfo.lastFetch>=Ic;if(this._blockhashInfo.latestBlockhash!==null&&!r)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,r=t?t.blockhash:null;for(let s=0;s<50;s++){const i=await this.getLatestBlockhash("finalized");if(r!==i.blockhash)return this._blockhashInfo={latestBlockhash:i,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},i;await It(Sc/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:r}=re(e),s=this._buildArgs([],t,"base64",r),i=await this._rpcRequest("getStakeMinimumDelegation",s),o=_(i,ce(y()));if("error"in o)throw new $(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,r){if("message"in e){const g=e.serialize(),m=L.from(g).toString("base64");if(Array.isArray(t)||r!==void 0)throw new Error("Invalid arguments");const k=t||{};k.encoding="base64","commitment"in k||(k.commitment=this.commitment);const b=[m,k],S=await this._rpcRequest("simulateTransaction",b),T=_(S,As);if("error"in T)throw new Error("failed to simulate transaction: "+T.error.message);return T.result}let s;if(e instanceof tt){let p=e;s=new tt,s.feePayer=p.feePayer,s.instructions=e.instructions,s.nonceInfo=p.nonceInfo,s.signatures=p.signatures}else s=tt.populate(e),s._message=s._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(s.nonceInfo&&i)s.sign(...i);else{let p=this._disableBlockhashCaching;for(;;){const g=await this._blockhashWithExpiryBlockHeight(p);if(s.lastValidBlockHeight=g.lastValidBlockHeight,s.recentBlockhash=g.blockhash,!i)break;if(s.sign(...i),!s.signature)throw new Error("!signature");const m=s.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(m)&&!this._blockhashInfo.transactionSignatures.includes(m)){this._blockhashInfo.simulatedSignatures.push(m);break}else p=!0}}const o=s._compile(),a=o.serialize(),u=s._serialize(a).toString("base64"),l={encoding:"base64",commitment:this.commitment};if(r){const p=(Array.isArray(r)?r:o.nonProgramIds()).map(g=>g.toBase58());l.accounts={encoding:"base64",addresses:p}}i&&(l.sigVerify=!0);const f=[u,l],h=await this._rpcRequest("simulateTransaction",f),d=_(h,As);if("error"in d){let p;if("data"in d.error&&(p=d.error.data.logs,p&&Array.isArray(p))){const g=`
    `,m=g+p.join(g);console.error(d.error.message,m)}throw new vs("failed to simulate transaction: "+d.error.message,p)}return d.result}async sendTransaction(e,t,r){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(e.nonceInfo)e.sign(...s);else{let o=this._disableBlockhashCaching;for(;;){const a=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=a.lastValidBlockHeight,e.recentBlockhash=a.blockhash,e.sign(...s),!e.signature)throw new Error("!signature");const c=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(c))o=!0;else{this._blockhashInfo.transactionSignatures.push(c);break}}}const i=e.serialize();return await this.sendRawTransaction(i,r)}async sendRawTransaction(e,t){const r=Lt(e).toString("base64");return await this.sendEncodedTransaction(r,t)}async sendEncodedTransaction(e,t){const r={encoding:"base64"},s=t&&t.skipPreflight,i=t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(r.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(r.minContextSlot=t.minContextSlot),s&&(r.skipPreflight=s),i&&(r.preflightCommitment=i);const o=[e,r],a=await this._rpcRequest("sendTransaction",o),c=_(a,$u);if("error"in c){let u;throw"data"in c.error&&(u=c.error.data.logs),new vs("failed to send transaction: "+c.error.message,u)}return c.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,r])=>{this._setSubscription(t,{...r,state:"pending"})})}_setSubscription(e,t){const r=this._subscriptionsByHash[e]?.state;if(this._subscriptionsByHash[e]=t,r!==t.state){const s=this._subscriptionStateChangeCallbacksByHash[e];s&&s.forEach(i=>{try{i(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){var r;const s=this._subscriptionHashByClientSubscriptionId[e];if(s==null)return()=>{};const i=(r=this._subscriptionStateChangeCallbacksByHash)[s]||(r[s]=new Set);return i.add(t),()=>{i.delete(t),i.size===0&&delete this._subscriptionStateChangeCallbacksByHash[s]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(r){r instanceof Error&&console.log(`Error when closing socket connection: ${r.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async r=>{const s=this._subscriptionsByHash[r];if(s!==void 0)switch(s.state){case"pending":case"unsubscribed":if(s.callbacks.size===0){delete this._subscriptionsByHash[r],s.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[s.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:i,method:o}=s;try{this._setSubscription(r,{...s,state:"subscribing"});const a=await this._rpcWebSocket.call(o,i);this._setSubscription(r,{...s,serverSubscriptionId:a,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[a]=s.callbacks,await this._updateSubscriptions()}catch(a){if(a instanceof Error&&console.error(`${o} error for argument`,i,a.message),!t())return;this._setSubscription(r,{...s,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":s.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:i,unsubscribeMethod:o}=s;if(this._subscriptionsAutoDisposedByRpc.has(i))this._subscriptionsAutoDisposedByRpc.delete(i);else{this._setSubscription(r,{...s,state:"unsubscribing"}),this._setSubscription(r,{...s,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[i])}catch(a){if(a instanceof Error&&console.error(`${o} error:`,a.message),!t())return;this._setSubscription(r,{...s,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(r,{...s,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const r=this._subscriptionCallbacksByServerSubscriptionId[e];r!==void 0&&r.forEach(s=>{try{s(...t)}catch(i){console.error(i)}})}_wsOnAccountNotification(e){const{result:t,subscription:r}=_(e,au);this._handleServerNotification(r,[t.value,t.context])}_makeSubscription(e,t){const r=this._nextClientSubscriptionId++,s=bs([e.method,t]),i=this._subscriptionsByHash[s];return i===void 0?this._subscriptionsByHash[s]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:i.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[r]=s,this._subscriptionDisposeFunctionsByClientSubscriptionId[r]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[r],delete this._subscriptionHashByClientSubscriptionId[r];const o=this._subscriptionsByHash[s];ae(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${r}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),r}onAccountChange(e,t,r){const s=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},s)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:r}=_(e,uu);this._handleServerNotification(r,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,r,s){const i=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64",s?{filters:s}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},i)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,r){const s=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],r||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},s)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:r}=_(e,Ku);this._handleServerNotification(r,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:r}=_(e,fu);this._handleServerNotification(r,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:r}=_(e,hu);this._handleServerNotification(r,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const r=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];r?await r():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,r,s){const i=t||this._commitment;if(i||r||s){let o={};r&&(o.encoding=r),i&&(o.commitment=i),s&&(o=Object.assign(o,s)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,r,s){const i=t||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,r,s)}_wsOnSignatureNotification(e){const{result:t,subscription:r}=_(e,pu);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(r),this._handleServerNotification(r,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,r){const s=this._buildArgs([e],r||this._commitment||"finalized"),i=this._makeSubscription({callback:(o,a)=>{if(o.type==="status"){t(o.result,a);try{this.removeSignatureListener(i)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},s);return i}onSignatureWithOptions(e,t,r){const{commitment:s,...i}={...r,commitment:r&&r.commitment||this._commitment||"finalized"},o=this._buildArgs([e],s,void 0,i),a=this._makeSubscription({callback:(c,u)=>{t(c,u);try{this.removeSignatureListener(a)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return a}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:r}=_(e,gu);this._handleServerNotification(r,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class Vt{constructor(e){this._keypair=void 0,this._keypair=e??gs()}static generate(){return new Vt(gs())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const r=e.slice(32,64);if(!t||!t.skipValidation){const s=e.slice(0,32),i=mn(s);for(let o=0;o<32;o++)if(r[o]!==i[o])throw new Error("provided secretKey is invalid")}return new Vt({publicKey:r,secretKey:e})}static fromSeed(e){const t=mn(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),new Vt({publicKey:t,secretKey:r})}get publicKey(){return new K(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}Object.freeze({CreateLookupTable:{index:0,layout:N([F("instruction"),Ut("recentSlot"),X("bumpSeed")])},FreezeLookupTable:{index:1,layout:N([F("instruction")])},ExtendLookupTable:{index:2,layout:N([F("instruction"),Ut(),Se(z(),ht(F(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:N([F("instruction")])},CloseLookupTable:{index:4,layout:N([F("instruction")])}});new K("AddressLookupTab1e1111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:N([X("instruction"),F("units"),F("additionalFee")])},RequestHeapFrame:{index:1,layout:N([X("instruction"),F("bytes")])},SetComputeUnitLimit:{index:2,layout:N([X("instruction"),F("units")])},SetComputeUnitPrice:{index:3,layout:N([X("instruction"),Ut("microLamports")])}});new K("ComputeBudget111111111111111111111111111111");N([X("numSignatures"),X("padding"),Ce("signatureOffset"),Ce("signatureInstructionIndex"),Ce("publicKeyOffset"),Ce("publicKeyInstructionIndex"),Ce("messageDataOffset"),Ce("messageDataSize"),Ce("messageInstructionIndex")]);new K("Ed25519SigVerify111111111111111111111111111");dt.hmacSha256Sync=(n,...e)=>{const t=no.create(un,n);return e.forEach(r=>t.update(r)),t.digest()};dt.isValidPrivateKey;N([X("numSignatures"),Ce("signatureOffset"),X("signatureInstructionIndex"),Ce("ethAddressOffset"),X("ethAddressInstructionIndex"),Ce("messageDataOffset"),Ce("messageDataSize"),X("messageInstructionIndex"),ie(20,"ethAddress"),ie(64,"signature"),X("recoveryId")]);new K("KeccakSecp256k11111111111111111111111111111");new K("StakeConfig11111111111111111111111111111111");class Is{constructor(e,t,r){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=r}}Is.default=new Is(0,0,K.default);Object.freeze({Initialize:{index:0,layout:N([F("instruction"),nc(),sc()])},Authorize:{index:1,layout:N([F("instruction"),z("newAuthorized"),F("stakeAuthorizationType")])},Delegate:{index:2,layout:N([F("instruction")])},Split:{index:3,layout:N([F("instruction"),Ie("lamports")])},Withdraw:{index:4,layout:N([F("instruction"),Ie("lamports")])},Deactivate:{index:5,layout:N([F("instruction")])},Merge:{index:7,layout:N([F("instruction")])},AuthorizeWithSeed:{index:8,layout:N([F("instruction"),z("newAuthorized"),F("stakeAuthorizationType"),Bt("authoritySeed"),z("authorityOwner")])}});new K("Stake11111111111111111111111111111111111111");Object.freeze({InitializeAccount:{index:0,layout:N([F("instruction"),ic()])},Authorize:{index:1,layout:N([F("instruction"),z("newAuthorized"),F("voteAuthorizationType")])},Withdraw:{index:3,layout:N([F("instruction"),Ie("lamports")])},AuthorizeWithSeed:{index:10,layout:N([F("instruction"),oc()])}});new K("Vote111111111111111111111111111111111111111");new K("Va1idator1nfo111111111111111111111111111111");x({name:I(),website:q(I()),details:q(I()),keybaseUsername:q(I())});new K("Vote111111111111111111111111111111111111111");N([z("nodePubkey"),z("authorizedWithdrawer"),X("commission"),he(),Se(N([he("slot"),F("confirmationCount")]),ht(F(),-8),"votes"),X("rootSlotValid"),he("rootSlot"),he(),Se(N([he("epoch"),z("authorizedVoter")]),ht(F(),-8),"authorizedVoters"),N([Se(N([z("authorizedPubkey"),he("epochOfLastAuthorizedSwitch"),he("targetEpoch")]),32,"buf"),he("idx"),X("isEmpty")],"priorVoters"),he(),Se(N([he("epoch"),he("credits"),he("prevCredits")]),ht(F(),-8),"epochCredits"),N([he("slot"),he("timestamp")],"lastTimestamp")]);function qu(n){return function(e,t,r,s){return e.method==="solana_chainId"?(t.result=n,s()):r()}}function Du(n){return function(e,t,r,s){return e.method==="solana_provider_config"?(t.result=n,s()):r()}}function zi(n){var e=n.chainId;return Qt([qu(e),Du(n)])}function Hu(n){var e=n.rpcTarget,t=so({rpcTarget:e}),r=Qt([zi(n),t]);return{networkMiddleware:r,fetchMiddleware:t}}function zu(n){var e=n.getAccounts;return Pr(function(){var t=P(v.mark(function r(s,i,o){var a,c;return v.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=s.method,a==="getAccounts"){l.next=3;break}return l.abrupt("return",o());case 3:if(e){l.next=5;break}throw new Error("WalletMiddleware - opts.getAccounts not provided");case 5:return l.next=7,e(s);case 7:return c=l.sent,i.result=c,l.abrupt("return",void 0);case 10:case"end":return l.stop()}},r)}));return function(r,s,i){return t.apply(this,arguments)}}())}function ju(n){var e=n.requestAccounts;return Pr(function(){var t=P(v.mark(function r(s,i,o){var a,c;return v.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=s.method,a==="requestAccounts"){l.next=3;break}return l.abrupt("return",o());case 3:if(e){l.next=5;break}throw new Error("WalletMiddleware - opts.requestAccounts not provided");case 5:return l.next=7,e(s);case 7:return c=l.sent,i.result=c,l.abrupt("return",void 0);case 10:case"end":return l.stop()}},r)}));return function(r,s,i){return t.apply(this,arguments)}}())}function je(n,e){return Pr(function(){var t=P(v.mark(function r(s,i,o){var a,c;return v.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=s.method,a===n){l.next=3;break}return l.abrupt("return",o());case 3:if(e){l.next=5;break}throw new Error("WalletMiddleware - ".concat(n," not provided"));case 5:return l.next=7,e(s);case 7:return c=l.sent,i.result=c,l.abrupt("return",void 0);case 10:case"end":return l.stop()}},r)}));return function(r,s,i){return t.apply(this,arguments)}}())}function Vn(n){var e=n.getAccounts,t=n.requestAccounts,r=n.signTransaction,s=n.signAndSendTransaction,i=n.signAllTransactions,o=n.signMessage,a=n.getPrivateKey,c=n.getSecretKey;return Qt([ju({requestAccounts:t}),zu({getAccounts:e}),je("signTransaction",r),je("signAndSendTransaction",s),je("signAllTransactions",i),je("signMessage",o),je("solanaPrivateKey",a),je("solanaSecretKey",c)])}function Wu(n){var e=n.addNewChainConfig,t=n.switchSolanaChain;return Qt([je("addSolanaChain",e),je("switchSolanaChain",t)])}function Gu(n){var e=n.updatePrivatekey;return Qt([je("updateAccount",e)])}function _s(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Bs(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?_s(Object(t),!0).forEach(function(r){Nt(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):_s(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Vu(n){var e=Zu();return function(){var r=Ae(n),s;if(e){var i=Ae(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return bt(this,s)}}function Zu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jr=function(n){wt(t,n);var e=Vu(t);function t(r){var s=r.config,i=r.state;return ct(this,t),e.call(this,{config:{chainConfig:Bs(Bs({},s.chainConfig),{},{chainNamespace:yr.SOLANA})},state:i})}return ut(t,[{key:"switchChain",value:function(){var r=P(v.mark(function i(o){return v.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Promise.resolve());case 1:case"end":return c.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"setupProvider",value:function(){var r=P(v.mark(function i(o){var a,c,u,l,f,h;return v.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return a=new xn,c=this.getProviderHandlers(o),u=Vn(c),a.push(u),l=zi(this.config.chainConfig),a.push(l),f=this.getInjectedProviderProxy(o),f&&a.push(f),h=In(a),this.updateProviderEngineProxy(h),p.next=12,this.lookupNetwork();case 12:case"end":return p.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"lookupNetwork",value:function(){var r=P(v.mark(function i(){var o;return v.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=this.config.chainConfig,this.update({chainId:o.chainId}),c.abrupt("return",o.chainId||"");case 3:case"end":return c.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"getInjectedProviderProxy",value:function(s){}}]),t}(An),Zn=function(e){var t={requestAccounts:function(){var r=P(v.mark(function i(){return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e.publicKey?[Y.encode(e.publicKey.toBytes())]:[]);case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getAccounts:function(){var r=P(v.mark(function i(){return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e.publicKey?[Y.encode(e.publicKey.toBytes())]:[]);case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getPrivateKey:function(){var r=P(v.mark(function i(){return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw j.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getSecretKey:function(){var r=P(v.mark(function i(){return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw j.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),signTransaction:function(){var r=P(v.mark(function i(o){var a;return v.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,e.signTransaction(o.params.message);case 2:return a=u.sent,u.abrupt("return",a);case 4:case"end":return u.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signMessage:function(){var r=P(v.mark(function i(o){var a;return v.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,e.signMessage(o.params.message,o.params.display);case 2:return a=u.sent,u.abrupt("return",a.signature);case 4:case"end":return u.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAllTransactions:function(){var r=P(v.mark(function i(o){var a,c,u;return v.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(!((a=o.params)!==null&&a!==void 0&&a.message)||!((c=o.params)!==null&&c!==void 0&&c.message.length))){f.next=2;break}throw j.ethErrors.rpc.invalidParams("message");case 2:return f.next=4,e.signAllTransactions(o.params.message);case 4:return u=f.sent,f.abrupt("return",u);case 6:case"end":return f.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAndSendTransaction:function(){var r=P(v.mark(function i(o){var a;return v.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,e.signAndSendTransaction(o.params.message);case 2:return a=u.sent,u.abrupt("return",{signature:a.signature});case 4:case"end":return u.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()};return t};function Rs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Xu(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Rs(Object(t),!0).forEach(function(r){Nt(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Rs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function ji(n){return Pr(function(){var e=P(v.mark(function t(r,s,i){var o;return v.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,n.request(Xu({},r));case 2:o=c.sent,s.result=o;case 4:case"end":return c.stop()}},t)}));return function(t,r,s){return e.apply(this,arguments)}}())}function Ju(n){var e=Yu();return function(){var r=Ae(n),s;if(e){var i=Ae(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return bt(this,s)}}function Yu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vl=function(n){wt(t,n);var e=Ju(t);function t(){return ct(this,t),e.apply(this,arguments)}return ut(t,[{key:"getProviderHandlers",value:function(s){return Zn(s)}},{key:"getInjectedProviderProxy",value:function(s){return ji(s)}}]),t}(jr),Qu=function(e,t){var r={requestAccounts:function(){var s=P(v.mark(function o(){var a,c;return v.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,e.connect();case 2:return a=l.sent,c=a.data,l.abrupt("return",[c.publicKey]);case 5:case"end":return l.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),getAccounts:function(){var s=P(v.mark(function o(){var a,c;return v.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,e.connect();case 2:return a=l.sent,c=a.data,l.abrupt("return",[c.publicKey]);case 5:case"end":return l.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),getPrivateKey:function(){var s=P(v.mark(function o(){return v.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:throw j.ethErrors.rpc.methodNotSupported();case 1:case"end":return c.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),getSecretKey:function(){var s=P(v.mark(function o(){return v.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:throw j.ethErrors.rpc.methodNotSupported();case 1:case"end":return c.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),signTransaction:function(){var s=P(v.mark(function o(a){var c,u,l,f,h;return v.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(c=a.params.message,c){p.next=3;break}throw j.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});case 3:return p.next=5,e.signTransaction(Y.encode(c.serializeMessage()));case 5:if(u=p.sent,l=u.data,!(!l.publicKey||!l.signature)){p.next=9;break}throw new Error("Invalid signature from slope wallet");case 9:return f=new K(l.publicKey),h=Y.decode(l.signature),c.addSignature(f,L.from(h)),p.abrupt("return",c);case 13:case"end":return p.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}(),signMessage:function(){var s=P(v.mark(function o(a){var c;return v.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,e.signMessage(a.params.message);case 2:return c=l.sent,l.abrupt("return",Y.decode(c.data.signature));case 4:case"end":return l.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}(),signAndSendTransaction:function(){var s=P(v.mark(function o(a){var c,u,l,f,h,d,p,g,m;return v.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(c=t(),c){b.next=3;break}throw j.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:if(u=a.params.message,u){b.next=6;break}throw j.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});case 6:return b.next=8,e.signTransaction(Y.encode(u.serializeMessage()));case 8:if(l=b.sent,f=l.data,!(!f.publicKey||!f.signature)){b.next=12;break}throw new Error("Invalid signature from slope wallet");case 12:return h=new K(f.publicKey),d=Y.decode(f.signature),u.addSignature(h,L.from(d)),b.next=17,c.request({method:"solana_provider_config",params:[]});case 17:return p=b.sent,g=new Gn(p.rpcTarget),b.next=21,g.sendRawTransaction(u.serialize());case 21:return m=b.sent,b.abrupt("return",{signature:m});case 23:case"end":return b.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}(),signAllTransactions:function(){var s=P(v.mark(function o(a){var c,u,l,f,h,d,p,g,m,k,b,S;return v.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(!((c=a.params)!==null&&c!==void 0&&c.message)||!((u=a.params)!==null&&u!==void 0&&u.message.length))){E.next=2;break}throw j.ethErrors.rpc.invalidParams("message");case 2:for(f=a.params.message,h=f.length,d=[],p=0;p<h;p++)d.push(Y.encode(a.params.message[p].serializeMessage()));return E.next=8,e.signAllTransactions(d);case 8:if(g=E.sent,m=g.msg,k=g.data,!(!k.publicKey||((l=k.signatures)===null||l===void 0?void 0:l.length)!==h)){E.next=13;break}throw new Error(m);case 13:for(b=new K(k.publicKey),p=0;p<h;p++)S=Y.decode(k.signatures[p]),f[p].addSignature(b,L.from(S));return E.abrupt("return",f);case 16:case"end":return E.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}()};return r};function el(n){var e=tl();return function(){var r=Ae(n),s;if(e){var i=Ae(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return bt(this,s)}}function tl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Sl=function(n){wt(t,n);var e=el(t);function t(){return ct(this,t),e.apply(this,arguments)}return ut(t,[{key:"getProviderHandlers",value:function(s){return Qu(s,this.getProviderEngineProxy.bind(this))}}]),t}(jr),rl=function(e,t){var r=Zn(e);return r.signAndSendTransaction=function(){var s=P(v.mark(function i(o){var a,c,u,l,f;return v.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(a=t(),a){d.next=3;break}throw j.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return d.next=5,e.signTransaction(o.params.message);case 5:return c=d.sent,d.next=8,a.request({method:"solana_provider_config",params:[]});case 8:return u=d.sent,l=new Gn(u.rpcTarget),d.next=12,l.sendRawTransaction(c.serialize());case 12:return f=d.sent,d.abrupt("return",{signature:f});case 14:case"end":return d.stop()}},i)}));return function(i){return s.apply(this,arguments)}}(),r};function nl(n){var e=sl();return function(){var r=Ae(n),s;if(e){var i=Ae(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return bt(this,s)}}function sl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var kl=function(n){wt(t,n);var e=nl(t);function t(){return ct(this,t),e.apply(this,arguments)}return ut(t,[{key:"getProviderHandlers",value:function(s){return rl(s,this.getProviderEngineProxy.bind(this))}}]),t}(jr),il=function(e,t){var r=Zn(e);return r.signMessage=function(){var s=P(v.mark(function i(o){var a,c;return v.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,e.sign(o.params.message,"utf8");case 2:return a=l.sent,c=a.signature,l.abrupt("return",c);case 5:case"end":return l.stop()}},i)}));return function(i){return s.apply(this,arguments)}}(),r.signAndSendTransaction=function(){var s=P(v.mark(function i(o){var a,c,u,l,f;return v.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(a=t(),a){d.next=3;break}throw j.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return d.next=5,e.signTransaction(o.params.message);case 5:return c=d.sent,d.next=8,a.request({method:"solana_provider_config",params:[]});case 8:return u=d.sent,l=new Gn(u.rpcTarget),d.next=12,l.sendRawTransaction(c.serialize());case 12:return f=d.sent,d.abrupt("return",{signature:f});case 14:case"end":return d.stop()}},i)}));return function(i){return s.apply(this,arguments)}}(),r};function ol(n){var e=al();return function(){var r=Ae(n),s;if(e){var i=Ae(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return bt(this,s)}}function al(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Al=function(n){wt(t,n);var e=ol(t);function t(){return ct(this,t),e.apply(this,arguments)}return ut(t,[{key:"getProviderHandlers",value:function(s){return il(s,this.getProviderEngineProxy.bind(this))}}]),t}(jr),cl=function(e){var t={requestAccounts:function(){var r=P(v.mark(function i(){var o;return v.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,e.request({method:"solana_requestAccounts",params:{}});case 2:return o=c.sent,c.abrupt("return",o);case 4:case"end":return c.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getAccounts:function(){var r=P(v.mark(function i(){var o;return v.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,e.request({method:"solana_requestAccounts",params:{}});case 2:return o=c.sent,c.abrupt("return",o);case 4:case"end":return c.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getPrivateKey:function(){var r=P(v.mark(function i(){return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw j.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getSecretKey:function(){var r=P(v.mark(function i(){return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw j.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),signMessage:function(){var r=P(v.mark(function i(o){var a,c;return v.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if((a=o.params)!==null&&a!==void 0&&a.message){l.next=2;break}throw j.ethErrors.rpc.invalidParams("message");case 2:return l.next=4,e.signMessage(o.params.message);case 4:return c=l.sent,l.abrupt("return",c);case 6:case"end":return l.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signTransaction:function(){var r=P(v.mark(function i(o){var a,c,u;return v.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if((a=o.params)!==null&&a!==void 0&&a.message){f.next=2;break}throw j.ethErrors.rpc.invalidParams("message");case 2:return c=o.params.message,f.next=5,e.signTransaction(c);case 5:return u=f.sent,f.abrupt("return",u);case 7:case"end":return f.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAndSendTransaction:function(){var r=P(v.mark(function i(o){var a,c,u;return v.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if((a=o.params)!==null&&a!==void 0&&a.message){f.next=2;break}throw j.ethErrors.rpc.invalidParams("message");case 2:return c=o.params.message,f.next=5,e.sendTransaction(c);case 5:return u=f.sent,f.abrupt("return",{signature:u});case 7:case"end":return f.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAllTransactions:function(){var r=P(v.mark(function i(o){var a,c,u,l;return v.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(!((a=o.params)!==null&&a!==void 0&&a.message)||!((c=o.params)!==null&&c!==void 0&&c.message.length))){h.next=2;break}throw j.ethErrors.rpc.invalidParams("message");case 2:return u=o.params.message,h.next=5,e.signAllTransactions(u);case 5:return l=h.sent,h.abrupt("return",l);case 7:case"end":return h.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()};return t};function Cs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function pr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Cs(Object(t),!0).forEach(function(r){Nt(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Cs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function ul(n){var e=ll();return function(){var r=Ae(n),s;if(e){var i=Ae(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return bt(this,s)}}function ll(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var El=function(n){wt(t,n);var e=ul(t);function t(r){var s=r.config,i=r.state;return ct(this,t),e.call(this,{config:{chainConfig:pr(pr({},s.chainConfig),{},{chainNamespace:yr.SOLANA})},state:i})}return ut(t,[{key:"switchChain",value:function(){var r=P(v.mark(function i(o){return v.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Promise.resolve());case 1:case"end":return c.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"setupProvider",value:function(){var r=P(v.mark(function i(o){return v.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.handleInjectedProviderUpdate(o),c.next=3,this.setupEngine(o);case 3:case"end":return c.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"lookupNetwork",value:function(){var r=P(v.mark(function i(){var o,a,c;return v.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.provider){l.next=2;break}throw j.ethErrors.provider.custom({message:"Torus solana provider is not initialized",code:4902});case 2:return o=this.config.chainConfig.chainId,l.next=5,this.provider.request({method:"solana_chainId"});case 5:if(a=l.sent,c=Jn(a.toString())?a:"0x".concat(parseInt(a,10).toString(16)),o===c){l.next=9;break}throw En.rpcConnectionError("Invalid network, net_version is: ".concat(c,", expected: ").concat(o));case 9:return this.update({chainId:c}),this.provider.emit("connect",{chainId:this.state.chainId}),this.provider.emit("chainChanged",this.state.chainId),l.abrupt("return",this.state.chainId);case 13:case"end":return l.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"setupEngine",value:function(){var r=P(v.mark(function i(o){var a,c,u,l,f;return v.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a=cl(o),c=Vn(a),u=ji(o),l=new xn,l.push(c),l.push(u),f=In(l),this.updateProviderEngineProxy(f),d.next=10,this.lookupNetwork();case 10:case"end":return d.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"handleInjectedProviderUpdate",value:function(){var r=P(v.mark(function i(o){var a=this;return v.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o.on("accountsChanged",function(){var l=P(v.mark(function f(h){return v.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:a.provider.emit("accountsChanged",h);case 1:case"end":return p.stop()}},f)}));return function(f){return l.apply(this,arguments)}}()),o.on("chainChanged",function(){var l=P(v.mark(function f(h){var d;return v.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return d=Jn(h)?h:"0x".concat(parseInt(h,10).toString(16)),a.configure({chainConfig:pr(pr({},a.config.chainConfig),{},{chainId:d})}),g.next=4,a.setupProvider(o);case 4:case"end":return g.stop()}},f)}));return function(f){return l.apply(this,arguments)}}());case 2:case"end":return u.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()}]),t}(An);function fl(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=dl(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,s=function(){};return{s,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(u){throw u},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,a;return{s:function(){t=t.call(n)},n:function(){var u=t.next();return i=u.done,u},e:function(u){o=!0,a=u},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw a}}}}function dl(n,e){if(n){if(typeof n=="string")return Ts(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ts(n,e)}}function Ts(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function hl(n){return kn.apply(this,arguments)}function kn(){return kn=P(v.mark(function n(e){var t,r,s,i,o;return v.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.privKey,r=e.getProviderEngineProxy,s=function(){return Vt.fromSecretKey(L.from(t,"hex"))},typeof t=="string"){c.next=4;break}throw En.invalidParams("privKey must be a string");case 4:return i=s(),o={requestAccounts:function(){var u=P(v.mark(function f(){return v.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[i.publicKey.toBase58()]);case 1:case"end":return d.stop()}},f)}));function l(){return u.apply(this,arguments)}return l}(),getAccounts:function(){var u=P(v.mark(function f(){return v.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[i.publicKey.toBase58()]);case 1:case"end":return d.stop()}},f)}));function l(){return u.apply(this,arguments)}return l}(),getPrivateKey:function(){var u=P(v.mark(function f(){return v.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",t);case 1:case"end":return d.stop()}},f)}));function l(){return u.apply(this,arguments)}return l}(),getSecretKey:function(){var u=P(v.mark(function f(){return v.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Y.encode(i.secretKey));case 1:case"end":return d.stop()}},f)}));function l(){return u.apply(this,arguments)}return l}(),signTransaction:function(){var u=P(v.mark(function f(h){var d,p;return v.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if((d=h.params)!==null&&d!==void 0&&d.message){m.next=2;break}throw j.ethErrors.rpc.invalidParams("message");case 2:return p=h.params.message,p.partialSign(i),m.abrupt("return",p);case 5:case"end":return m.stop()}},f)}));function l(f){return u.apply(this,arguments)}return l}(),signMessage:function(){var u=P(v.mark(function f(h){var d,p;return v.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if((d=h.params)!==null&&d!==void 0&&d.message){m.next=2;break}throw j.ethErrors.rpc.invalidParams("message");case 2:return p=io.sign.detached(h.params.message,i.secretKey),m.abrupt("return",p);case 4:case"end":return m.stop()}},f)}));function l(f){return u.apply(this,arguments)}return l}(),signAndSendTransaction:function(){var u=P(v.mark(function f(h){var d,p,g,m;return v.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if((d=h.params)!==null&&d!==void 0&&d.message){b.next=2;break}throw j.ethErrors.rpc.invalidParams("message");case 2:if(p=r(),p){b.next=5;break}throw j.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 5:return g=h.params.message,g.sign(i),b.next=9,p.request({method:"sendTransaction",params:[Y.encode(g.serialize())]});case 9:return m=b.sent,b.abrupt("return",{signature:m});case 11:case"end":return b.stop()}},f)}));function l(f){return u.apply(this,arguments)}return l}(),signAllTransactions:function(){var u=P(v.mark(function f(h){var d,p,g,m,k,b,S,T;return v.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!(!((d=h.params)!==null&&d!==void 0&&d.message)||!((p=h.params)!==null&&p!==void 0&&p.message.length))){U.next=2;break}throw j.ethErrors.rpc.invalidParams("message");case 2:m=(g=h.params)===null||g===void 0?void 0:g.message,k=fl(m||[]);try{for(k.s();!(b=k.n()).done;)S=b.value,T=S,T.partialSign(i)}catch(C){k.e(C)}finally{k.f()}return U.abrupt("return",m);case 6:case"end":return U.stop()}},f)}));function l(f){return u.apply(this,arguments)}return l}()},c.abrupt("return",o);case 7:case"end":return c.stop()}},n)})),kn.apply(this,arguments)}function Ps(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Os(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ps(Object(t),!0).forEach(function(r){Nt(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ps(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function pl(n){var e=gl();return function(){var r=Ae(n),s;if(e){var i=Ae(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return bt(this,s)}}function gl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ls=function(n){wt(t,n);var e=pl(t);function t(r){var s=r.config,i=r.state;return ct(this,t),e.call(this,{config:{chainConfig:Os(Os({},s.chainConfig),{},{chainNamespace:yr.SOLANA})},state:i})}return ut(t,[{key:"enable",value:function(){var r=P(v.mark(function i(){return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.state.privateKey){a.next=2;break}throw j.ethErrors.provider.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});case 2:return a.next=4,this.setupProvider(this.state.privateKey);case 4:return a.abrupt("return",this._providerEngineProxy.request({method:"eth_accounts"}));case 5:case"end":return a.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"setupProvider",value:function(){var r=P(v.mark(function i(o){var a,c,u,l,f,h;return v.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,hl({privKey:o,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)});case 2:return a=p.sent,c=Vn(a),u=new xn,l=Hu(this.config.chainConfig),f=l.networkMiddleware,u.push(this.getChainSwitchMiddleware()),u.push(this.getAccountMiddleware()),u.push(c),u.push(f),h=In(u),this.updateProviderEngineProxy(h),p.next=14,this.lookupNetwork();case 14:case"end":return p.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"updateAccount",value:function(){var r=P(v.mark(function i(o){var a;return v.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this._providerEngineProxy){u.next=2;break}throw j.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return u.next=4,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 4:if(a=u.sent,a===o.privateKey){u.next=14;break}return u.next=8,this.setupProvider(o.privateKey);case 8:return u.t0=this._providerEngineProxy,u.next=11,this._providerEngineProxy.request({method:"requestAccounts"});case 11:u.t1=u.sent,u.t2={accounts:u.t1},u.t0.emit.call(u.t0,"accountsChanged",u.t2);case 14:case"end":return u.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"switchChain",value:function(){var r=P(v.mark(function i(o){var a,c;return v.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this._providerEngineProxy){l.next=2;break}throw j.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return a=this.getChainConfig(o.chainId),this.update({chainId:"loading"}),this.configure({chainConfig:a}),l.next=7,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 7:return c=l.sent,l.next=10,this.setupProvider(c);case 10:case"end":return l.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"lookupNetwork",value:function(){var r=P(v.mark(function i(){var o,a;return v.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this._providerEngineProxy){u.next=2;break}throw j.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return u.next=4,this._providerEngineProxy.request({method:"getHealth",params:[]});case 4:if(o=u.sent,a=this.config.chainConfig,o==="ok"){u.next=8;break}throw En.rpcConnectionError("Failed to lookup network for following rpc target: ".concat(a.rpcTarget));case 8:return this.update({chainId:a.chainId}),this.state.chainId!==a.chainId&&(this.provider.emit("chainChanged",this.state.chainId),this.provider.emit("connect",{chainId:this.state.chainId})),u.abrupt("return",this.state.chainId);case 11:case"end":return u.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"getChainSwitchMiddleware",value:function(){var s=this,i={addNewChainConfig:function(){var a=P(v.mark(function u(l){var f,h,d,p,g,m;return v.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(l.params){b.next=2;break}throw j.ethErrors.rpc.invalidParams("Missing request params");case 2:if(f=l.params,h=f.chainId,d=f.chainName,p=f.rpcUrls,g=f.blockExplorerUrls,m=f.nativeCurrency,h){b.next=5;break}throw j.ethErrors.rpc.invalidParams("Missing chainId in chainParams");case 5:if(!(!p||p.length===0)){b.next=7;break}throw j.ethErrors.rpc.invalidParams("Missing rpcUrls in chainParams");case 7:if(m){b.next=9;break}throw j.ethErrors.rpc.invalidParams("Missing nativeCurrency in chainParams");case 9:s.addChain({chainNamespace:yr.SOLANA,chainId:h,ticker:m?.symbol||"SOL",tickerName:m?.name||"Solana",displayName:d,rpcTarget:p[0],blockExplorer:g?.[0]||""});case 10:case"end":return b.stop()}},u)}));function c(u){return a.apply(this,arguments)}return c}(),switchSolanaChain:function(){var a=P(v.mark(function u(l){return v.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l.params){h.next=2;break}throw j.ethErrors.rpc.invalidParams("Missing request params");case 2:if(l.params.chainId){h.next=4;break}throw j.ethErrors.rpc.invalidParams("Missing chainId");case 4:return h.next=6,s.switchChain(l.params);case 6:case"end":return h.stop()}},u)}));function c(u){return a.apply(this,arguments)}return c}()},o=Wu(i);return o}},{key:"getAccountMiddleware",value:function(){var s=this,i={updatePrivatekey:function(){var o=P(v.mark(function c(u){var l;return v.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(u.params){h.next=2;break}throw j.ethErrors.rpc.invalidParams("Missing request params");case 2:if(u.params.privateKey){h.next=4;break}throw j.ethErrors.rpc.invalidParams("Missing privateKey");case 4:return l=u.params.privateKey,h.next=7,s.updateAccount({privateKey:l});case 7:case"end":return h.stop()}},c)}));function a(c){return o.apply(this,arguments)}return a}()};return Gu(i)}}]),t}(An);Nt(Ls,"getProviderInstance",function(){var n=P(v.mark(function e(t){var r;return v.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=new Ls({config:{chainConfig:t.chainConfig}}),i.next=3,r.setupProvider(t.privKey);case 3:return i.abrupt("return",r);case 4:case"end":return i.stop()}},e)}));return function(e){return n.apply(this,arguments)}}());var xl=function(){function n(e){ct(this,n),Nt(this,"provider",void 0),this.provider=e}return ut(n,[{key:"requestAccounts",value:function(){var e=P(v.mark(function r(){var s;return v.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.provider.request({method:"requestAccounts",params:{}});case 2:return s=o.sent,o.abrupt("return",s);case 4:case"end":return o.stop()}},r,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"signAndSendTransaction",value:function(){var e=P(v.mark(function r(s){var i,o;return v.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.provider.request({method:"signAndSendTransaction",params:{message:s}});case 2:return i=c.sent,o=i.signature,c.abrupt("return",{signature:o});case 5:case"end":return c.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"signTransaction",value:function(){var e=P(v.mark(function r(s){var i;return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request({method:"signTransaction",params:{message:s}});case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"signAllTransactions",value:function(){var e=P(v.mark(function r(s){var i;return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request({method:"signAllTransactions",params:{message:s}});case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"signMessage",value:function(){var e=P(v.mark(function r(s){var i;return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request({method:"signMessage",params:{message:s}});case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"request",value:function(){var e=P(v.mark(function r(s){var i;return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request(s);case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()}]),n}();export{vl as PhantomInjectedProvider,Sl as SlopeInjectedProxyProvider,Ls as SolanaPrivateKeyProvider,xl as SolanaWallet,kl as SolflareInjectedProvider,Al as SolletInjectedProvider,El as TorusInjectedProvider};
