import{y as ne,B as Y,f as se,E as ae,q as K,b as d,C as oe,z as ie,A as z}from"./index-431da0f4.js";import{b as ce}from"./index.browser.esm-3d652e3f.js";const de=ne.ec;new de("secp256k1");const U=globalThis.crypto||globalThis.msCrypto||{};U.subtle||U.webkitSubtle;Y.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex");Y.alloc(32,0);var ue={},N={};Object.defineProperty(N,"__esModule",{value:!0});N.EthereumProviderError=N.EthereumRpcError=void 0;const le=se;class Q extends Error{constructor(e,r,n){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!r||typeof r!="string")throw new Error('"message" must be a nonempty string.');super(r),this.code=e,n!==void 0&&(this.data=n)}serialize(){const e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),this.stack&&(e.stack=this.stack),e}toString(){return le.default(this.serialize(),me,2)}}N.EthereumRpcError=Q;class ge extends Q{constructor(e,r,n){if(!he(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,r,n)}}N.EthereumProviderError=ge;function he(t){return Number.isInteger(t)&&t>=1e3&&t<=4999}function me(t,e){if(e!=="[Circular]")return e}var F={},v={};Object.defineProperty(v,"__esModule",{value:!0});v.errorValues=v.errorCodes=void 0;v.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}};v.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.serializeError=t.isValidCode=t.getMessageFromCode=t.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const e=v,r=N,n=e.errorCodes.rpc.internal,s="Unspecified error message. This is a bug, please report it.",c={code:n,message:u(n)};t.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.";function u(a,p=s){if(Number.isInteger(a)){const _=a.toString();if(x(e.errorValues,_))return e.errorValues[_].message;if(h(a))return t.JSON_RPC_SERVER_ERROR_MESSAGE}return p}t.getMessageFromCode=u;function f(a){if(!Number.isInteger(a))return!1;const p=a.toString();return!!(e.errorValues[p]||h(a))}t.isValidCode=f;function g(a,{fallbackError:p=c,shouldIncludeStack:_=!1}={}){var D,j;if(!p||!Number.isInteger(p.code)||typeof p.message!="string")throw new Error("Must provide fallback error with integer number code and string message.");if(a instanceof r.EthereumRpcError)return a.serialize();const E={};if(a&&typeof a=="object"&&!Array.isArray(a)&&x(a,"code")&&f(a.code)){const w=a;E.code=w.code,w.message&&typeof w.message=="string"?(E.message=w.message,x(w,"data")&&(E.data=w.data)):(E.message=u(E.code),E.data={originalError:O(a)})}else{E.code=p.code;const w=(D=a)===null||D===void 0?void 0:D.message;E.message=w&&typeof w=="string"?w:p.message,E.data={originalError:O(a)}}const L=(j=a)===null||j===void 0?void 0:j.stack;return _&&a&&L&&typeof L=="string"&&(E.stack=L),E}t.serializeError=g;function h(a){return a>=-32099&&a<=-32e3}function O(a){return a&&typeof a=="object"&&!Array.isArray(a)?Object.assign({},a):a}function x(a,p){return Object.prototype.hasOwnProperty.call(a,p)}})(F);var M={};Object.defineProperty(M,"__esModule",{value:!0});M.ethErrors=void 0;const q=N,X=F,l=v;M.ethErrors={rpc:{parse:t=>m(l.errorCodes.rpc.parse,t),invalidRequest:t=>m(l.errorCodes.rpc.invalidRequest,t),invalidParams:t=>m(l.errorCodes.rpc.invalidParams,t),methodNotFound:t=>m(l.errorCodes.rpc.methodNotFound,t),internal:t=>m(l.errorCodes.rpc.internal,t),server:t=>{if(!t||typeof t!="object"||Array.isArray(t))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:e}=t;if(!Number.isInteger(e)||e>-32005||e<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return m(e,t)},invalidInput:t=>m(l.errorCodes.rpc.invalidInput,t),resourceNotFound:t=>m(l.errorCodes.rpc.resourceNotFound,t),resourceUnavailable:t=>m(l.errorCodes.rpc.resourceUnavailable,t),transactionRejected:t=>m(l.errorCodes.rpc.transactionRejected,t),methodNotSupported:t=>m(l.errorCodes.rpc.methodNotSupported,t),limitExceeded:t=>m(l.errorCodes.rpc.limitExceeded,t)},provider:{userRejectedRequest:t=>A(l.errorCodes.provider.userRejectedRequest,t),unauthorized:t=>A(l.errorCodes.provider.unauthorized,t),unsupportedMethod:t=>A(l.errorCodes.provider.unsupportedMethod,t),disconnected:t=>A(l.errorCodes.provider.disconnected,t),chainDisconnected:t=>A(l.errorCodes.provider.chainDisconnected,t),custom:t=>{if(!t||typeof t!="object"||Array.isArray(t))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:e,message:r,data:n}=t;if(!r||typeof r!="string")throw new Error('"message" must be a nonempty string');return new q.EthereumProviderError(e,r,n)}}};function m(t,e){const[r,n]=Z(e);return new q.EthereumRpcError(t,r||X.getMessageFromCode(t),n)}function A(t,e){const[r,n]=Z(e);return new q.EthereumProviderError(t,r||X.getMessageFromCode(t),n)}function Z(t){if(t){if(typeof t=="string")return[t];if(typeof t=="object"&&!Array.isArray(t)){const{message:e,data:r}=t;if(e&&typeof e!="string")throw new Error("Must specify string message.");return[e||void 0,r]}}return[]}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getMessageFromCode=t.serializeError=t.EthereumProviderError=t.EthereumRpcError=t.ethErrors=t.errorCodes=void 0;const e=N;Object.defineProperty(t,"EthereumRpcError",{enumerable:!0,get:function(){return e.EthereumRpcError}}),Object.defineProperty(t,"EthereumProviderError",{enumerable:!0,get:function(){return e.EthereumProviderError}});const r=F;Object.defineProperty(t,"serializeError",{enumerable:!0,get:function(){return r.serializeError}}),Object.defineProperty(t,"getMessageFromCode",{enumerable:!0,get:function(){return r.getMessageFromCode}});const n=M;Object.defineProperty(t,"ethErrors",{enumerable:!0,get:function(){return n.ethErrors}});const s=v;Object.defineProperty(t,"errorCodes",{enumerable:!0,get:function(){return s.errorCodes}})})(ue);function $(t,e,r){try{Reflect.apply(t,e,r)}catch(n){setTimeout(()=>{throw n})}}function fe(t){const e=t.length,r=new Array(e);for(let n=0;n<e;n+=1)r[n]=t[n];return r}class pe extends ae{emit(e){let r=e==="error";const n=this._events;if(n!==void 0)r=r&&n.error===void 0;else if(!r)return!1;for(var s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];if(r){let g;if(c.length>0&&([g]=c),g instanceof Error)throw g;const h=new Error(`Unhandled error.${g?` (${g.message})`:""}`);throw h.context=g,h}const f=n[e];if(f===void 0)return!1;if(typeof f=="function")$(f,this,c);else{const g=f.length,h=fe(f);for(let O=0;O<g;O+=1)$(h[O],this,c)}return!0}}const T="openlogin_store",Ee={MAINNET:"mainnet",TESTNET:"testnet",CYAN:"cyan",DEVELOPMENT:"development",SK_TESTNET:"sk_testnet",CELESTE:"celeste",AQUA:"aqua"};K.setLevel("error");K.getLogger("openlogin");class Ce{constructor(){d(this,"store",{})}getItem(e){return this.store[e]||null}setItem(e,r){this.store[e]=r}}function W(t){let e=!1,r=0,n;try{n=window[t],e=!0,r=n.length;const s="__storage_test__";return n.setItem(s,s),n.removeItem(s),!0}catch(s){return s&&(s.code===22||s.code===1014||s.name==="QuotaExceededErro r"||s.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&r!==0}}const we=W("sessionStorage"),ye=W("localStorage");class Ne{constructor(e,r){d(this,"storage",void 0),d(this,"_storeKey",T),this.storage=e,this._storeKey=r||T;try{e.getItem(r||T)||this.resetStore()}catch{}}static getInstance(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"local";if(!this.instance){let n=new Ce;r==="local"&&ye&&(n=localStorage),r==="session"&&we&&(n=sessionStorage);const s=e?`${T}_${e}`:T;this.instance=new this(n,s)}return this.instance}toJSON(){return this.storage.getItem(this._storeKey)}resetStore(){const e=this.getStore();return this.storage.setItem(this._storeKey,JSON.stringify({})),e}getStore(){return JSON.parse(this.storage.getItem(this._storeKey))}get(e){return JSON.parse(this.storage.getItem(this._storeKey))[e]}set(e,r){const n=JSON.parse(this.storage.getItem(this._storeKey));n[e]=r,this.storage.setItem(this._storeKey,JSON.stringify(n))}}d(Ne,"instance",void 0);const y={EIP155:"eip155",SOLANA:"solana",OTHER:"other"},ve=t=>{if(t===y.EIP155)return 1;if(t===y.SOLANA)return 1;throw new Error(`Chain namespace ${t} is not supported`)},Oe=t=>{const e=y.EIP155;return t===1?{chainNamespace:e,chainId:"0x1",rpcTarget:"https://rpc.ankr.com/eth",displayName:"Ethereum Mainnet",blockExplorer:"https://etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:t===5?{chainNamespace:e,chainId:"0x5",rpcTarget:"https://rpc.ankr.com/eth_goerli",displayName:"Goerli Testnet",blockExplorer:"https://goerli.etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:t===11155111?{chainNamespace:e,chainId:"0xaa36a7",rpcTarget:"https://rpc.ankr.com/eth_sepolia",displayName:"Sepolia Testnet",blockExplorer:"https://sepolia.etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:t===137?{chainNamespace:e,chainId:"0x89",rpcTarget:"https://rpc.ankr.com/polygon",displayName:"Polygon Mainnet",blockExplorer:"https://polygonscan.com",ticker:"MATIC",tickerName:"Polygon"}:t===80001?{chainNamespace:e,chainId:"0x13881",rpcTarget:"https://rpc.ankr.com/polygon_mumbai",displayName:"Polygon Mumbai Testnet",blockExplorer:"https://mumbai.polygonscan.com/",ticker:"MATIC",tickerName:"Polygon",decimals:18}:t===56?{chainNamespace:e,chainId:"0x38",rpcTarget:"https://rpc.ankr.com/bsc",displayName:"Binance SmartChain Mainnet",blockExplorer:"https://bscscan.com",ticker:"BNB",tickerName:"Binance SmartChain",decimals:18}:t===97?{chainNamespace:e,chainId:"0x61",rpcTarget:"https://rpc.ankr.com/bsc_testnet_chapel",displayName:"Binance SmartChain Testnet",blockExplorer:"https://testnet.bscscan.com",ticker:"BNB",tickerName:"Binance SmartChain",decimals:18}:t===25?{chainNamespace:e,chainId:"0x19",rpcTarget:"https://rpc.cronos.org",displayName:"Cronos Mainnet",blockExplorer:"https://cronoscan.com/",ticker:"CRO",tickerName:"Cronos"}:t===338?{chainNamespace:e,chainId:"0x152",rpcTarget:"https://rpc-t3.cronos.org/",displayName:"Cronos Testnet",blockExplorer:"https://cronoscan.com/",ticker:"CRO",tickerName:"Cronos",decimals:18}:t===8217?{chainNamespace:e,chainId:"0x2019",rpcTarget:"https://public-node-api.klaytnapi.com/v1/cypress",displayName:"Klaytn Mainnet",blockExplorer:"https://scope.klaytn.com",ticker:"KLAY",tickerName:"Klaytn",decimals:18}:null},be=t=>{const e=y.SOLANA;return t===1?{chainNamespace:e,chainId:"0x1",rpcTarget:"https://rpc.ankr.com/solana",displayName:"Solana Mainnet",blockExplorer:"https://explorer.solana.com",ticker:"SOL",tickerName:"Solana",decimals:9}:t===2?{chainNamespace:e,chainId:"0x2",rpcTarget:"https://api.testnet.solana.com",displayName:"Solana Testnet",blockExplorer:"https://explorer.solana.com?cluster=testnet",ticker:"SOL",tickerName:"Solana",decimals:9}:t===3?{chainNamespace:e,chainId:"0x3",rpcTarget:"https://api.devnet.solana.com",displayName:"Solana Devnet",blockExplorer:"https://explorer.solana.com?cluster=devnet",ticker:"SOL",tickerName:"Solana",decimals:9}:null},ee=(t,e)=>{if(t===y.OTHER)return null;const r=e?typeof e=="number"?e:parseInt(e,16):ve(t);return t===y.EIP155?Oe(r):t===y.SOLANA?be(r):null};class J extends oe{constructor(e,r){super(r),d(this,"code",void 0),d(this,"message",void 0),this.code=e,this.message=r||"",Object.defineProperty(this,"name",{value:"Web3AuthError"})}toJSON(){return{name:this.name,code:this.code,message:this.message}}toString(){return JSON.stringify(this.toJSON())}}class o extends J{constructor(e,r){super(e,r),Object.defineProperty(this,"name",{value:"WalletInitializationError"})}static fromCode(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new o(e,`${o.messages[e]}, ${r}`)}static notFound(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5001,e)}static notInstalled(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5002,e)}static notReady(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5003,e)}static windowBlocked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5004,e)}static windowClosed(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5005,e)}static incompatibleChainNameSpace(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5006,e)}static duplicateAdapterError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5007,e)}static invalidProviderConfigError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5008,e)}static providerNotReadyError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5009,e)}static rpcConnectionError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5010,e)}static invalidParams(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5011,e)}static invalidNetwork(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o.fromCode(5013,e)}}d(o,"messages",{5e3:"Custom",5001:"Wallet is not found",5002:"Wallet is not installed",5003:"Wallet is not ready yet",5004:"Wallet window is blocked",5005:"Wallet window has been closed by the user",5006:"Incompatible chain namespace provided",5007:"Adapter has already been included",5008:"Invalid provider Config",5009:"Provider is not ready yet",5010:"Failed to connect with rpc url",5011:"Invalid params passed in",5013:"Invalid network provided"});class i extends J{constructor(e,r){super(e,r),Object.defineProperty(this,"name",{value:"WalletLoginError"})}static fromCode(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new i(e,`${i.messages[e]}. ${r}`)}static connectionError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return i.fromCode(5111,e)}static disconnectionError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return i.fromCode(5112,e)}static notConnectedError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return i.fromCode(5113,e)}static popupClosed(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return i.fromCode(5114,e)}static mfaEnabled(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return i.fromCode(5115,e)}static chainConfigNotAdded(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return i.fromCode(5116,e)}static unsupportedOperation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return i.fromCode(5117,e)}static coreKitKeyNotFound(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return i.fromCode(5118,e)}static userNotLoggedIn(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return i.fromCode(5119,e)}}d(i,"messages",{5e3:"Custom",5111:"Failed to connect with wallet",5112:"Failed to disconnect from wallet",5113:"Wallet is not connected",5114:"Wallet popup has been closed by the user",5115:"User has already enabled mfa, please use the @web3auth/web3auth-web sdk for login with mfa",5116:"Chain config has not been added. Please add the chain config before calling switchChain",5117:"Unsupported operation",5118:"useCoreKitKey flag is enabled but coreKitKey is not available",5119:"User not logged in."});class S extends J{constructor(e,r){super(e,r),Object.defineProperty(this,"name",{value:"WalletOperationsError"})}static fromCode(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new S(e,`${S.messages[e]}, ${r}`)}static chainIDNotAllowed(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return S.fromCode(5201,e)}static operationNotAllowed(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return S.fromCode(5202,e)}}d(S,"messages",{5e3:"Custom",5201:"Provided chainId is not allowed",5202:"This operation is not allowed"});function B(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function I(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?B(Object(r),!0).forEach(function(n){d(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}const P={OPENLOGIN:"openlogin",WALLET_CONNECT_V1:"wallet-connect-v1",WALLET_CONNECT_V2:"wallet-connect-v2"},R=I({TORUS_SOLANA:"torus-solana",PHANTOM:"phantom",SOLFLARE:"solflare",SLOPE:"slope"},P),k=I({TORUS_EVM:"torus-evm",METAMASK:"metamask",COINBASE:"coinbase"},P),H=I(I({},k),R);P.OPENLOGIN+"",P.WALLET_CONNECT_V1+"",P.WALLET_CONNECT_V2+"",R.TORUS_SOLANA+"",R.PHANTOM+"",R.SOLFLARE+"",R.SLOPE+"",k.TORUS_EVM+"",k.METAMASK+"",k.COINBASE+"";function G(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function b(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?G(Object(r),!0).forEach(function(n){d(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}const C={NOT_READY:"not_ready",READY:"ready",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",ERRORED:"errored"},te=b(b({},C),{},{ADAPTER_DATA_UPDATED:"adapter_data_updated",CACHE_CLEAR:"cache_clear"});class Se extends pe{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),d(this,"adapterData",{}),d(this,"sessionTime",86400),d(this,"clientId",void 0),d(this,"web3AuthNetwork",Ee.MAINNET),d(this,"rehydrated",!1),d(this,"chainConfig",null),d(this,"knownChainConfigs",{}),this.setAdapterSettings(e)}get chainConfigProxy(){return this.chainConfig?b({},this.chainConfig):null}setAdapterSettings(e){if(this.status===C.READY)return;e!=null&&e.sessionTime&&(this.sessionTime=e.sessionTime),e!=null&&e.clientId&&(this.clientId=e.clientId),e!=null&&e.web3AuthNetwork&&(this.web3AuthNetwork=e.web3AuthNetwork);const r=e.chainConfig;if(r){if(!r.chainNamespace)throw o.notReady("ChainNamespace is required while setting chainConfig");this.currentChainNamespace=r.chainNamespace;const n=ee(r.chainNamespace,r.chainId),s=b(b({},n||{}),r);this.chainConfig=s,this.addChainConfig(s)}}checkConnectionRequirements(){if(!((this.name===H.WALLET_CONNECT_V1||this.name===H.WALLET_CONNECT_V2)&&this.status===C.CONNECTING)){if(this.status===C.CONNECTING)throw o.notReady("Already connecting");if(this.status===C.CONNECTED)throw i.connectionError("Already connected");if(this.status!==C.READY)throw i.connectionError("Wallet adapter is not ready yet, Please wait for init function to resolve before calling connect/connectTo function")}}checkInitializationRequirements(){if(!this.clientId)throw o.invalidParams("Please initialize Web3Auth with a valid clientId in constructor");if(!this.chainConfig||!this.chainConfig.rpcTarget&&this.chainConfig.chainNamespace!==y.OTHER)throw o.invalidParams("rpcTarget is required in chainConfig");if(!this.chainConfig.chainId&&this.chainConfig.chainNamespace!==y.OTHER)throw o.invalidParams("chainID is required in chainConfig");if(this.status!==C.NOT_READY){if(this.status===C.CONNECTED)throw o.notReady("Already connected");if(this.status===C.READY)throw o.notReady("Adapter is already initialized")}}checkDisconnectionRequirements(){if(this.status!==C.CONNECTED)throw i.disconnectionError("Not connected with wallet")}checkAddChainRequirements(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&!this.provider)throw i.notConnectedError("Not connected with wallet.")}checkSwitchChainRequirements(e){let{chainId:r}=e;if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)&&!this.provider)throw i.notConnectedError("Not connected with wallet.");if(!this.knownChainConfigs[r])throw i.chainConfigNotAdded("Invalid chainId")}updateAdapterData(e){this.adapterData=e,this.emit(te.ADAPTER_DATA_UPDATED,{adapterName:this.name,data:e})}addChainConfig(e){const r=this.knownChainConfigs[e.chainId];this.knownChainConfigs[e.chainId]=b(b({},r||{}),e)}getChainConfig(e){return this.knownChainConfigs[e]||null}}const re="https://authjs.web3auth.io";var Ae=K.getLogger("web3auth-logger");function V(t){let e=!1,r=0,n;try{n=window[t],e=!0,r=n.length;const s="__storage_test__";return n.setItem(s,s),n.removeItem(s),!0}catch(s){const c=s;return!!(c&&(c.code===22||c.code===1014||c.name==="QuotaExceededError"||c.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&r!==0)}}const Te=t=>{const e=ie(t);return!e.exp||e.exp<Math.floor(Date.now()/1e3)},Re=async(t,e)=>{const c={payload:t,header:{t:e==="solana"?"sip99":"eip191"},network:e==="solana"?"solana":"ethereum"},u=await z(`${re}/siww/get`,c);if(!u.success)throw new Error("Failed to authenticate user, Please reach out to Web3Auth Support team");return u.challenge},Pe=async(t,e,r,n,s,c,u)=>{const g={signature:{s:e,t:t==="solana"?"sip99":"eip191"},message:r,issuer:n,audience:window.location.hostname,timeout:s},h=await z(`${re}/siww/verify`,g,{headers:{client_id:c,wallet_provider:n,web3auth_network:u}});if(!h.success)throw Ae.error("Failed to authenticate user, ,message verification failed",h.error),new Error("Failed to authenticate user, ,message verification failed");return h.token},_e=(t,e)=>V("localStorage")?localStorage.getItem(`${t.toLowerCase()}_${e}`):null,ke=(t,e,r)=>V("localStorage")?localStorage.setItem(`${t.toLowerCase()}_${e}`,r):null,Ie=(t,e)=>V("localStorage")?localStorage.removeItem(`${t.toLowerCase()}_${e}`):null;class De extends Se{async init(e){this.chainConfig||(this.chainConfig=ee(y.SOLANA,1))}async authenticateUser(){if(!this.provider||this.status!==C.CONNECTED)throw i.notConnectedError();const{chainNamespace:e,chainId:r}=this.chainConfig,n=await this.provider.request({method:"getAccounts"});if(n&&n.length>0){const s=_e(n[0],this.name);if(s&&!Te(s))return{idToken:s};const c={domain:window.location.origin,uri:window.location.href,address:n[0],chainId:parseInt(r,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:new Date().toISOString()},u=await Re(c,e),f=new TextEncoder().encode(u),g=await this.provider.request({method:"signMessage",params:{message:f,display:"utf8"}}),h=await Pe(e,ce.encode(g),u,this.name,this.sessionTime,this.clientId,this.web3AuthNetwork);return ke(n[0],this.name,h),{idToken:h}}throw i.notConnectedError("Not connected with wallet, Please login/connect first")}async disconnectSession(){super.checkDisconnectionRequirements();const e=await this.provider.request({method:"getAccounts"});e&&e.length>0&&Ie(e[0],this.name)}async disconnect(){this.rehydrated=!1,this.emit(te.DISCONNECTED)}}export{De as B};
